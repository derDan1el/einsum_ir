=== xaby,cxy->cab k-value benchmark log started: Sat Jun 14 10:47:00 PM CEST 2025 ===

=== testing k=2 (dimensions: 16,16,96,2,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,2,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 2
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 5.58882e-05
  gflops: 7.03576
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->2];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->8
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->2
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbbf26000
[DEBUG] GEMM shape: m=256 n=96 k=8 lda=256 ldb=8 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000436622
  time (contract): 6.96896e-06
  gflops: 56.4239
-----------------------------------
max element torch :      5.34375
max element jit :        5.34375
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=4 (dimensions: 16,16,96,4,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,4,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 4
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 6.09832e-05
  gflops: 12.8959
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->4];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->16
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->4
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92196000
[DEBUG] GEMM shape: m=256 n=96 k=16 lda=256 ldb=16 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000342354
  time (contract): 8.3963e-06
  gflops: 93.6641
-----------------------------------
max element torch :      8.0625
max element jit :        8.0625
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=6 (dimensions: 16,16,96,6,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,6,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 6
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 6.57229e-05
  gflops: 17.9488
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->6];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->24
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->6
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb92bf000
[DEBUG] GEMM shape: m=256 n=96 k=24 lda=256 ldb=24 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331123
  time (contract): 1.00024e-05
  gflops: 117.936
-----------------------------------
max element torch :      10.25
max element jit :        10.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=8 (dimensions: 16,16,96,8,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,8,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 8
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 6.57067e-05
  gflops: 23.9376
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->8];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->32
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->8
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c207000
[DEBUG] GEMM shape: m=256 n=96 k=32 lda=256 ldb=32 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000347858
  time (contract): 1.1409e-05
  gflops: 137.862
-----------------------------------
max element torch :      12.375
max element jit :        12.375
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=10 (dimensions: 16,16,96,10,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,10,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 10
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 7.13359e-05
  gflops: 27.5609
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->10];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->40
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->10
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d6ab000
[DEBUG] GEMM shape: m=256 n=96 k=40 lda=256 ldb=40 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326707
  time (contract): 1.29511e-05
  gflops: 151.808
-----------------------------------
max element torch :      15.75
max element jit :        15.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=12 (dimensions: 16,16,96,12,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,12,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 12
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 7.32584e-05
  gflops: 32.2051
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->12];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->48
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->12
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4c49000
[DEBUG] GEMM shape: m=256 n=96 k=48 lda=256 ldb=48 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000307411
  time (contract): 1.4383e-05
  gflops: 164.034
-----------------------------------
max element torch :      19.375
max element jit :        19.375
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=14 (dimensions: 16,16,96,14,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,14,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 14
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 7.80517e-05
  gflops: 35.2652
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->14];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->56
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->14
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b858000
[DEBUG] GEMM shape: m=256 n=96 k=56 lda=256 ldb=56 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000291156
  time (contract): 1.5849e-05
  gflops: 173.671
-----------------------------------
max element torch :      20
max element jit :        20
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=16 (dimensions: 16,16,96,16,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,16,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 16
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.02946e-05
  gflops: 39.1773
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->16];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->64
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->16
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbed41000
[DEBUG] GEMM shape: m=256 n=96 k=64 lda=256 ldb=64 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335122
  time (contract): 1.73778e-05
  gflops: 181.02
-----------------------------------
max element torch :      23.5
max element jit :        23.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=18 (dimensions: 16,16,96,18,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,18,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 18
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.33697e-05
  gflops: 42.4488
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->18];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->72
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->18
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91624000
[DEBUG] GEMM shape: m=256 n=96 k=72 lda=256 ldb=72 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343762
  time (contract): 1.87834e-05
  gflops: 188.408
-----------------------------------
max element torch :      25.125
max element jit :        25.125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=20 (dimensions: 16,16,96,20,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,20,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 20
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.89491e-05
  gflops: 44.2068
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->20];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->80
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->20
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e2da000
[DEBUG] GEMM shape: m=256 n=96 k=80 lda=256 ldb=80 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306548
  time (contract): 2.02457e-05
  gflops: 194.222
-----------------------------------
max element torch :      28.5
max element jit :        28.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=22 (dimensions: 16,16,96,22,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,22,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 22
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 9.18707e-05
  gflops: 47.0811
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->22];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->88
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->22
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e86b000
[DEBUG] GEMM shape: m=256 n=96 k=88 lda=256 ldb=88 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000334706
  time (contract): 2.16327e-05
  gflops: 199.946
-----------------------------------
max element torch :      29.5
max element jit :        29.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=24 (dimensions: 16,16,96,24,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,24,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 24
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 9.39942e-05
  gflops: 50.2009
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->24];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->96
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->24
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7b74000
[DEBUG] GEMM shape: m=256 n=96 k=96 lda=256 ldb=96 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312819
  time (contract): 2.32785e-05
  gflops: 202.701
-----------------------------------
max element torch :      33.5
max element jit :        33.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=26 (dimensions: 16,16,96,26,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,26,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 26
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 9.80925e-05
  gflops: 52.1121
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->26];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->104
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->26
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8cd8f000
[DEBUG] GEMM shape: m=256 n=96 k=104 lda=256 ldb=104 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000297076
  time (contract): 2.4598e-05
  gflops: 207.814
-----------------------------------
max element torch :      35
max element jit :        35
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=28 (dimensions: 16,16,96,28,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,28,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 28
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000100965
  gflops: 54.524
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->28];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->112
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->28
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa57b7000
[DEBUG] GEMM shape: m=256 n=96 k=112 lda=256 ldb=112 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343666
  time (contract): 2.62911e-05
  gflops: 209.387
-----------------------------------
max element torch :      38
max element jit :        38
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=30 (dimensions: 16,16,96,30,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,30,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 30
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000105234
  gflops: 56.0491
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->30];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->120
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->30
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffae7c8000
[DEBUG] GEMM shape: m=256 n=96 k=120 lda=256 ldb=120 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312884
  time (contract): 2.77797e-05
  gflops: 212.322
-----------------------------------
max element torch :      40.25
max element jit :        40.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=32 (dimensions: 16,16,96,32,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,32,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 32
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000112448
  gflops: 55.9497
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->32];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->128
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->32
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa96cd000
[DEBUG] GEMM shape: m=256 n=96 k=128 lda=256 ldb=128 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000295092
  time (contract): 2.92269e-05
  gflops: 215.263
-----------------------------------
max element torch :      41.75
max element jit :        41.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=34 (dimensions: 16,16,96,34,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,34,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 34
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000112893
  gflops: 59.2125
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->34];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->136
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->34
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb209d000
[DEBUG] GEMM shape: m=256 n=96 k=136 lda=256 ldb=136 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348786
  time (contract): 3.04607e-05
  gflops: 219.452
-----------------------------------
max element torch :      45.75
max element jit :        45.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=36 (dimensions: 16,16,96,36,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,36,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 36
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000117414
  gflops: 60.2816
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->36];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->144
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->36
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffac7dc000
[DEBUG] GEMM shape: m=256 n=96 k=144 lda=256 ldb=144 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000300564
  time (contract): 3.19682e-05
  gflops: 221.404
-----------------------------------
max element torch :      45.75
max element jit :        45.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=38 (dimensions: 16,16,96,38,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,38,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 38
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000123308
  gflops: 60.5892
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->38];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->152
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->38
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff826a0000
[DEBUG] GEMM shape: m=256 n=96 k=152 lda=256 ldb=152 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000307027
  time (contract): 3.36455e-05
  gflops: 222.053
-----------------------------------
max element torch :      49.5
max element jit :        49.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=40 (dimensions: 16,16,96,40,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,40,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 40
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000123863
  gflops: 63.4923
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->40];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->160
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->40
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad1a7000
[DEBUG] GEMM shape: m=256 n=96 k=160 lda=256 ldb=160 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000353297
  time (contract): 3.53054e-05
  gflops: 222.751
-----------------------------------
max element torch :      50.5
max element jit :        50.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=42 (dimensions: 16,16,96,42,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,42,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 42
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000128703
  gflops: 64.1597
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->42];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->168
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->42
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96465000
[DEBUG] GEMM shape: m=256 n=96 k=168 lda=256 ldb=168 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326227
  time (contract): 3.67082e-05
  gflops: 224.951
-----------------------------------
max element torch :      52.75
max element jit :        52.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=44 (dimensions: 16,16,96,44,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,44,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 44
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000133593
  gflops: 64.7544
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->44];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->176
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->44
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e6c3000
[DEBUG] GEMM shape: m=256 n=96 k=176 lda=256 ldb=176 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000379985
  time (contract): 3.83197e-05
  gflops: 225.752
-----------------------------------
max element torch :      56.5
max element jit :        56.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=46 (dimensions: 16,16,96,46,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,46,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 46
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00013514
  gflops: 66.923
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->46];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->184
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->46
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb92a5000
[DEBUG] GEMM shape: m=256 n=96 k=184 lda=256 ldb=184 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331538
  time (contract): 3.96906e-05
  gflops: 227.862
-----------------------------------
max element torch :      58.5
max element jit :        58.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=48 (dimensions: 16,16,96,48,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,48,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 48
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000138541
  gflops: 68.1184
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->48];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->192
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->48
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaafcd000
[DEBUG] GEMM shape: m=256 n=96 k=192 lda=256 ldb=192 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323603
  time (contract): 4.16538e-05
  gflops: 226.563
-----------------------------------
max element torch :      59
max element jit :        59
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=50 (dimensions: 16,16,96,50,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,50,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 50
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000142343
  gflops: 69.0612
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->50];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->200
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->50
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9aefc000
[DEBUG] GEMM shape: m=256 n=96 k=200 lda=256 ldb=200 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000278517
  time (contract): 4.26476e-05
  gflops: 230.503
-----------------------------------
max element torch :      62.75
max element jit :        62.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=52 (dimensions: 16,16,96,52,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,52,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 52
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000150602
  gflops: 67.8848
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->52];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->208
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->52
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff832b8000
[DEBUG] GEMM shape: m=256 n=96 k=208 lda=256 ldb=208 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345874
  time (contract): 4.37602e-05
  gflops: 233.628
-----------------------------------
max element torch :      62.25
max element jit :        62.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=54 (dimensions: 16,16,96,54,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,54,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 54
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00015022
  gflops: 70.6754
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->54];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->216
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->54
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaa89c000
[DEBUG] GEMM shape: m=256 n=96 k=216 lda=256 ldb=216 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331443
  time (contract): 4.55707e-05
  gflops: 232.975
-----------------------------------
max element torch :      67
max element jit :        67
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=56 (dimensions: 16,16,96,56,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,56,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 56
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000154248
  gflops: 71.3788
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->56];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->224
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->56
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffac498000
[DEBUG] GEMM shape: m=256 n=96 k=224 lda=256 ldb=224 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000334674
  time (contract): 4.73769e-05
  gflops: 232.393
-----------------------------------
max element torch :      68
max element jit :        68
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=58 (dimensions: 16,16,96,58,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,58,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 58
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000156058
  gflops: 73.0705
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->58];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->232
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->58
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9f77000
[DEBUG] GEMM shape: m=256 n=96 k=232 lda=256 ldb=232 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000342738
  time (contract): 4.86256e-05
  gflops: 234.512
-----------------------------------
max element torch :      69
max element jit :        69
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=60 (dimensions: 16,16,96,60,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,60,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 60
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000160126
  gflops: 73.6699
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->60];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->240
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->60
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa0577000
[DEBUG] GEMM shape: m=256 n=96 k=240 lda=256 ldb=240 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000303252
  time (contract): 5.04475e-05
  gflops: 233.837
-----------------------------------
max element torch :      72.5
max element jit :        72.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=62 (dimensions: 16,16,96,62,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,62,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 62
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000166455
  gflops: 73.2311
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->62];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->248
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->62
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e082000
[DEBUG] GEMM shape: m=256 n=96 k=248 lda=256 ldb=248 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000322834
  time (contract): 5.22422e-05
  gflops: 233.331
-----------------------------------
max element torch :      77
max element jit :        77
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=64 (dimensions: 16,16,96,64,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,64,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 64
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00017115
  gflops: 73.5196
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->64];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->256
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->64
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa2c39000
[DEBUG] GEMM shape: m=256 n=96 k=256 lda=256 ldb=256 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337426
  time (contract): 5.44942e-05
  gflops: 230.904
-----------------------------------
max element torch :      80.5
max element jit :        80.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=66 (dimensions: 16,16,96,66,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,66,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 66
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00017792
  gflops: 72.9323
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->66];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->264
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->66
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff943c5000
[DEBUG] GEMM shape: m=256 n=96 k=264 lda=256 ldb=264 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329907
  time (contract): 5.44832e-05
  gflops: 238.168
-----------------------------------
max element torch :      80
max element jit :        80
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=68 (dimensions: 16,16,96,68,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,68,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 68
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000176174
  gflops: 75.887
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->68];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->272
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->68
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb61a3000
[DEBUG] GEMM shape: m=256 n=96 k=272 lda=256 ldb=272 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00031522
  time (contract): 5.64223e-05
  gflops: 236.951
-----------------------------------
max element torch :      83
max element jit :        83
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=70 (dimensions: 16,16,96,70,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,70,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 70
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000175829
  gflops: 78.2724
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->70];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->280
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->70
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb66d5000
[DEBUG] GEMM shape: m=256 n=96 k=280 lda=256 ldb=280 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337234
  time (contract): 5.77563e-05
  gflops: 238.287
-----------------------------------
max element torch :      85
max element jit :        85
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=72 (dimensions: 16,16,96,72,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,72,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 72
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000192985
  gflops: 73.3518
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->72];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->288
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->72
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ca60000
[DEBUG] GEMM shape: m=256 n=96 k=288 lda=256 ldb=288 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000308499
  time (contract): 5.96078e-05
  gflops: 237.482
-----------------------------------
max element torch :      86
max element jit :        86
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=74 (dimensions: 16,16,96,74,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,74,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 74
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000190081
  gflops: 76.5412
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->74];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->296
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->74
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaaf72000
[DEBUG] GEMM shape: m=256 n=96 k=296 lda=256 ldb=296 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00028706
  time (contract): 6.07092e-05
  gflops: 239.651
-----------------------------------
max element torch :      88.5
max element jit :        88.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=76 (dimensions: 16,16,96,76,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,76,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 76
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000197567
  gflops: 75.631
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->76];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->304
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->76
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c2a1000
[DEBUG] GEMM shape: m=256 n=96 k=304 lda=256 ldb=304 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325075
  time (contract): 6.2308e-05
  gflops: 239.812
-----------------------------------
max element torch :      90.5
max element jit :        90.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=78 (dimensions: 16,16,96,78,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,78,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 78
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000197816
  gflops: 77.5236
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->78];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->312
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->78
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb547f000
[DEBUG] GEMM shape: m=256 n=96 k=312 lda=256 ldb=312 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000355441
  time (contract): 6.30856e-05
  gflops: 243.089
-----------------------------------
max element torch :      95.5
max element jit :        95.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=80 (dimensions: 16,16,96,80,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,80,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 80
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000195092
  gflops: 80.6218
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->80];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->320
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->80
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff943ea000
[DEBUG] GEMM shape: m=256 n=96 k=320 lda=256 ldb=320 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000308852
  time (contract): 6.62482e-05
  gflops: 237.42
-----------------------------------
max element torch :      94.5
max element jit :        94.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=82 (dimensions: 16,16,96,82,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,82,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 82
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000199166
  gflops: 80.9467
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->82];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->328
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->82
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9112000
[DEBUG] GEMM shape: m=256 n=96 k=328 lda=256 ldb=328 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000346673
  time (contract): 6.69249e-05
  gflops: 240.895
-----------------------------------
max element torch :      99.5
max element jit :        99.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=84 (dimensions: 16,16,96,84,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,84,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 84
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000224142
  gflops: 73.6813
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->84];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->336
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->84
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99475000
[DEBUG] GEMM shape: m=256 n=96 k=336 lda=256 ldb=336 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000352081
  time (contract): 6.83933e-05
  gflops: 241.472
-----------------------------------
max element torch :      100
max element jit :        100
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=86 (dimensions: 16,16,96,86,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,86,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 86
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000222018
  gflops: 76.1574
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->86];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->344
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->86
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff854df000
[DEBUG] GEMM shape: m=256 n=96 k=344 lda=256 ldb=344 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000308948
  time (contract): 6.99421e-05
  gflops: 241.747
-----------------------------------
max element torch :      105.5
max element jit :        105.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=88 (dimensions: 16,16,96,88,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,88,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 88
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00023541
  gflops: 73.4951
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->88];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->352
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->88
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab637000
[DEBUG] GEMM shape: m=256 n=96 k=352 lda=256 ldb=352 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000427694
  time (contract): 7.1578e-05
  gflops: 241.715
-----------------------------------
max element torch :      102
max element jit :        102
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=90 (dimensions: 16,16,96,90,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,90,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 90
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00025472
  gflops: 69.4674
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->90];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->360
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->90
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8a97c000
[DEBUG] GEMM shape: m=256 n=96 k=360 lda=256 ldb=360 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000339666
  time (contract): 7.30968e-05
  gflops: 242.073
-----------------------------------
max element torch :      106.5
max element jit :        106.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=92 (dimensions: 16,16,96,92,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,92,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 92
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00026192
  gflops: 69.0591
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->92];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->368
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->92
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7fa42000
[DEBUG] GEMM shape: m=256 n=96 k=368 lda=256 ldb=368 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000280244
  time (contract): 7.46137e-05
  gflops: 242.421
-----------------------------------
max element torch :      106
max element jit :        106
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=94 (dimensions: 16,16,96,94,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,94,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 94
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000263693
  gflops: 70.0859
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->94];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->376
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->94
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8a41b000
[DEBUG] GEMM shape: m=256 n=96 k=376 lda=256 ldb=376 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337426
  time (contract): 7.60778e-05
  gflops: 242.924
-----------------------------------
max element torch :      111.5
max element jit :        111.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=96 (dimensions: 16,16,96,96,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,96,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 96
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000268183
  gflops: 70.3788
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->96];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->384
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->96
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaeb20000
[DEBUG] GEMM shape: m=256 n=96 k=384 lda=256 ldb=384 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305715
  time (contract): 7.89089e-05
  gflops: 239.192
-----------------------------------
max element torch :      113
max element jit :        113
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=98 (dimensions: 16,16,96,98,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,98,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 98
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000260054
  gflops: 74.0906
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->98];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->392
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->98
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81b53000
[DEBUG] GEMM shape: m=256 n=96 k=392 lda=256 ldb=392 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000289268
  time (contract): 7.87657e-05
  gflops: 244.619
-----------------------------------
max element torch :      113.5
max element jit :        113.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=100 (dimensions: 16,16,96,100,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,100,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 100
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000269208
  gflops: 73.0321
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->100];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->400
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->100
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb49aa000
[DEBUG] GEMM shape: m=256 n=96 k=400 lda=256 ldb=400 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332339
  time (contract): 8.04459e-05
  gflops: 244.398
-----------------------------------
max element torch :      119.5
max element jit :        119.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=102 (dimensions: 16,16,96,102,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,102,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 102
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000279641
  gflops: 71.7135
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->102];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->408
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->102
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c6e0000
[DEBUG] GEMM shape: m=256 n=96 k=408 lda=256 ldb=408 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000352305
  time (contract): 8.19402e-05
  gflops: 244.74
-----------------------------------
max element torch :      119.5
max element jit :        119.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=104 (dimensions: 16,16,96,104,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,104,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 104
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000286639
  gflops: 71.3344
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->104];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->416
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->104
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa2f76000
[DEBUG] GEMM shape: m=256 n=96 k=416 lda=256 ldb=416 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328626
  time (contract): 8.41352e-05
  gflops: 243.028
-----------------------------------
max element torch :      122
max element jit :        122
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=106 (dimensions: 16,16,96,106,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,106,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 106
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000268135
  gflops: 77.7236
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->106];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->424
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->106
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa0e85000
[DEBUG] GEMM shape: m=256 n=96 k=424 lda=256 ldb=424 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000359313
  time (contract): 8.5439e-05
  gflops: 243.922
-----------------------------------
max element torch :      122
max element jit :        122
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=108 (dimensions: 16,16,96,108,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,108,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 108
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000298759
  gflops: 71.0728
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->108];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->432
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->108
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7f6fd000
[DEBUG] GEMM shape: m=256 n=96 k=432 lda=256 ldb=432 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354833
  time (contract): 8.81184e-05
  gflops: 240.967
-----------------------------------
max element torch :      125
max element jit :        125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=110 (dimensions: 16,16,96,110,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,110,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 110
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000298772
  gflops: 72.3859
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->110];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->440
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->110
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa28a3000
[DEBUG] GEMM shape: m=256 n=96 k=440 lda=256 ldb=440 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335538
  time (contract): 8.72106e-05
  gflops: 247.985
-----------------------------------
max element torch :      128
max element jit :        128
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=112 (dimensions: 16,16,96,112,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,112,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 112
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000302963
  gflops: 72.6824
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->112];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->448
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->112
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9633f000
[DEBUG] GEMM shape: m=256 n=96 k=448 lda=256 ldb=448 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000361713
  time (contract): 9.20617e-05
  gflops: 239.189
-----------------------------------
max element torch :      128
max element jit :        128
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=114 (dimensions: 16,16,96,114,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,114,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 114
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000303655
  gflops: 73.8118
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->114];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->456
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->114
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f547000
[DEBUG] GEMM shape: m=256 n=96 k=456 lda=256 ldb=456 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000341842
  time (contract): 9.12352e-05
  gflops: 245.665
-----------------------------------
max element torch :      129
max element jit :        129
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=116 (dimensions: 16,16,96,116,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,116,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 116
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000308188
  gflops: 74.002
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->116];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->464
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->116
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb085e000
[DEBUG] GEMM shape: m=256 n=96 k=464 lda=256 ldb=464 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000285524
  time (contract): 9.30531e-05
  gflops: 245.091
-----------------------------------
max element torch :      137
max element jit :        137
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=118 (dimensions: 16,16,96,118,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,118,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 118
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000313314
  gflops: 74.0464
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->118];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->472
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->118
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa78e4000
[DEBUG] GEMM shape: m=256 n=96 k=472 lda=256 ldb=472 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000299572
  time (contract): 9.4291e-05
  gflops: 246.044
-----------------------------------
max element torch :      137
max element jit :        137
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=120 (dimensions: 16,16,96,120,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,120,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 120
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000315773
  gflops: 74.7149
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->120];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->480
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->120
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5374000
[DEBUG] GEMM shape: m=256 n=96 k=480 lda=256 ldb=480 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034309
  time (contract): 9.90487e-05
  gflops: 238.196
-----------------------------------
max element torch :      135
max element jit :        135
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=122 (dimensions: 16,16,96,122,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,122,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 122
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000313953
  gflops: 76.4006
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->122];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->488
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->122
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7771000
[DEBUG] GEMM shape: m=256 n=96 k=488 lda=256 ldb=488 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000344753
  time (contract): 0.000104068
  gflops: 230.485
-----------------------------------
max element torch :      139
max element jit :        139
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=124 (dimensions: 16,16,96,124,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,124,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 124
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000323034
  gflops: 75.47
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->124];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->496
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->124
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba32a000
[DEBUG] GEMM shape: m=256 n=96 k=496 lda=256 ldb=496 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000371537
  time (contract): 0.000103439
  gflops: 235.689
-----------------------------------
max element torch :      145
max element jit :        145
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=126 (dimensions: 16,16,96,126,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,126,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 126
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000333722
  gflops: 74.2312
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->126];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->504
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->126
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9edc1000
[DEBUG] GEMM shape: m=256 n=96 k=504 lda=256 ldb=504 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337075
  time (contract): 0.000110212
  gflops: 224.773
-----------------------------------
max element torch :      145
max element jit :        145
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=128 (dimensions: 16,16,96,128,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,128,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 128
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000336193
  gflops: 74.8553
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->128];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->512
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->128
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94f81000
[DEBUG] GEMM shape: m=256 n=96 k=512 lda=256 ldb=512 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000341586
  time (contract): 0.000105366
  gflops: 238.842
-----------------------------------
max element torch :      146
max element jit :        146
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=130 (dimensions: 16,16,96,130,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,130,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 130
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000344455
  gflops: 74.2015
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->130];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->520
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->130
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7fca000
[DEBUG] GEMM shape: m=256 n=96 k=520 lda=256 ldb=520 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345074
  time (contract): 0.000103596
  gflops: 246.719
-----------------------------------
max element torch :      154
max element jit :        154
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=132 (dimensions: 16,16,96,132,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,132,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 132
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000350368
  gflops: 74.0715
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->132];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->528
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->132
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb59d2000
[DEBUG] GEMM shape: m=256 n=96 k=528 lda=256 ldb=528 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000301267
  time (contract): 0.000113484
  gflops: 228.686
-----------------------------------
max element torch :      151
max element jit :        151
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=134 (dimensions: 16,16,96,134,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,134,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 134
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000352169
  gflops: 74.8093
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->134];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->536
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->134
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa99b5000
[DEBUG] GEMM shape: m=256 n=96 k=536 lda=256 ldb=536 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000297587
  time (contract): 0.000108046
  gflops: 243.836
-----------------------------------
max element torch :      158
max element jit :        158
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=136 (dimensions: 16,16,96,136,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,136,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 136
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000364821
  gflops: 73.2926
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->136];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->544
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->136
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8ee21000
[DEBUG] GEMM shape: m=256 n=96 k=544 lda=256 ldb=544 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345938
  time (contract): 0.000112976
  gflops: 236.677
-----------------------------------
max element torch :      159
max element jit :        159
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=138 (dimensions: 16,16,96,138,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,138,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 138
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000365751
  gflops: 74.1813
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->138];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->552
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->138
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92c04000
[DEBUG] GEMM shape: m=256 n=96 k=552 lda=256 ldb=552 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000336402
  time (contract): 0.000125838
  gflops: 215.61
-----------------------------------
max element torch :      156
max element jit :        156
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=140 (dimensions: 16,16,96,140,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,140,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 140
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000373054
  gflops: 73.7833
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->140];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->560
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->140
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0a7d000
[DEBUG] GEMM shape: m=256 n=96 k=560 lda=256 ldb=560 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333586
  time (contract): 0.000118446
  gflops: 232.386
-----------------------------------
max element torch :      157
max element jit :        157
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=142 (dimensions: 16,16,96,142,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,142,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 142
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00037296
  gflops: 74.8561
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->142];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->568
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->142
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffafc41000
[DEBUG] GEMM shape: m=256 n=96 k=568 lda=256 ldb=568 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000339986
  time (contract): 0.000117456
  gflops: 237.692
-----------------------------------
max element torch :      162
max element jit :        162
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=144 (dimensions: 16,16,96,144,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,144,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 144
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000376019
  gflops: 75.2929
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->144];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->576
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->144
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff95a21000
[DEBUG] GEMM shape: m=256 n=96 k=576 lda=256 ldb=576 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000299988
  time (contract): 0.000120414
  gflops: 235.119
-----------------------------------
max element torch :      162
max element jit :        162
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=146 (dimensions: 16,16,96,146,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,146,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 146
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000382294
  gflops: 75.0857
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->146];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->584
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->146
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb092a000
[DEBUG] GEMM shape: m=256 n=96 k=584 lda=256 ldb=584 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000342482
  time (contract): 0.000115707
  gflops: 248.082
-----------------------------------
max element torch :      165
max element jit :        165
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=148 (dimensions: 16,16,96,148,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,148,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 148
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000385716
  gflops: 75.4388
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->148];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->592
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->148
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb627e000
[DEBUG] GEMM shape: m=256 n=96 k=592 lda=256 ldb=592 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034885
  time (contract): 0.000119488
  gflops: 243.523
-----------------------------------
max element torch :      169
max element jit :        169
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=150 (dimensions: 16,16,96,150,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,150,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 150
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000378127
  gflops: 77.9928
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->150];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->600
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->150
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3053000
[DEBUG] GEMM shape: m=256 n=96 k=600 lda=256 ldb=600 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000362257
  time (contract): 0.000129479
  gflops: 227.767
-----------------------------------
max element torch :      174
max element jit :        174
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=152 (dimensions: 16,16,96,152,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,152,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 152
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00038798
  gflops: 77.0257
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->152];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->608
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->152
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb3567000
[DEBUG] GEMM shape: m=256 n=96 k=608 lda=256 ldb=608 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000360113
  time (contract): 0.000120597
  gflops: 247.804
-----------------------------------
max element torch :      173
max element jit :        173
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=154 (dimensions: 16,16,96,154,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,154,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 154
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000384042
  gflops: 78.8393
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->154];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->616
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->154
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb44e4000
[DEBUG] GEMM shape: m=256 n=96 k=616 lda=256 ldb=616 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333107
  time (contract): 0.000131221
  gflops: 230.738
-----------------------------------
max element torch :      176
max element jit :        176
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=156 (dimensions: 16,16,96,156,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,156,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 156
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000393035
  gflops: 78.036
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->156];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->624
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->156
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90b41000
[DEBUG] GEMM shape: m=256 n=96 k=624 lda=256 ldb=624 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034565
  time (contract): 0.00013356
  gflops: 229.641
-----------------------------------
max element torch :      175
max element jit :        175
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=158 (dimensions: 16,16,96,158,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,158,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 158
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000395405
  gflops: 78.5627
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->158];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->632
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->158
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab923000
[DEBUG] GEMM shape: m=256 n=96 k=632 lda=256 ldb=632 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000347218
  time (contract): 0.000143308
  gflops: 216.765
-----------------------------------
max element torch :      178
max element jit :        178
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=160 (dimensions: 16,16,96,160,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,160,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 160
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.0004004
  gflops: 78.5646
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->160];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->640
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->160
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff98237000
[DEBUG] GEMM shape: m=256 n=96 k=640 lda=256 ldb=640 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312851
  time (contract): 0.000138079
  gflops: 227.82
-----------------------------------
max element torch :      192
max element jit :        192
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=162 (dimensions: 16,16,96,162,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,162,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 162
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000408299
  gflops: 78.0078
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->162];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->648
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->162
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaca17000
[DEBUG] GEMM shape: m=256 n=96 k=648 lda=256 ldb=648 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354673
  time (contract): 0.000131926
  gflops: 241.427
-----------------------------------
max element torch :      182
max element jit :        182
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=164 (dimensions: 16,16,96,164,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,164,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 164
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000432649
  gflops: 74.5262
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->164];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->656
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->164
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7fb17000
[DEBUG] GEMM shape: m=256 n=96 k=656 lda=256 ldb=656 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000352785
  time (contract): 0.000138322
  gflops: 233.107
-----------------------------------
max element torch :      187
max element jit :        187
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=166 (dimensions: 16,16,96,166,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,166,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 166
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000408617
  gflops: 79.8718
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->166];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->664
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->166
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87b9d000
[DEBUG] GEMM shape: m=256 n=96 k=664 lda=256 ldb=664 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000358066
  time (contract): 0.000141124
  gflops: 231.265
-----------------------------------
max element torch :      188
max element jit :        188
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=168 (dimensions: 16,16,96,168,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,168,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 168
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000430786
  gflops: 76.6742
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->168];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->672
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->168
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbaf01000
[DEBUG] GEMM shape: m=256 n=96 k=672 lda=256 ldb=672 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000368881
  time (contract): 0.000154757
  gflops: 213.433
-----------------------------------
max element torch :      187
max element jit :        187
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=170 (dimensions: 16,16,96,170,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,170,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 170
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000422969
  gflops: 79.0209
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->170];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->680
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->170
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff943d1000
[DEBUG] GEMM shape: m=256 n=96 k=680 lda=256 ldb=680 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335474
  time (contract): 0.000139047
  gflops: 240.374
-----------------------------------
max element torch :      187
max element jit :        187
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=172 (dimensions: 16,16,96,172,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,172,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 172
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000425151
  gflops: 79.5402
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->172];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->688
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->172
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff93a2c000
[DEBUG] GEMM shape: m=256 n=96 k=688 lda=256 ldb=688 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000311731
  time (contract): 0.000146481
  gflops: 230.86
-----------------------------------
max element torch :      192
max element jit :        193
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00657895
Torch value at max error:151
Kernel value at max error:152

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=174 (dimensions: 16,16,96,174,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,174,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 174
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000417457
  gflops: 81.948
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->174];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->696
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->174
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa0154000
[DEBUG] GEMM shape: m=256 n=96 k=696 lda=256 ldb=696 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305555
  time (contract): 0.000141656
  gflops: 241.499
-----------------------------------
max element torch :      196
max element jit :        196
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00636943
Torch value at max error:157
Kernel value at max error:156

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=176 (dimensions: 16,16,96,176,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,176,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 176
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000443279
  gflops: 78.0615
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->176];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->704
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->176
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa557c000
[DEBUG] GEMM shape: m=256 n=96 k=704 lda=256 ldb=704 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000346738
  time (contract): 0.000165805
  gflops: 208.698
-----------------------------------
max element torch :      195
max element jit :        195
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00645161
Torch value at max error:154
Kernel value at max error:155

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=178 (dimensions: 16,16,96,178,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,178,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 178
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000429937
  gflops: 81.3984
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->178];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->712
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->178
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb91cc000
[DEBUG] GEMM shape: m=256 n=96 k=712 lda=256 ldb=712 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000355826
  time (contract): 0.000155254
  gflops: 225.412
-----------------------------------
max element torch :      206
max element jit :        206
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00628931
Torch value at max error:158
Kernel value at max error:159

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=180 (dimensions: 16,16,96,180,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,180,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 180
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000475676
  gflops: 74.3982
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->180];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->720
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->180
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf781000
[DEBUG] GEMM shape: m=256 n=96 k=720 lda=256 ldb=720 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000363314
  time (contract): 0.000159309
  gflops: 222.144
-----------------------------------
max element torch :      203
max element jit :        202
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00628931
Torch value at max error:158
Kernel value at max error:159

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=182 (dimensions: 16,16,96,182,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,182,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 182
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000459934
  gflops: 77.7996
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->182];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->728
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->182
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91f46000
[DEBUG] GEMM shape: m=256 n=96 k=728 lda=256 ldb=728 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000350929
  time (contract): 0.000151885
  gflops: 235.591
-----------------------------------
max element torch :      204
max element jit :        203
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00617284
Torch value at max error:161
Kernel value at max error:162

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=184 (dimensions: 16,16,96,184,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,184,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 184
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000469081
  gflops: 77.1207
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->184];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->736
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->184
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa431d000
[DEBUG] GEMM shape: m=256 n=96 k=736 lda=256 ldb=736 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000318931
  time (contract): 0.000145721
  gflops: 248.255
-----------------------------------
max element torch :      209
max element jit :        209
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00609756
Torch value at max error:163
Kernel value at max error:164

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=186 (dimensions: 16,16,96,186,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,186,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 186
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000481072
  gflops: 76.0159
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->186];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->744
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->186
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9ad9000
[DEBUG] GEMM shape: m=256 n=96 k=744 lda=256 ldb=744 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000315667
  time (contract): 0.000158594
  gflops: 230.584
-----------------------------------
max element torch :      212
max element jit :        212
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00613497
Torch value at max error:163
Kernel value at max error:162

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=188 (dimensions: 16,16,96,188,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,188,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 188
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000481158
  gflops: 76.8195
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->188];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->752
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->188
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa37cf000
[DEBUG] GEMM shape: m=256 n=96 k=752 lda=256 ldb=752 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000319251
  time (contract): 0.000157722
  gflops: 234.351
-----------------------------------
max element torch :      212
max element jit :        212
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00588235
Torch value at max error:169
Kernel value at max error:170

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=190 (dimensions: 16,16,96,190,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,190,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 190
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000483965
  gflops: 77.1865
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->190];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->760
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->190
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb20b1000
[DEBUG] GEMM shape: m=256 n=96 k=760 lda=256 ldb=760 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035141
  time (contract): 0.000165577
  gflops: 225.608
-----------------------------------
max element torch :      210
max element jit :        209
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00595238
Torch value at max error:168
Kernel value at max error:167

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=192 (dimensions: 16,16,96,192,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,192,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 192
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000481819
  gflops: 78.3463
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->192];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->768
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->192
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaa0d1000
[DEBUG] GEMM shape: m=256 n=96 k=768 lda=256 ldb=768 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000303732
  time (contract): 0.000205203
  gflops: 183.958
-----------------------------------
max element torch :      214
max element jit :        214
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00581395
Torch value at max error:172
Kernel value at max error:171

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=194 (dimensions: 16,16,96,194,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,194,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 194
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000498817
  gflops: 76.4649
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->194];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->776
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->194
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5a90000
[DEBUG] GEMM shape: m=256 n=96 k=776 lda=256 ldb=776 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348754
  time (contract): 0.00016304
  gflops: 233.942
-----------------------------------
max element torch :      218
max element jit :        217
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00571429
Torch value at max error:175
Kernel value at max error:174

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=196 (dimensions: 16,16,96,196,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,196,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 196
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000516472
  gflops: 74.6124
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->196];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->784
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->196
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d67a000
[DEBUG] GEMM shape: m=256 n=96 k=784 lda=256 ldb=784 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000379664
  time (contract): 0.000170601
  gflops: 225.879
-----------------------------------
max element torch :      216
max element jit :        215
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00574713
Torch value at max error:173
Kernel value at max error:174

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=198 (dimensions: 16,16,96,198,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,198,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 198
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000494155
  gflops: 78.7776
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->198];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->792
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->198
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf01c000
[DEBUG] GEMM shape: m=256 n=96 k=792 lda=256 ldb=792 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000351954
  time (contract): 0.00020305
  gflops: 191.718
-----------------------------------
max element torch :      221
max element jit :        221
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00571429
Torch value at max error:174
Kernel value at max error:175

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=200 (dimensions: 16,16,96,200,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,200,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 200
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000503037
  gflops: 78.1684
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->200];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->800
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->200
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88739000
[DEBUG] GEMM shape: m=256 n=96 k=800 lda=256 ldb=800 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000370865
  time (contract): 0.000205248
  gflops: 191.581
-----------------------------------
max element torch :      224
max element jit :        224
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00555556
Torch value at max error:179
Kernel value at max error:180

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=202 (dimensions: 16,16,96,202,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,202,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 202
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000519178
  gflops: 76.4955
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->202];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->808
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->202
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaa506000
[DEBUG] GEMM shape: m=256 n=96 k=808 lda=256 ldb=808 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338547
  time (contract): 0.000168595
  gflops: 235.563
-----------------------------------
max element torch :      222
max element jit :        222
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00549451
Torch value at max error:181
Kernel value at max error:182

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=204 (dimensions: 16,16,96,204,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,204,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 204
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000520397
  gflops: 77.072
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->204];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->816
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->204
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d74d000
[DEBUG] GEMM shape: m=256 n=96 k=816 lda=256 ldb=816 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000317556
  time (contract): 0.000183915
  gflops: 218.079
-----------------------------------
max element torch :      224
max element jit :        224
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00549451
Torch value at max error:181
Kernel value at max error:182

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=206 (dimensions: 16,16,96,206,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,206,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 206
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000524419
  gflops: 77.2307
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->206];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->824
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->206
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88c22000
[DEBUG] GEMM shape: m=256 n=96 k=824 lda=256 ldb=824 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323955
  time (contract): 0.000204022
  gflops: 198.514
-----------------------------------
max element torch :      228
max element jit :        228
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00534759
Torch value at max error:186
Kernel value at max error:187

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=208 (dimensions: 16,16,96,208,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,208,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 208
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000523679
  gflops: 78.0907
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->208];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->832
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->208
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8100000
[DEBUG] GEMM shape: m=256 n=96 k=832 lda=256 ldb=832 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000317843
  time (contract): 0.000193998
  gflops: 210.798
-----------------------------------
max element torch :      235
max element jit :        235
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00546448
Torch value at max error:183
Kernel value at max error:182

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=210 (dimensions: 16,16,96,210,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,210,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 210
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000541015
  gflops: 76.3153
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->210];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->840
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->210
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4174000
[DEBUG] GEMM shape: m=256 n=96 k=840 lda=256 ldb=840 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000391472
  time (contract): 0.000228138
  gflops: 180.977
-----------------------------------
max element torch :      239
max element jit :        239
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00529101
Torch value at max error:188
Kernel value at max error:189

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=212 (dimensions: 16,16,96,212,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,212,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 212
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000542078
  gflops: 76.8909
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->212];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->848
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->212
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96524000
[DEBUG] GEMM shape: m=256 n=96 k=848 lda=256 ldb=848 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306899
  time (contract): 0.000183507
  gflops: 227.135
-----------------------------------
max element torch :      236
max element jit :        236
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00529101
Torch value at max error:188
Kernel value at max error:189

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=214 (dimensions: 16,16,96,214,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,214,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 214
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00054331
  gflops: 77.4403
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->214];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->856
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->214
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f40a000
[DEBUG] GEMM shape: m=256 n=96 k=856 lda=256 ldb=856 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320467
  time (contract): 0.000184008
  gflops: 228.654
-----------------------------------
max element torch :      238
max element jit :        238
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00526316
Torch value at max error:190
Kernel value at max error:189

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=216 (dimensions: 16,16,96,216,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,216,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 216
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.0005433
  gflops: 78.1656
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->216];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->864
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->216
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0c35000
[DEBUG] GEMM shape: m=256 n=96 k=864 lda=256 ldb=864 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000362738
  time (contract): 0.000208335
  gflops: 203.842
-----------------------------------
max element torch :      237
max element jit :        237
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00512821
Torch value at max error:194
Kernel value at max error:195

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=218 (dimensions: 16,16,96,218,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,218,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 218
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000557728
  gflops: 76.8484
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->218];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->872
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->218
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc363000
[DEBUG] GEMM shape: m=256 n=96 k=872 lda=256 ldb=872 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000374256
  time (contract): 0.000239269
  gflops: 179.131
-----------------------------------
max element torch :      244
max element jit :        244
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00507614
Torch value at max error:197
Kernel value at max error:196

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=220 (dimensions: 16,16,96,220,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,220,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 220
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000438511
  gflops: 98.6377
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->220];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->880
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->220
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ae02000
[DEBUG] GEMM shape: m=256 n=96 k=880 lda=256 ldb=880 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000382064
  time (contract): 0.000201341
  gflops: 214.829
-----------------------------------
max element torch :      246
max element jit :        246
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00510204
Torch value at max error:195
Kernel value at max error:196

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=222 (dimensions: 16,16,96,222,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,222,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 222
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000439499
  gflops: 99.3108
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->222];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->888
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->222
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84c6a000
[DEBUG] GEMM shape: m=256 n=96 k=888 lda=256 ldb=888 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000344338
  time (contract): 0.000195438
  gflops: 223.329
-----------------------------------
max element torch :      251
max element jit :        251
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00497512
Torch value at max error:201
Kernel value at max error:200

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=224 (dimensions: 16,16,96,224,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,224,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 224
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000446091
  gflops: 98.7247
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->224];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->896
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->224
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e3d7000
[DEBUG] GEMM shape: m=256 n=96 k=896 lda=256 ldb=896 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000404623
  time (contract): 0.00020859
  gflops: 211.133
-----------------------------------
max element torch :      251
max element jit :        251
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00492611
Torch value at max error:202
Kernel value at max error:203

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=226 (dimensions: 16,16,96,226,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,226,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 226
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000444873
  gflops: 99.8789
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->226];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->904
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->226
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96abb000
[DEBUG] GEMM shape: m=256 n=96 k=904 lda=256 ldb=904 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000360017
  time (contract): 0.000240663
  gflops: 184.629
-----------------------------------
max element torch :      248
max element jit :        248
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00497512
Torch value at max error:200
Kernel value at max error:201

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=228 (dimensions: 16,16,96,228,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,228,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 228
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000448214
  gflops: 100.012
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->228];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->912
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->228
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b2b3000
[DEBUG] GEMM shape: m=256 n=96 k=912 lda=256 ldb=912 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338642
  time (contract): 0.000202522
  gflops: 221.342
-----------------------------------
max element torch :      252
max element jit :        251
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00490196
Torch value at max error:203
Kernel value at max error:204

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=230 (dimensions: 16,16,96,230,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,230,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 230
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000453244
  gflops: 99.7693
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->230];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->920
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->230
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb01c1000
[DEBUG] GEMM shape: m=256 n=96 k=920 lda=256 ldb=920 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000364689
  time (contract): 0.00020453
  gflops: 221.091
-----------------------------------
max element torch :      251
max element jit :        251
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00483092
Torch value at max error:207
Kernel value at max error:206

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=232 (dimensions: 16,16,96,232,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,232,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 232
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000456223
  gflops: 99.9797
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->232];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->928
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->232
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa982e000
[DEBUG] GEMM shape: m=256 n=96 k=928 lda=256 ldb=928 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000344018
  time (contract): 0.000278145
  gflops: 163.99
-----------------------------------
max element torch :      260
max element jit :        258
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:258
Kernel value at max error:256

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=234 (dimensions: 16,16,96,234,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,234,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 234
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000457333
  gflops: 100.597
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->234];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->936
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->234
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbcd01000
[DEBUG] GEMM shape: m=256 n=96 k=936 lda=256 ldb=936 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306516
  time (contract): 0.000217049
  gflops: 211.963
-----------------------------------
max element torch :      262
max element jit :        262
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0047619
Torch value at max error:210
Kernel value at max error:209

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=236 (dimensions: 16,16,96,236,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,236,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 236
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000459204
  gflops: 101.043
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->236];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->944
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->236
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbb395000
[DEBUG] GEMM shape: m=256 n=96 k=944 lda=256 ldb=944 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00039864
  time (contract): 0.000213381
  gflops: 217.449
-----------------------------------
max element torch :      260
max element jit :        260
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=238 (dimensions: 16,16,96,238,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,238,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 238
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000466147
  gflops: 100.382
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->238];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->952
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->238
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8f9f7000
[DEBUG] GEMM shape: m=256 n=96 k=952 lda=256 ldb=952 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000392816
  time (contract): 0.000267194
  gflops: 175.127
-----------------------------------
max element torch :      264
max element jit :        264
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=240 (dimensions: 16,16,96,240,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,240,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 240
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000478398
  gflops: 98.6332
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->240];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->960
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->240
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90437000
[DEBUG] GEMM shape: m=256 n=96 k=960 lda=256 ldb=960 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000383025
  time (contract): 0.000230763
  gflops: 204.478
-----------------------------------
max element torch :      262
max element jit :        262
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:258
Kernel value at max error:256

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=242 (dimensions: 16,16,96,242,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,242,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 242
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000471947
  gflops: 100.815
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->242];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->968
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->242
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7fa2d000
[DEBUG] GEMM shape: m=256 n=96 k=968 lda=256 ldb=968 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000361746
  time (contract): 0.000219467
  gflops: 216.794
-----------------------------------
max element torch :      266
max element jit :        266
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:258
Kernel value at max error:256

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=244 (dimensions: 16,16,96,244,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,244,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 244
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000472552
  gflops: 101.518
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->244];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->976
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->244
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb39ae000
[DEBUG] GEMM shape: m=256 n=96 k=976 lda=256 ldb=976 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000336146
  time (contract): 0.000230374
  gflops: 208.236
-----------------------------------
max element torch :      270
max element jit :        270
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=246 (dimensions: 16,16,96,246,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,246,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 246
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000475699
  gflops: 101.673
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->246];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->984
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->246
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88f22000
[DEBUG] GEMM shape: m=256 n=96 k=984 lda=256 ldb=984 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333586
  time (contract): 0.000233164
  gflops: 207.431
-----------------------------------
max element torch :      268
max element jit :        268
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=248 (dimensions: 16,16,96,248,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,248,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 248
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00047462
  gflops: 102.732
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->248];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->992
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->248
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb72cb000
[DEBUG] GEMM shape: m=256 n=96 k=992 lda=256 ldb=992 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323538
  time (contract): 0.000248483
  gflops: 196.226
-----------------------------------
max element torch :      276
max element jit :        276
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=250 (dimensions: 16,16,96,250,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,250,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 250
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000484422
  gflops: 101.465
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->250];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1000
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->250
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89cc0000
[DEBUG] GEMM shape: m=256 n=96 k=1000 lda=256 ldb=1000 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338227
  time (contract): 0.000267746
  gflops: 183.577
-----------------------------------
max element torch :      282
max element jit :        282
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=252 (dimensions: 16,16,96,252,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,252,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 252
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000484589
  gflops: 102.242
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->252];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1008
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->252
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97c8e000
[DEBUG] GEMM shape: m=256 n=96 k=1008 lda=256 ldb=1008 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000318995
  time (contract): 0.000273605
  gflops: 181.083
-----------------------------------
max element torch :      276
max element jit :        276
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:258
Kernel value at max error:256

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=254 (dimensions: 16,16,96,254,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,254,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 254
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000486613
  gflops: 102.624
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->254];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1016
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->254
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82ca9000
[DEBUG] GEMM shape: m=256 n=96 k=1016 lda=256 ldb=1016 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343154
  time (contract): 0.000243297
  gflops: 205.257
-----------------------------------
max element torch :      288
max element jit :        286
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:258
Kernel value at max error:256

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=256 (dimensions: 16,16,96,256,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,256,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 256
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000510571
  gflops: 98.5791
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->256];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1024
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->256
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff964c5000
[DEBUG] GEMM shape: m=256 n=96 k=1024 lda=256 ldb=1024 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000383185
  time (contract): 0.000287228
  gflops: 175.232
-----------------------------------
max element torch :      282
max element jit :        280
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=258 (dimensions: 16,16,96,258,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,258,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 258
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000501538
  gflops: 101.139
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->258];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1032
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->258
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9259c000
[DEBUG] GEMM shape: m=256 n=96 k=1032 lda=256 ldb=1032 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000374321
  time (contract): 0.000241629
  gflops: 209.929
-----------------------------------
max element torch :      284
max element jit :        282
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=260 (dimensions: 16,16,96,260,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,260,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 260
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000499643
  gflops: 102.309
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->260];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1040
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->260
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffacf49000
[DEBUG] GEMM shape: m=256 n=96 k=1040 lda=256 ldb=1040 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000351922
  time (contract): 0.000295697
  gflops: 172.873
-----------------------------------
max element torch :      284
max element jit :        284
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:258
Kernel value at max error:256

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=262 (dimensions: 16,16,96,262,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,262,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 262
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000502722
  gflops: 102.465
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->262];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1048
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->262
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff908f6000
[DEBUG] GEMM shape: m=256 n=96 k=1048 lda=256 ldb=1048 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000448653
  time (contract): 0.000231714
  gflops: 222.306
-----------------------------------
max element torch :      286
max element jit :        286
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=264 (dimensions: 16,16,96,264,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,264,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 264
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000516638
  gflops: 100.466
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->264];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1056
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->264
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffac954000
[DEBUG] GEMM shape: m=256 n=96 k=1056 lda=256 ldb=1056 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325427
  time (contract): 0.000262217
  gflops: 197.945
-----------------------------------
max element torch :      288
max element jit :        288
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=266 (dimensions: 16,16,96,266,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,266,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 266
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000512352
  gflops: 102.074
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->266];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1064
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->266
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a6ce000
[DEBUG] GEMM shape: m=256 n=96 k=1064 lda=256 ldb=1064 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000308979
  time (contract): 0.000280187
  gflops: 186.653
-----------------------------------
max element torch :      290
max element jit :        292
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=268 (dimensions: 16,16,96,268,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,268,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 268
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.0005173
  gflops: 101.858
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->268];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1072
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->268
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7832000
[DEBUG] GEMM shape: m=256 n=96 k=1072 lda=256 ldb=1072 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000385169
  time (contract): 0.000302363
  gflops: 174.264
-----------------------------------
max element torch :      294
max element jit :        294
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:258
Kernel value at max error:256

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=270 (dimensions: 16,16,96,270,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,270,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 270
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00051569
  gflops: 102.938
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->270];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1080
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->270
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8a8cb000
[DEBUG] GEMM shape: m=256 n=96 k=1080 lda=256 ldb=1080 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354641
  time (contract): 0.000304045
  gflops: 174.593
-----------------------------------
max element torch :      294
max element jit :        294
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=272 (dimensions: 16,16,96,272,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,272,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 272
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000521006
  gflops: 102.642
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->272];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1088
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->272
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffadb44000
[DEBUG] GEMM shape: m=256 n=96 k=1088 lda=256 ldb=1088 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000371856
  time (contract): 0.000278581
  gflops: 191.964
-----------------------------------
max element torch :      296
max element jit :        296
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:258
Kernel value at max error:256

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=274 (dimensions: 16,16,96,274,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,274,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 274
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000530542
  gflops: 101.539
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->274];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1096
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->274
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffafac0000
[DEBUG] GEMM shape: m=256 n=96 k=1096 lda=256 ldb=1096 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000375825
  time (contract): 0.00031045
  gflops: 173.524
-----------------------------------
max element torch :      304
max element jit :        304
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:258
Kernel value at max error:256

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=276 (dimensions: 16,16,96,276,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,276,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 276
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000526337
  gflops: 103.097
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->276];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1104
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->276
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff83df3000
[DEBUG] GEMM shape: m=256 n=96 k=1104 lda=256 ldb=1104 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000359409
  time (contract): 0.000285824
  gflops: 189.851
-----------------------------------
max element torch :      302
max element jit :        302
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:256
Kernel value at max error:258

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=278 (dimensions: 16,16,96,278,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,278,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 278
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000535366
  gflops: 102.093
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->278];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1112
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->278
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8701a000
[DEBUG] GEMM shape: m=256 n=96 k=1112 lda=256 ldb=1112 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000355506
  time (contract): 0.000277226
  gflops: 197.157
-----------------------------------
max element torch :      310
max element jit :        310
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:258
Kernel value at max error:256

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=280 (dimensions: 16,16,96,280,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,280,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 280
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000533576
  gflops: 103.172
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->280];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1120
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->280
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbed03000
[DEBUG] GEMM shape: m=256 n=96 k=1120 lda=256 ldb=1120 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000360018
  time (contract): 0.000293889
  gflops: 187.316
-----------------------------------
max element torch :      306
max element jit :        306
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:258
Kernel value at max error:256

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=282 (dimensions: 16,16,96,282,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,282,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 282
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000540379
  gflops: 102.601
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->282];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1128
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->282
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9da57000
[DEBUG] GEMM shape: m=256 n=96 k=1128 lda=256 ldb=1128 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000301363
  time (contract): 0.000298655
  gflops: 185.644
-----------------------------------
max element torch :      312
max element jit :        312
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00769231
Torch value at max error:258
Kernel value at max error:260

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=284 (dimensions: 16,16,96,284,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,284,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 284
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000550345
  gflops: 101.458
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->284];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1136
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->284
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82a5b000
[DEBUG] GEMM shape: m=256 n=96 k=1136 lda=256 ldb=1136 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333362
  time (contract): 0.000317714
  gflops: 175.745
-----------------------------------
max element torch :      308
max element jit :        306
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00769231
Torch value at max error:258
Kernel value at max error:260

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=286 (dimensions: 16,16,96,286,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,286,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 286
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000544087
  gflops: 103.347
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->286];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1144
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->286
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88be6000
[DEBUG] GEMM shape: m=256 n=96 k=1144 lda=256 ldb=1144 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000297332
  time (contract): 0.00028072
  gflops: 200.306
-----------------------------------
max element torch :      310
max element jit :        310
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00769231
Torch value at max error:258
Kernel value at max error:260

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=288 (dimensions: 16,16,96,288,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,288,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 288
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000547502
  gflops: 103.421
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->288];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1152
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->288
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb162d000
[DEBUG] GEMM shape: m=256 n=96 k=1152 lda=256 ldb=1152 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033797
  time (contract): 0.000350454
  gflops: 161.571
-----------------------------------
max element torch :      316
max element jit :        316
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00763359
Torch value at max error:260
Kernel value at max error:262

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=290 (dimensions: 16,16,96,290,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,290,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 290
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000558648
  gflops: 102.061
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->290];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1160
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->290
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbcacc000
[DEBUG] GEMM shape: m=256 n=96 k=1160 lda=256 ldb=1160 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000314899
  time (contract): 0.000297096
  gflops: 191.912
-----------------------------------
max element torch :      316
max element jit :        316
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00757576
Torch value at max error:262
Kernel value at max error:264

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=292 (dimensions: 16,16,96,292,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,292,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 292
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000553004
  gflops: 103.814
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->292];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1168
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->292
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7c26000
[DEBUG] GEMM shape: m=256 n=96 k=1168 lda=256 ldb=1168 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000346866
  time (contract): 0.000302992
  gflops: 189.475
-----------------------------------
max element torch :      324
max element jit :        324
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0075188
Torch value at max error:264
Kernel value at max error:266

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=294 (dimensions: 16,16,96,294,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,294,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 294
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000560728
  gflops: 103.085
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->294];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1176
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->294
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9349000
[DEBUG] GEMM shape: m=256 n=96 k=1176 lda=256 ldb=1176 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000393904
  time (contract): 0.000292237
  gflops: 197.794
-----------------------------------
max element torch :      320
max element jit :        320
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00740741
Torch value at max error:270
Kernel value at max error:268

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=296 (dimensions: 16,16,96,296,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,296,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 296
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000562426
  gflops: 103.473
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->296];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1184
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->296
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbe5be000
[DEBUG] GEMM shape: m=256 n=96 k=1184 lda=256 ldb=1184 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034341
  time (contract): 0.000307217
  gflops: 189.429
-----------------------------------
max element torch :      322
max element jit :        322
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00740741
Torch value at max error:268
Kernel value at max error:270

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=298 (dimensions: 16,16,96,298,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,298,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 298
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000570084
  gflops: 102.773
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->298];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1192
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->298
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8571d000
[DEBUG] GEMM shape: m=256 n=96 k=1192 lda=256 ldb=1192 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034517
  time (contract): 0.000308903
  gflops: 189.669
-----------------------------------
max element torch :      328
max element jit :        326
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00735294
Torch value at max error:272
Kernel value at max error:270

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=300 (dimensions: 16,16,96,300,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,300,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 300
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000575344
  gflops: 102.517
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->300];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1200
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->300
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96c14000
[DEBUG] GEMM shape: m=256 n=96 k=1200 lda=256 ldb=1200 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000398927
  time (contract): 0.000332916
  gflops: 177.169
-----------------------------------
max element torch :      330
max element jit :        330
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00740741
Torch value at max error:268
Kernel value at max error:270

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=302 (dimensions: 16,16,96,302,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,302,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 302
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000575788
  gflops: 103.121
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->302];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1208
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->302
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b182000
[DEBUG] GEMM shape: m=256 n=96 k=1208 lda=256 ldb=1208 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000356593
  time (contract): 0.000324519
  gflops: 182.965
-----------------------------------
max element torch :      338
max element jit :        338
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00729927
Torch value at max error:274
Kernel value at max error:272

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=304 (dimensions: 16,16,96,304,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,304,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 304
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000578771
  gflops: 103.269
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->304];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1216
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->304
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa94b5000
[DEBUG] GEMM shape: m=256 n=96 k=1216 lda=256 ldb=1216 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000381425
  time (contract): 0.000342093
  gflops: 174.715
-----------------------------------
max element torch :      330
max element jit :        332
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00719424
Torch value at max error:278
Kernel value at max error:276

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=306 (dimensions: 16,16,96,306,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,306,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 306
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000578351
  gflops: 104.023
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->306];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1224
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->306
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80a6a000
[DEBUG] GEMM shape: m=256 n=96 k=1224 lda=256 ldb=1224 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343602
  time (contract): 0.000349721
  gflops: 172.029
-----------------------------------
max element torch :      334
max element jit :        334
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00719424
Torch value at max error:276
Kernel value at max error:278

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=308 (dimensions: 16,16,96,308,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,308,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 308
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000582387
  gflops: 103.978
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->308];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1232
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->308
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80195000
[DEBUG] GEMM shape: m=256 n=96 k=1232 lda=256 ldb=1232 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000341778
  time (contract): 0.000325663
  gflops: 185.945
-----------------------------------
max element torch :      338
max element jit :        340
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00724638
Torch value at max error:276
Kernel value at max error:274

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=310 (dimensions: 16,16,96,310,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,310,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 310
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000590954
  gflops: 103.136
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->310];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1240
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->310
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5881000
[DEBUG] GEMM shape: m=256 n=96 k=1240 lda=256 ldb=1240 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035701
  time (contract): 0.000359221
  gflops: 169.669
-----------------------------------
max element torch :      346
max element jit :        346
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00724638
Torch value at max error:274
Kernel value at max error:276

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=312 (dimensions: 16,16,96,312,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,312,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 312
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000599735
  gflops: 102.281
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->312];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1248
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->312
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffafa40000
[DEBUG] GEMM shape: m=256 n=96 k=1248 lda=256 ldb=1248 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00039256
  time (contract): 0.000341326
  gflops: 179.716
-----------------------------------
max element torch :      338
max element jit :        338
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00694444
Torch value at max error:286
Kernel value at max error:288

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=314 (dimensions: 16,16,96,314,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,314,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 314
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000595789
  gflops: 103.619
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->314];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1256
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->314
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c389000
[DEBUG] GEMM shape: m=256 n=96 k=1256 lda=256 ldb=1256 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000352658
  time (contract): 0.000371759
  gflops: 166.062
-----------------------------------
max element torch :      340
max element jit :        340
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00699301
Torch value at max error:286
Kernel value at max error:284

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=316 (dimensions: 16,16,96,316,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,316,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 316
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000604086
  gflops: 102.847
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->316];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1264
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->316
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96e05000
[DEBUG] GEMM shape: m=256 n=96 k=1264 lda=256 ldb=1264 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000382833
  time (contract): 0.000339595
  gflops: 182.948
-----------------------------------
max element torch :      348
max element jit :        348
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00704225
Torch value at max error:282
Kernel value at max error:284

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=318 (dimensions: 16,16,96,318,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,318,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 318
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000611186
  gflops: 102.295
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->318];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1272
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->318
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffabe08000
[DEBUG] GEMM shape: m=256 n=96 k=1272 lda=256 ldb=1272 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000365585
  time (contract): 0.000407517
  gflops: 153.42
-----------------------------------
max element torch :      342
max element jit :        342
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00689655
Torch value at max error:288
Kernel value at max error:290

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=320 (dimensions: 16,16,96,320,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,320,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 320
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000602143
  gflops: 104.484
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->320];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1280
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->320
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb87a7000
[DEBUG] GEMM shape: m=256 n=96 k=1280 lda=256 ldb=1280 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000375217
  time (contract): 0.000378256
  gflops: 166.328
-----------------------------------
max element torch :      352
max element jit :        352
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00680272
Torch value at max error:294
Kernel value at max error:292

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=322 (dimensions: 16,16,96,322,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,322,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 322
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000612809
  gflops: 103.308
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->322];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1288
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->322
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa719d000
[DEBUG] GEMM shape: m=256 n=96 k=1288 lda=256 ldb=1288 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354834
  time (contract): 0.000356612
  gflops: 177.526
-----------------------------------
max element torch :      352
max element jit :        352
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00694444
Torch value at max error:286
Kernel value at max error:288

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=324 (dimensions: 16,16,96,324,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,324,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 324
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000619083
  gflops: 102.896
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->324];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1296
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->324
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb679d000
[DEBUG] GEMM shape: m=256 n=96 k=1296 lda=256 ldb=1296 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000339698
  time (contract): 0.000351873
  gflops: 181.034
-----------------------------------
max element torch :      350
max element jit :        350
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00675676
Torch value at max error:296
Kernel value at max error:294

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=326 (dimensions: 16,16,96,326,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,326,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 326
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000612105
  gflops: 104.711
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->326];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1304
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->326
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa38e7000
[DEBUG] GEMM shape: m=256 n=96 k=1304 lda=256 ldb=1304 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000368433
  time (contract): 0.000373479
  gflops: 171.614
-----------------------------------
max element torch :      350
max element jit :        350
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00675676
Torch value at max error:294
Kernel value at max error:296

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=328 (dimensions: 16,16,96,328,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,328,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 328
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000615139
  gflops: 104.834
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->328];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1312
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->328
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80cf0000
[DEBUG] GEMM shape: m=256 n=96 k=1312 lda=256 ldb=1312 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323795
  time (contract): 0.000374832
  gflops: 172.044
-----------------------------------
max element torch :      356
max element jit :        356
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00662252
Torch value at max error:300
Kernel value at max error:302

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=330 (dimensions: 16,16,96,330,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,330,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 330
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000622369
  gflops: 104.248
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->330];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1320
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->330
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ecf6000
[DEBUG] GEMM shape: m=256 n=96 k=1320 lda=256 ldb=1320 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000364081
  time (contract): 0.000370631
  gflops: 175.055
-----------------------------------
max element torch :      358
max element jit :        358
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00662252
Torch value at max error:300
Kernel value at max error:302

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=332 (dimensions: 16,16,96,332,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,332,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 332
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000619426
  gflops: 105.378
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->332];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1328
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->332
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9f3e000
[DEBUG] GEMM shape: m=256 n=96 k=1328 lda=256 ldb=1328 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000316915
  time (contract): 0.000393298
  gflops: 165.966
-----------------------------------
max element torch :      364
max element jit :        364
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00657895
Torch value at max error:302
Kernel value at max error:304

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=334 (dimensions: 16,16,96,334,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,334,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 334
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.0006287
  gflops: 104.449
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->334];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1336
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->334
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1032000
[DEBUG] GEMM shape: m=256 n=96 k=1336 lda=256 ldb=1336 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000318099
  time (contract): 0.000407882
  gflops: 160.995
-----------------------------------
max element torch :      362
max element jit :        360
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00653595
Torch value at max error:304
Kernel value at max error:306

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=336 (dimensions: 16,16,96,336,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,336,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 336
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000626552
  gflops: 105.435
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->336];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1344
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->336
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82f99000
[DEBUG] GEMM shape: m=256 n=96 k=1344 lda=256 ldb=1344 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000355634
  time (contract): 0.000381616
  gflops: 173.107
-----------------------------------
max element torch :      364
max element jit :        364
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00649351
Torch value at max error:308
Kernel value at max error:306

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=338 (dimensions: 16,16,96,338,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,338,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 338
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000639021
  gflops: 103.993
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->338];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1352
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->338
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa24b3000
[DEBUG] GEMM shape: m=256 n=96 k=1352 lda=256 ldb=1352 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000365617
  time (contract): 0.000371692
  gflops: 178.786
-----------------------------------
max element torch :      372
max element jit :        372
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00653595
Torch value at max error:306
Kernel value at max error:304

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=340 (dimensions: 16,16,96,340,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,340,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 340
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000643299
  gflops: 103.912
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->340];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1360
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->340
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5b1d000
[DEBUG] GEMM shape: m=256 n=96 k=1360 lda=256 ldb=1360 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345074
  time (contract): 0.000399856
  gflops: 167.177
-----------------------------------
max element torch :      368
max element jit :        368
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00649351
Torch value at max error:306
Kernel value at max error:308

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=342 (dimensions: 16,16,96,342,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,342,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 342
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000641874
  gflops: 104.756
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->342];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1368
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->342
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5724000
[DEBUG] GEMM shape: m=256 n=96 k=1368 lda=256 ldb=1368 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000373329
  time (contract): 0.000376195
  gflops: 178.737
-----------------------------------
max element torch :      374
max element jit :        372
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00653595
Torch value at max error:304
Kernel value at max error:306

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=344 (dimensions: 16,16,96,344,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,344,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 344
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000652049
  gflops: 103.724
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->344];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1376
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->344
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaeb1c000
[DEBUG] GEMM shape: m=256 n=96 k=1376 lda=256 ldb=1376 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320051
  time (contract): 0.000398681
  gflops: 169.642
-----------------------------------
max element torch :      368
max element jit :        368
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00632911
Torch value at max error:314
Kernel value at max error:316

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=346 (dimensions: 16,16,96,346,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,346,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 346
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000646593
  gflops: 105.207
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->346];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1384
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->346
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f5b8000
[DEBUG] GEMM shape: m=256 n=96 k=1384 lda=256 ldb=1384 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329203
  time (contract): 0.000385899
  gflops: 176.28
-----------------------------------
max element torch :      374
max element jit :        374
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00628931
Torch value at max error:318
Kernel value at max error:316

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=348 (dimensions: 16,16,96,348,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,348,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 348
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000648813
  gflops: 105.453
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->348];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1392
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->348
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3d0f000
[DEBUG] GEMM shape: m=256 n=96 k=1392 lda=256 ldb=1392 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000364145
  time (contract): 0.000384314
  gflops: 178.03
-----------------------------------
max element torch :      382
max element jit :        382
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00628931
Torch value at max error:318
Kernel value at max error:316

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=350 (dimensions: 16,16,96,350,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,350,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 350
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000663511
  gflops: 103.71
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->350];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1400
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->350
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94ef2000
[DEBUG] GEMM shape: m=256 n=96 k=1400 lda=256 ldb=1400 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000371697
  time (contract): 0.000388954
  gflops: 176.918
-----------------------------------
max element torch :      380
max element jit :        380
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00625
Torch value at max error:318
Kernel value at max error:320

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=352 (dimensions: 16,16,96,352,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,352,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 352
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000660118
  gflops: 104.839
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->352];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1408
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->352
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a374000
[DEBUG] GEMM shape: m=256 n=96 k=1408 lda=256 ldb=1408 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000385776
  time (contract): 0.000401362
  gflops: 172.428
-----------------------------------
max element torch :      382
max element jit :        382
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00636943
Torch value at max error:314
Kernel value at max error:312

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=354 (dimensions: 16,16,96,354,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,354,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 354
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000667841
  gflops: 104.215
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->354];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1416
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->354
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e8d0000
[DEBUG] GEMM shape: m=256 n=96 k=1416 lda=256 ldb=1416 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000349745
  time (contract): 0.000394683
  gflops: 176.342
-----------------------------------
max element torch :      384
max element jit :        384
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00625
Torch value at max error:318
Kernel value at max error:320

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=356 (dimensions: 16,16,96,356,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,356,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 356
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000666706
  gflops: 104.983
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->356];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1424
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->356
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa450a000
[DEBUG] GEMM shape: m=256 n=96 k=1424 lda=256 ldb=1424 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312531
  time (contract): 0.000404463
  gflops: 173.05
-----------------------------------
max element torch :      390
max element jit :        390
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0060241
Torch value at max error:332
Kernel value at max error:330

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=358 (dimensions: 16,16,96,358,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,358,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 358
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000664221
  gflops: 105.967
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->358];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1432
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->358
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9dd33000
[DEBUG] GEMM shape: m=256 n=96 k=1432 lda=256 ldb=1432 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000349042
  time (contract): 0.000417099
  gflops: 168.751
-----------------------------------
max element torch :      390
max element jit :        390
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00606061
Torch value at max error:328
Kernel value at max error:330

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=360 (dimensions: 16,16,96,360,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,360,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 360
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000675878
  gflops: 104.721
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->360];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1440
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->360
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff988c8000
[DEBUG] GEMM shape: m=256 n=96 k=1440 lda=256 ldb=1440 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000342226
  time (contract): 0.000404609
  gflops: 174.932
-----------------------------------
max element torch :      386
max element jit :        386
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00598802
Torch value at max error:332
Kernel value at max error:334

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=362 (dimensions: 16,16,96,362,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,362,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 362
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000672002
  gflops: 105.911
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->362];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1448
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->362
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbeea2000
[DEBUG] GEMM shape: m=256 n=96 k=1448 lda=256 ldb=1448 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335122
  time (contract): 0.000408212
  gflops: 174.351
-----------------------------------
max element torch :      394
max element jit :        394
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00609756
Torch value at max error:328
Kernel value at max error:326

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=364 (dimensions: 16,16,96,364,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,364,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 364
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000682626
  gflops: 104.838
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->364];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1456
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->364
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff95ad7000
[DEBUG] GEMM shape: m=256 n=96 k=1456 lda=256 ldb=1456 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000363473
  time (contract): 0.000421223
  gflops: 169.899
-----------------------------------
max element torch :      394
max element jit :        394
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00598802
Torch value at max error:332
Kernel value at max error:334

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=366 (dimensions: 16,16,96,366,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,366,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 366
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000680712
  gflops: 105.711
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->366];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1464
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->366
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff826c9000
[DEBUG] GEMM shape: m=256 n=96 k=1464 lda=256 ldb=1464 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000336883
  time (contract): 0.000414077
  gflops: 173.781
-----------------------------------
max element torch :      402
max element jit :        402
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00606061
Torch value at max error:330
Kernel value at max error:328

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=368 (dimensions: 16,16,96,368,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,368,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 368
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000687484
  gflops: 105.241
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->368];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1472
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->368
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82a6f000
[DEBUG] GEMM shape: m=256 n=96 k=1472 lda=256 ldb=1472 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000342258
  time (contract): 0.000427261
  gflops: 169.339
-----------------------------------
max element torch :      404
max element jit :        404
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00584795
Torch value at max error:342
Kernel value at max error:340

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=370 (dimensions: 16,16,96,370,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,370,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 370
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000690106
  gflops: 105.411
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->370];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1480
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->370
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e741000
[DEBUG] GEMM shape: m=256 n=96 k=1480 lda=256 ldb=1480 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000321747
  time (contract): 0.000402073
  gflops: 180.925
-----------------------------------
max element torch :      404
max element jit :        402
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00591716
Torch value at max error:336
Kernel value at max error:338

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=372 (dimensions: 16,16,96,372,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,372,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 372
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000694748
  gflops: 105.273
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->372];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1488
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->372
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff813d2000
[DEBUG] GEMM shape: m=256 n=96 k=1488 lda=256 ldb=1488 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000363506
  time (contract): 0.000411343
  gflops: 177.803
-----------------------------------
max element torch :      400
max element jit :        400
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00588235
Torch value at max error:338
Kernel value at max error:340

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=374 (dimensions: 16,16,96,374,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,374,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 374
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000702181
  gflops: 104.719
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->374];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1496
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->374
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94d7e000
[DEBUG] GEMM shape: m=256 n=96 k=1496 lda=256 ldb=1496 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320595
  time (contract): 0.000415237
  gflops: 177.083
-----------------------------------
max element torch :      404
max element jit :        406
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00588235
Torch value at max error:338
Kernel value at max error:340

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=376 (dimensions: 16,16,96,376,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,376,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 376
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000714501
  gflops: 103.463
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->376];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1504
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->376
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f026000
[DEBUG] GEMM shape: m=256 n=96 k=1504 lda=256 ldb=1504 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035509
  time (contract): 0.000427331
  gflops: 172.991
-----------------------------------
max element torch :      412
max element jit :        412
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00574713
Torch value at max error:348
Kernel value at max error:346

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=378 (dimensions: 16,16,96,378,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,378,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 378
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000705668
  gflops: 105.316
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->378];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1512
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->378
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff937e0000
[DEBUG] GEMM shape: m=256 n=96 k=1512 lda=256 ldb=1512 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000397168
  time (contract): 0.00041802
  gflops: 177.785
-----------------------------------
max element torch :      408
max element jit :        408
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00578035
Torch value at max error:344
Kernel value at max error:346

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=380 (dimensions: 16,16,96,380,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,380,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 380
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000708097
  gflops: 105.51
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->380];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1520
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->380
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbdd7c000
[DEBUG] GEMM shape: m=256 n=96 k=1520 lda=256 ldb=1520 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326387
  time (contract): 0.000444434
  gflops: 168.104
-----------------------------------
max element torch :      414
max element jit :        414
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00571429
Torch value at max error:348
Kernel value at max error:350

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=382 (dimensions: 16,16,96,382,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,382,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 382
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000716695
  gflops: 104.792
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->382];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1528
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->382
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1692000
[DEBUG] GEMM shape: m=256 n=96 k=1528 lda=256 ldb=1528 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000350769
  time (contract): 0.000447939
  gflops: 167.666
-----------------------------------
max element torch :      410
max element jit :        410
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00571429
Torch value at max error:348
Kernel value at max error:350

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=384 (dimensions: 16,16,96,384,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,384,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 384
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000726034
  gflops: 103.986
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->384];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1536
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->384
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1d3b000
[DEBUG] GEMM shape: m=256 n=96 k=1536 lda=256 ldb=1536 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000349522
  time (contract): 0.000461326
  gflops: 163.653
-----------------------------------
max element torch :      418
max element jit :        420
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00568182
Torch value at max error:350
Kernel value at max error:352

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=386 (dimensions: 16,16,96,386,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,386,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 386
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00071654
  gflops: 105.913
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->386];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1544
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->386
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaaf6c000
[DEBUG] GEMM shape: m=256 n=96 k=1544 lda=256 ldb=1544 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000307123
  time (contract): 0.000444843
  gflops: 170.601
-----------------------------------
max element torch :      414
max element jit :        412
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00558659
Torch value at max error:356
Kernel value at max error:358

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=388 (dimensions: 16,16,96,388,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,388,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 388
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000724555
  gflops: 105.284
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->388];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1552
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->388
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb10b2000
[DEBUG] GEMM shape: m=256 n=96 k=1552 lda=256 ldb=1552 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000401712
  time (contract): 0.000475834
  gflops: 160.316
-----------------------------------
max element torch :      416
max element jit :        416
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00558659
Torch value at max error:356
Kernel value at max error:358

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=390 (dimensions: 16,16,96,390,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,390,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 390
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000720145
  gflops: 106.475
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->390];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1560
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->390
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa4d58000
[DEBUG] GEMM shape: m=256 n=96 k=1560 lda=256 ldb=1560 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327923
  time (contract): 0.000429785
  gflops: 178.408
-----------------------------------
max element torch :      424
max element jit :        424
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00558659
Torch value at max error:358
Kernel value at max error:356

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=392 (dimensions: 16,16,96,392,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,392,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 392
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000729266
  gflops: 105.682
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->392];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1568
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->392
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8fcac000
[DEBUG] GEMM shape: m=256 n=96 k=1568 lda=256 ldb=1568 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000341778
  time (contract): 0.00045054
  gflops: 171.062
-----------------------------------
max element torch :      426
max element jit :        426
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00558659
Torch value at max error:356
Kernel value at max error:358

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=394 (dimensions: 16,16,96,394,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,394,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 394
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000726462
  gflops: 106.631
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->394];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1576
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->394
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad6d1000
[DEBUG] GEMM shape: m=256 n=96 k=1576 lda=256 ldb=1576 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000371633
  time (contract): 0.000459796
  gflops: 168.474
-----------------------------------
max element torch :      422
max element jit :        422
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00549451
Torch value at max error:362
Kernel value at max error:364

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=396 (dimensions: 16,16,96,396,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,396,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 396
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000734375
  gflops: 106.018
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->396];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1584
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->396
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaff3a000
[DEBUG] GEMM shape: m=256 n=96 k=1584 lda=256 ldb=1584 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033637
  time (contract): 0.000445675
  gflops: 174.694
-----------------------------------
max element torch :      426
max element jit :        426
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00564972
Torch value at max error:352
Kernel value at max error:354

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=398 (dimensions: 16,16,96,398,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,398,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 398
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000741033
  gflops: 105.596
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->398];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1592
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->398
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ed84000
[DEBUG] GEMM shape: m=256 n=96 k=1592 lda=256 ldb=1592 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000387408
  time (contract): 0.000470017
  gflops: 166.483
-----------------------------------
max element torch :      440
max element jit :        440
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00540541
Torch value at max error:370
Kernel value at max error:368

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=400 (dimensions: 16,16,96,400,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,400,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 400
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000739732
  gflops: 106.313
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->400];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1600
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->400
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7ff91000
[DEBUG] GEMM shape: m=256 n=96 k=1600 lda=256 ldb=1600 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034709
  time (contract): 0.000478123
  gflops: 164.483
-----------------------------------
max element torch :      436
max element jit :        436
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00543478
Torch value at max error:366
Kernel value at max error:368

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=402 (dimensions: 16,16,96,402,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,402,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 402
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000745058
  gflops: 106.081
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->402];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1608
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->402
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b707000
[DEBUG] GEMM shape: m=256 n=96 k=1608 lda=256 ldb=1608 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338611
  time (contract): 0.000465197
  gflops: 169.899
-----------------------------------
max element torch :      432
max element jit :        432
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00543478
Torch value at max error:366
Kernel value at max error:368

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=404 (dimensions: 16,16,96,404,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,404,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 404
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000749459
  gflops: 105.983
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->404];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1616
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->404
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa245a000
[DEBUG] GEMM shape: m=256 n=96 k=1616 lda=256 ldb=1616 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000334323
  time (contract): 0.000458405
  gflops: 173.274
-----------------------------------
max element torch :      434
max element jit :        436
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00534759
Torch value at max error:374
Kernel value at max error:372

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=406 (dimensions: 16,16,96,406,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,406,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 406
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000752378
  gflops: 106.094
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->406];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1624
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->406
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91b07000
[DEBUG] GEMM shape: m=256 n=96 k=1624 lda=256 ldb=1624 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000352242
  time (contract): 0.000469375
  gflops: 170.062
-----------------------------------
max element torch :      440
max element jit :        440
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00540541
Torch value at max error:368
Kernel value at max error:370

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=408 (dimensions: 16,16,96,408,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,408,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 408
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000751459
  gflops: 106.747
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->408];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1632
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->408
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99cc0000
[DEBUG] GEMM shape: m=256 n=96 k=1632 lda=256 ldb=1632 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000396112
  time (contract): 0.000476987
  gflops: 168.172
-----------------------------------
max element torch :      446
max element jit :        446
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00537634
Torch value at max error:370
Kernel value at max error:372

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=410 (dimensions: 16,16,96,410,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,410,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 410
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000762011
  gflops: 105.785
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->410];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1640
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->410
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa012b000
[DEBUG] GEMM shape: m=256 n=96 k=1640 lda=256 ldb=1640 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345906
  time (contract): 0.000465424
  gflops: 173.195
-----------------------------------
max element torch :      442
max element jit :        442
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00531915
Torch value at max error:374
Kernel value at max error:376

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=412 (dimensions: 16,16,96,412,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,412,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 412
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000761145
  gflops: 106.422
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->412];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1648
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->412
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91454000
[DEBUG] GEMM shape: m=256 n=96 k=1648 lda=256 ldb=1648 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000334002
  time (contract): 0.000463847
  gflops: 174.632
-----------------------------------
max element torch :      446
max element jit :        446
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00529101
Torch value at max error:376
Kernel value at max error:378

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=414 (dimensions: 16,16,96,414,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,414,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 414
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00076618
  gflops: 106.236
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->414];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1656
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->414
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b3f0000
[DEBUG] GEMM shape: m=256 n=96 k=1656 lda=256 ldb=1656 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00039624
  time (contract): 0.000484983
  gflops: 167.832
-----------------------------------
max element torch :      440
max element jit :        442
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0052356
Torch value at max error:380
Kernel value at max error:382

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=416 (dimensions: 16,16,96,416,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,416,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 416
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000775924
  gflops: 105.408
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->416];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1664
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->416
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad434000
[DEBUG] GEMM shape: m=256 n=96 k=1664 lda=256 ldb=1664 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000415023
  time (contract): 0.000486913
  gflops: 167.974
-----------------------------------
max element torch :      444
max element jit :        444
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0052356
Torch value at max error:382
Kernel value at max error:380

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=418 (dimensions: 16,16,96,418,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,418,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 418
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000778976
  gflops: 105.5
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->418];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1672
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->418
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb590d000
[DEBUG] GEMM shape: m=256 n=96 k=1672 lda=256 ldb=1672 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000380081
  time (contract): 0.000491258
  gflops: 167.289
-----------------------------------
max element torch :      446
max element jit :        448
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0052356
Torch value at max error:380
Kernel value at max error:382

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=420 (dimensions: 16,16,96,420,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,420,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 420
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000778238
  gflops: 106.106
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->420];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1680
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->420
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9fc78000
[DEBUG] GEMM shape: m=256 n=96 k=1680 lda=256 ldb=1680 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035845
  time (contract): 0.000485116
  gflops: 170.218
-----------------------------------
max element torch :      452
max element jit :        452
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00512821
Torch value at max error:390
Kernel value at max error:388

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=422 (dimensions: 16,16,96,422,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,422,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 422
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000774
  gflops: 107.195
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->422];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1688
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->422
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9fa1000
[DEBUG] GEMM shape: m=256 n=96 k=1688 lda=256 ldb=1688 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326643
  time (contract): 0.00047176
  gflops: 175.87
-----------------------------------
max element torch :      454
max element jit :        454
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00512821
Torch value at max error:390
Kernel value at max error:388

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=424 (dimensions: 16,16,96,424,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,424,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 424
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000776629
  gflops: 107.338
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->424];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1696
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->424
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86a9b000
[DEBUG] GEMM shape: m=256 n=96 k=1696 lda=256 ldb=1696 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000342034
  time (contract): 0.00048127
  gflops: 173.212
-----------------------------------
max element torch :      452
max element jit :        452
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00507614
Torch value at max error:392
Kernel value at max error:394

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=426 (dimensions: 16,16,96,426,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,426,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 426
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000791851
  gflops: 105.771
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->426];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1704
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->426
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7470000
[DEBUG] GEMM shape: m=256 n=96 k=1704 lda=256 ldb=1704 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348402
  time (contract): 0.000502349
  gflops: 166.727
-----------------------------------
max element torch :      466
max element jit :        466
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00512821
Torch value at max error:390
Kernel value at max error:388

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=428 (dimensions: 16,16,96,428,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,428,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 428
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00078062
  gflops: 107.797
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->428];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1712
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->428
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82293000
[DEBUG] GEMM shape: m=256 n=96 k=1712 lda=256 ldb=1712 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000360177
  time (contract): 0.000484169
  gflops: 173.799
-----------------------------------
max element torch :      466
max element jit :        464
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00510204
Torch value at max error:390
Kernel value at max error:392

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=430 (dimensions: 16,16,96,430,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,430,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 430
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000786636
  gflops: 107.472
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->430];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1720
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->430
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbba7b000
[DEBUG] GEMM shape: m=256 n=96 k=1720 lda=256 ldb=1720 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000367857
  time (contract): 0.000474742
  gflops: 178.079
-----------------------------------
max element torch :      466
max element jit :        466
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00502513
Torch value at max error:396
Kernel value at max error:398

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=432 (dimensions: 16,16,96,432,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,432,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 432
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000796229
  gflops: 106.671
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->432];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1728
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->432
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89f2f000
[DEBUG] GEMM shape: m=256 n=96 k=1728 lda=256 ldb=1728 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000334194
  time (contract): 0.000504362
  gflops: 168.4
-----------------------------------
max element torch :      468
max element jit :        468
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00505051
Torch value at max error:394
Kernel value at max error:396

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=434 (dimensions: 16,16,96,434,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,434,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 434
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000788679
  gflops: 108.191
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->434];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1736
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->434
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaee5b000
[DEBUG] GEMM shape: m=256 n=96 k=1736 lda=256 ldb=1736 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000385265
  time (contract): 0.000481783
  gflops: 177.108
-----------------------------------
max element torch :      464
max element jit :        462
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00502513
Torch value at max error:396
Kernel value at max error:398

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=436 (dimensions: 16,16,96,436,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,436,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 436
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000802054
  gflops: 106.877
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->436];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1744
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->436
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb90cd000
[DEBUG] GEMM shape: m=256 n=96 k=1744 lda=256 ldb=1744 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000404751
  time (contract): 0.000493425
  gflops: 173.727
-----------------------------------
max element torch :      468
max element jit :        470
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00495049
Torch value at max error:404
Kernel value at max error:402

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=438 (dimensions: 16,16,96,438,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,438,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 438
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000803112
  gflops: 107.226
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->438];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1752
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->438
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92d94000
[DEBUG] GEMM shape: m=256 n=96 k=1752 lda=256 ldb=1752 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324979
  time (contract): 0.000477427
  gflops: 180.372
-----------------------------------
max element torch :      470
max element jit :        468
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00495049
Torch value at max error:404
Kernel value at max error:402

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=440 (dimensions: 16,16,96,440,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,440,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 440
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000803247
  gflops: 107.697
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->440];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1760
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->440
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d3ef000
[DEBUG] GEMM shape: m=256 n=96 k=1760 lda=256 ldb=1760 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000360689
  time (contract): 0.000497871
  gflops: 173.755
-----------------------------------
max element torch :      474
max element jit :        474
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00497512
Torch value at max error:402
Kernel value at max error:400

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=442 (dimensions: 16,16,96,442,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,442,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 442
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00081024
  gflops: 107.253
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->442];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1768
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->442
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3c0d000
[DEBUG] GEMM shape: m=256 n=96 k=1768 lda=256 ldb=1768 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000347505
  time (contract): 0.000486908
  gflops: 178.475
-----------------------------------
max element torch :      470
max element jit :        470
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00490196
Torch value at max error:406
Kernel value at max error:408

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=444 (dimensions: 16,16,96,444,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,444,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 444
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000808058
  gflops: 108.029
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->444];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1776
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->444
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e601000
[DEBUG] GEMM shape: m=256 n=96 k=1776 lda=256 ldb=1776 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343186
  time (contract): 0.000477961
  gflops: 182.638
-----------------------------------
max element torch :      474
max element jit :        474
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00492611
Torch value at max error:406
Kernel value at max error:404

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=446 (dimensions: 16,16,96,446,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,446,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 446
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000815023
  gflops: 107.589
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->446];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1784
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->446
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3264000
[DEBUG] GEMM shape: m=256 n=96 k=1784 lda=256 ldb=1784 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000346354
  time (contract): 0.000487464
  gflops: 179.884
-----------------------------------
max element torch :      474
max element jit :        476
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00487805
Torch value at max error:410
Kernel value at max error:408

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=448 (dimensions: 16,16,96,448,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,448,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 448
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00081944
  gflops: 107.489
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->448];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1792
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->448
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb75ae000
[DEBUG] GEMM shape: m=256 n=96 k=1792 lda=256 ldb=1792 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000366417
  time (contract): 0.000496066
  gflops: 177.558
-----------------------------------
max element torch :      484
max element jit :        484
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00485437
Torch value at max error:410
Kernel value at max error:412

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=450 (dimensions: 16,16,96,450,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,450,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 450
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000816464
  gflops: 108.362
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->450];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1800
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->450
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff824b9000
[DEBUG] GEMM shape: m=256 n=96 k=1800 lda=256 ldb=1800 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000381776
  time (contract): 0.000483056
  gflops: 183.154
-----------------------------------
max element torch :      484
max element jit :        486
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00478469
Torch value at max error:418
Kernel value at max error:416

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=452 (dimensions: 16,16,96,452,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,452,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 452
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000823671
  gflops: 107.891
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->452];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1808
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->452
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8f1b000
[DEBUG] GEMM shape: m=256 n=96 k=1808 lda=256 ldb=1808 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000311635
  time (contract): 0.000490585
  gflops: 181.144
-----------------------------------
max element torch :      486
max element jit :        486
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0047619
Torch value at max error:418
Kernel value at max error:420

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=454 (dimensions: 16,16,96,454,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,454,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 454
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00082413
  gflops: 108.308
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->454];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1816
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->454
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ee01000
[DEBUG] GEMM shape: m=256 n=96 k=1816 lda=256 ldb=1816 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000373488
  time (contract): 0.000475053
  gflops: 187.895
-----------------------------------
max element torch :      490
max element jit :        490
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00478469
Torch value at max error:416
Kernel value at max error:418

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=456 (dimensions: 16,16,96,456,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,456,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 456
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000828313
  gflops: 108.236
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->456];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1824
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->456
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9eab6000
[DEBUG] GEMM shape: m=256 n=96 k=1824 lda=256 ldb=1824 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000409744
  time (contract): 0.000491285
  gflops: 182.487
-----------------------------------
max element torch :      488
max element jit :        490
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0047619
Torch value at max error:420
Kernel value at max error:418

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=458 (dimensions: 16,16,96,458,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,458,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 458
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000827027
  gflops: 108.88
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->458];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1832
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->458
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf1e2000
[DEBUG] GEMM shape: m=256 n=96 k=1832 lda=256 ldb=1832 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000341714
  time (contract): 0.000476638
  gflops: 188.92
-----------------------------------
max element torch :      492
max element jit :        492
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00473934
Torch value at max error:422
Kernel value at max error:420

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=460 (dimensions: 16,16,96,460,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,460,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 460
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000841254
  gflops: 107.506
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->460];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1840
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->460
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab15e000
[DEBUG] GEMM shape: m=256 n=96 k=1840 lda=256 ldb=1840 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000370289
  time (contract): 0.000491804
  gflops: 183.894
-----------------------------------
max element torch :      490
max element jit :        490
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00473934
Torch value at max error:420
Kernel value at max error:422

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=462 (dimensions: 16,16,96,462,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,462,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 462
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000845789
  gflops: 107.394
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->462];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1848
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->462
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa94de000
[DEBUG] GEMM shape: m=256 n=96 k=1848 lda=256 ldb=1848 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328434
  time (contract): 0.000487688
  gflops: 186.252
-----------------------------------
max element torch :      498
max element jit :        496
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0046729
Torch value at max error:426
Kernel value at max error:428

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=464 (dimensions: 16,16,96,464,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,464,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 464
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000840216
  gflops: 108.575
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->464];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1856
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->464
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff83e86000
[DEBUG] GEMM shape: m=256 n=96 k=1856 lda=256 ldb=1856 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000341426
  time (contract): 0.000497095
  gflops: 183.518
-----------------------------------
max element torch :      498
max element jit :        498
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00462963
Torch value at max error:432
Kernel value at max error:430

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=466 (dimensions: 16,16,96,466,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,466,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 466
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000853867
  gflops: 107.299
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->466];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1864
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->466
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e305000
[DEBUG] GEMM shape: m=256 n=96 k=1864 lda=256 ldb=1864 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000359377
  time (contract): 0.000501013
  gflops: 182.868
-----------------------------------
max element torch :      500
max element jit :        498
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0046729
Torch value at max error:426
Kernel value at max error:428

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=468 (dimensions: 16,16,96,468,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,468,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 468
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000856687
  gflops: 107.405
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->468];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1872
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->468
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91545000
[DEBUG] GEMM shape: m=256 n=96 k=1872 lda=256 ldb=1872 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00039288
  time (contract): 0.000502212
  gflops: 183.214
-----------------------------------
max element torch :      496
max element jit :        496
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00462963
Torch value at max error:432
Kernel value at max error:430

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=470 (dimensions: 16,16,96,470,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,470,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 470
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000854855
  gflops: 108.095
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->470];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1880
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->470
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8bc79000
[DEBUG] GEMM shape: m=256 n=96 k=1880 lda=256 ldb=1880 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000361393
  time (contract): 0.000501883
  gflops: 184.118
-----------------------------------
max element torch :      510
max element jit :        510
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00460829
Torch value at max error:432
Kernel value at max error:434

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=472 (dimensions: 16,16,96,472,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,472,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 472
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000851102
  gflops: 109.034
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->472];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1888
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->472
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff833e9000
[DEBUG] GEMM shape: m=256 n=96 k=1888 lda=256 ldb=1888 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338738
  time (contract): 0.000514145
  gflops: 180.492
-----------------------------------
max element torch :      504
max element jit :        504
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00456621
Torch value at max error:438
Kernel value at max error:436

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=474 (dimensions: 16,16,96,474,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,474,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 474
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000856674
  gflops: 108.784
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->474];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1896
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->474
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffadd03000
[DEBUG] GEMM shape: m=256 n=96 k=1896 lda=256 ldb=1896 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000363313
  time (contract): 0.000500506
  gflops: 186.196
-----------------------------------
max element torch :      510
max element jit :        510
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00454545
Torch value at max error:440
Kernel value at max error:438

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=476 (dimensions: 16,16,96,476,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,476,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 476
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000878723
  gflops: 106.502
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->476];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1904
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->476
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff894ca000
[DEBUG] GEMM shape: m=256 n=96 k=1904 lda=256 ldb=1904 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000371185
  time (contract): 0.000517047
  gflops: 181
-----------------------------------
max element torch :      510
max element jit :        512
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00452489
Torch value at max error:440
Kernel value at max error:442

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=478 (dimensions: 16,16,96,478,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,478,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 478
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00086756
  gflops: 108.325
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->478];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1912
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->478
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8cdc3000
[DEBUG] GEMM shape: m=256 n=96 k=1912 lda=256 ldb=1912 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331442
  time (contract): 0.000509874
  gflops: 184.318
-----------------------------------
max element torch :      512
max element jit :        512
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0045045
Torch value at max error:444
Kernel value at max error:442

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=480 (dimensions: 16,16,96,480,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,480,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 480
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000872867
  gflops: 108.117
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->480];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1920
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->480
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7d27000
[DEBUG] GEMM shape: m=256 n=96 k=1920 lda=256 ldb=1920 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000404368
  time (contract): 0.000514327
  gflops: 183.486
-----------------------------------
max element torch :      516
max element jit :        516
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0045045
Torch value at max error:442
Kernel value at max error:444

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=482 (dimensions: 16,16,96,482,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,482,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 482
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000869199
  gflops: 109.026
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->482];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1928
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->482
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff882a4000
[DEBUG] GEMM shape: m=256 n=96 k=1928 lda=256 ldb=1928 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000330098
  time (contract): 0.000526498
  gflops: 179.991
-----------------------------------
max element torch :      516
max element jit :        516
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0045045
Torch value at max error:442
Kernel value at max error:444

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=484 (dimensions: 16,16,96,484,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,484,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 484
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000880068
  gflops: 108.126
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->484];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1936
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->484
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9c9b000
[DEBUG] GEMM shape: m=256 n=96 k=1936 lda=256 ldb=1936 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000373041
  time (contract): 0.000513167
  gflops: 185.433
-----------------------------------
max element torch :      524
max element jit :        520
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00763359
Torch value at max error:524
Kernel value at max error:520

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=486 (dimensions: 16,16,96,486,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,486,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 486
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000886286
  gflops: 107.811
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->486];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1944
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->486
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba8f5000
[DEBUG] GEMM shape: m=256 n=96 k=1944 lda=256 ldb=1944 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00040264
  time (contract): 0.000554121
  gflops: 172.438
-----------------------------------
max element torch :      520
max element jit :        520
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:516
Kernel value at max error:512

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=488 (dimensions: 16,16,96,488,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,488,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 488
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00087664
  gflops: 109.446
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->488];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1952
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->488
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7ac5000
[DEBUG] GEMM shape: m=256 n=96 k=1952 lda=256 ldb=1952 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000400208
  time (contract): 0.000535466
  gflops: 179.18
-----------------------------------
max element torch :      520
max element jit :        520
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:516
Kernel value at max error:512

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=490 (dimensions: 16,16,96,490,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,490,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 490
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000887003
  gflops: 108.611
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->490];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1960
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->490
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad8df000
[DEBUG] GEMM shape: m=256 n=96 k=1960 lda=256 ldb=1960 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329394
  time (contract): 0.000520786
  gflops: 184.986
-----------------------------------
max element torch :      520
max element jit :        520
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:516
Kernel value at max error:512

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=492 (dimensions: 16,16,96,492,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,492,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 492
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000891839
  gflops: 108.463
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->492];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1968
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->492
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c5ba000
[DEBUG] GEMM shape: m=256 n=96 k=1968 lda=256 ldb=1968 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000299348
  time (contract): 0.000513227
  gflops: 188.476
-----------------------------------
max element torch :      524
max element jit :        524
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:512
Kernel value at max error:516

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=494 (dimensions: 16,16,96,494,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,494,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 494
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000891873
  gflops: 108.899
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->494];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1976
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->494
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa6bb1000
[DEBUG] GEMM shape: m=256 n=96 k=1976 lda=256 ldb=1976 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000351922
  time (contract): 0.000528646
  gflops: 183.723
-----------------------------------
max element torch :      532
max element jit :        532
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:516
Kernel value at max error:512

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=496 (dimensions: 16,16,96,496,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,496,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 496
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000898785
  gflops: 108.499
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->496];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1984
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->496
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8bb81000
[DEBUG] GEMM shape: m=256 n=96 k=1984 lda=256 ldb=1984 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345938
  time (contract): 0.000574276
  gflops: 169.81
-----------------------------------
max element torch :      536
max element jit :        536
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:512
Kernel value at max error:516

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=498 (dimensions: 16,16,96,498,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,498,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 498
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000903506
  gflops: 108.368
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->498];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->1992
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->498
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c6e5000
[DEBUG] GEMM shape: m=256 n=96 k=1992 lda=256 ldb=1992 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000397551
  time (contract): 0.000517079
  gflops: 189.353
-----------------------------------
max element torch :      528
max element jit :        528
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:512
Kernel value at max error:516

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=500 (dimensions: 16,16,96,500,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,500,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 500
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000912109
  gflops: 107.777
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->500];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->2000
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->500
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5e5d000
[DEBUG] GEMM shape: m=256 n=96 k=2000 lda=256 ldb=2000 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000367441
  time (contract): 0.000545799
  gflops: 180.11
-----------------------------------
max element torch :      532
max element jit :        532
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:516
Kernel value at max error:512

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=502 (dimensions: 16,16,96,502,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,502,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 502
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000919161
  gflops: 107.377
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->502];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->2008
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->502
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa46f5000
[DEBUG] GEMM shape: m=256 n=96 k=2008 lda=256 ldb=2008 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000310547
  time (contract): 0.000534901
  gflops: 184.515
-----------------------------------
max element torch :      540
max element jit :        540
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:512
Kernel value at max error:516

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=504 (dimensions: 16,16,96,504,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,504,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 504
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000909117
  gflops: 108.996
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->504];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->2016
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->504
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaadc4000
[DEBUG] GEMM shape: m=256 n=96 k=2016 lda=256 ldb=2016 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312275
  time (contract): 0.000543763
  gflops: 182.231
-----------------------------------
max element torch :      560
max element jit :        556
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:512
Kernel value at max error:516

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=506 (dimensions: 16,16,96,506,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,506,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 506
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000923964
  gflops: 107.67
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->506];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->2024
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->506
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff810be000
[DEBUG] GEMM shape: m=256 n=96 k=2024 lda=256 ldb=2024 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000344434
  time (contract): 0.000545225
  gflops: 182.463
-----------------------------------
max element torch :      536
max element jit :        536
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:512
Kernel value at max error:516

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=508 (dimensions: 16,16,96,508,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,508,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 508
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000940562
  gflops: 106.189
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->508];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->2032
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->508
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbbac4000
[DEBUG] GEMM shape: m=256 n=96 k=2032 lda=256 ldb=2032 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000415119
  time (contract): 0.00057277
  gflops: 174.375
-----------------------------------
max element torch :      540
max element jit :        540
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:512
Kernel value at max error:516

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=510 (dimensions: 16,16,96,510,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,510,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 510
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000933161
  gflops: 107.452
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->510];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->2040
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->510
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaa931000
[DEBUG] GEMM shape: m=256 n=96 k=2040 lda=256 ldb=2040 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00039432
  time (contract): 0.0005728
  gflops: 175.052
-----------------------------------
max element torch :      544
max element jit :        544
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:512
Kernel value at max error:516

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=512 (dimensions: 16,16,96,512,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,512,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 512
  y: 4
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00108895
  gflops: 92.4408
einsum_ir:
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
1 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_mb[0] = 0
o_dim_ids_mb[1] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 3
o_dim_ids_kb[1] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         4
                         0
                         1
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->512];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             0,1
l_dim_ids_nb             2
l_dim_ids_kb             3,4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->16
1                        ->1
3                        ->1024
4                        ->256
l_strides_right          
2                        ->2048
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->512
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8a4bc000
[DEBUG] GEMM shape: m=256 n=96 k=2048 lda=256 ldb=2048 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332595
  time (contract): 0.000612905
  gflops: 164.24
-----------------------------------
max element torch :      556
max element jit :        556
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00809717
Torch value at max error:490
Kernel value at max error:494

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


