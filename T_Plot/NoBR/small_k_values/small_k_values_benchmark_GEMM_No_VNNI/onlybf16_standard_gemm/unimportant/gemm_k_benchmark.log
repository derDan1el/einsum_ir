=== GEMM k-Value Benchmark Log Started: Sat Jun 14 08:30:49 PM CEST 2025 ===
Testing einsum: km,nk->nm with M=256, N=256, varying K from 2 to 512

=== Testing k=2 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "2,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 2
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 6.22179e-05
  gflops: 4.21332
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->2];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->2
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->2
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8475b000
[DEBUG] GEMM shape: m=256 n=256 k=2 lda=256 ldb=2 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000420623
  time (contract): 1.35007e-05
  gflops: 19.417
-----------------------------------
max element torch :      1.84375
max element jit :        1.84375
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "2,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 2
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 2.91218e-05
  gflops: 9.00165
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->2];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->2
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->2
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbde87000
[DEBUG] GEMM shape: m=256 n=256 k=2 lda=256 ldb=2 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306835
  time (contract): 1.65572e-05
  gflops: 15.8327

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "2,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 2
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 3.59554e-05
  gflops: 7.29082
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->2];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->2
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->2
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82a6b000
[DEBUG] GEMM shape: m=256 n=256 k=2 lda=256 ldb=2 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325651
  time (contract): 3.35853e-05
  gflops: 7.80531

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=4 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "4,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 4
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 6.18895e-05
  gflops: 8.47135
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->4];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->4
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9843a000
[DEBUG] GEMM shape: m=256 n=256 k=4 lda=256 ldb=4 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000352498
  time (contract): 1.67386e-05
  gflops: 31.3221
-----------------------------------
max element torch :      3
max element jit :        3
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "4,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 4
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 2.85686e-05
  gflops: 18.3519
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->4];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->4
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab55f000
[DEBUG] GEMM shape: m=256 n=256 k=4 lda=256 ldb=4 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000274933
  time (contract): 1.77099e-05
  gflops: 29.6042

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "4,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 4
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000184463
  gflops: 2.84225
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->4];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->4
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb6a0b000
[DEBUG] GEMM shape: m=256 n=256 k=4 lda=256 ldb=4 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00030018
  time (contract): 3.48965e-05
  gflops: 15.0241

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=6 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "6,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 6
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 6.39473e-05
  gflops: 12.2981
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->6];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->6
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa03bd000
[DEBUG] GEMM shape: m=256 n=256 k=6 lda=256 ldb=6 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335763
  time (contract): 1.74588e-05
  gflops: 45.0451
-----------------------------------
max element torch :      3.6875
max element jit :        3.6875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "6,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 6
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 9.90814e-05
  gflops: 7.93723
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->6];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->6
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9743d000
[DEBUG] GEMM shape: m=256 n=256 k=6 lda=256 ldb=6 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000273237
  time (contract): 2.3684e-05
  gflops: 33.2052

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "6,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 6
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 4.36391e-05
  gflops: 18.0213
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->6];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->6
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9e79000
[DEBUG] GEMM shape: m=256 n=256 k=6 lda=256 ldb=6 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000299636
  time (contract): 4.70424e-05
  gflops: 16.7175

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=8 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "8,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 8
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 6.27216e-05
  gflops: 16.7179
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->8];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->8
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->8
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaab93000
[DEBUG] GEMM shape: m=256 n=256 k=8 lda=256 ldb=8 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000372465
  time (contract): 1.87365e-05
  gflops: 55.9645
-----------------------------------
max element torch :      5.03125
max element jit :        5.03125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "8,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 8
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 9.61066e-05
  gflops: 10.9106
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->8];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->8
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->8
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff93d9c000
[DEBUG] GEMM shape: m=256 n=256 k=8 lda=256 ldb=8 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00024511
  time (contract): 2.65457e-05
  gflops: 39.5007

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "8,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 8
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000165346
  gflops: 6.34172
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->8];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->8
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->8
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff956f7000
[DEBUG] GEMM shape: m=256 n=256 k=8 lda=256 ldb=8 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332594
  time (contract): 5.31391e-05
  gflops: 19.7327

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=10 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "10,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 10
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 7.46024e-05
  gflops: 17.5694
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->10];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->10
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->10
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba440000
[DEBUG] GEMM shape: m=256 n=256 k=10 lda=256 ldb=10 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000321907
  time (contract): 2.1256e-05
  gflops: 61.6634
-----------------------------------
max element torch :      5.875
max element jit :        5.875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "10,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 10
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 8.47653e-05
  gflops: 15.4629
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->10];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->10
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->10
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaccdf000
[DEBUG] GEMM shape: m=256 n=256 k=10 lda=256 ldb=10 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00028946
  time (contract): 3.00225e-05
  gflops: 43.658

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "10,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 10
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 5.37652e-05
  gflops: 24.3786
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->10];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->10
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->10
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e070000
[DEBUG] GEMM shape: m=256 n=256 k=10 lda=256 ldb=10 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000360817
  time (contract): 5.94394e-05
  gflops: 22.0514

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=12 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "12,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 12
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 7.09783e-05
  gflops: 22.1598
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->12];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->12
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->12
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97cac000
[DEBUG] GEMM shape: m=256 n=256 k=12 lda=256 ldb=12 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000364561
  time (contract): 2.06959e-05
  gflops: 75.9988
-----------------------------------
max element torch :      6.15625
max element jit :        6.15625
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "12,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 12
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 8.63899e-05
  gflops: 18.2066
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->12];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->12
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->12
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92957000
[DEBUG] GEMM shape: m=256 n=256 k=12 lda=256 ldb=12 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000260277
  time (contract): 3.29062e-05
  gflops: 47.7984

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "12,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 12
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 6.32227e-05
  gflops: 24.8781
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->12];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->12
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->12
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ffd3000
[DEBUG] GEMM shape: m=256 n=256 k=12 lda=256 ldb=12 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000321171
  time (contract): 6.50903e-05
  gflops: 24.1643

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=14 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "14,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 14
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 7.78371e-05
  gflops: 23.575
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->14];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->14
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->14
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9206e000
[DEBUG] GEMM shape: m=256 n=256 k=14 lda=256 ldb=14 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000283093
  time (contract): 2.5042e-05
  gflops: 73.2771
-----------------------------------
max element torch :      6.96875
max element jit :        6.96875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "14,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 14
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 8.85296e-05
  gflops: 20.7276
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->14];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->14
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->14
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8578b000
[DEBUG] GEMM shape: m=256 n=256 k=14 lda=256 ldb=14 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000265429
  time (contract): 3.58512e-05
  gflops: 51.184

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "14,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 14
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 6.77772e-05
  gflops: 27.0741
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->14];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->14
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->14
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa58e7000
[DEBUG] GEMM shape: m=256 n=256 k=14 lda=256 ldb=14 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000295092
  time (contract): 7.12248e-05
  gflops: 25.7636

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=16 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "16,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 16
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 7.61192e-05
  gflops: 27.5509
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->16];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->16
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e125000
[DEBUG] GEMM shape: m=256 n=256 k=16 lda=256 ldb=16 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000330099
  time (contract): 2.27886e-05
  gflops: 92.0264
-----------------------------------
max element torch :      7.8125
max element jit :        7.8125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "16,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 16
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 8.98673e-05
  gflops: 23.3361
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->16];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->16
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86ddd000
[DEBUG] GEMM shape: m=256 n=256 k=16 lda=256 ldb=16 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.0002949
  time (contract): 3.89307e-05
  gflops: 53.8689

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "16,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 16
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 7.35886e-05
  gflops: 28.4983
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->16];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->16
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8edbd000
[DEBUG] GEMM shape: m=256 n=256 k=16 lda=256 ldb=16 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338066
  time (contract): 7.70419e-05
  gflops: 27.2209

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=18 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "18,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 18
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 8.3573e-05
  gflops: 28.2304
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->18];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->18
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->18
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8cb2b000
[DEBUG] GEMM shape: m=256 n=256 k=18 lda=256 ldb=18 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000304883
  time (contract): 2.89976e-05
  gflops: 81.3618
-----------------------------------
max element torch :      9.6875
max element jit :        9.6875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "18,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 18
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 9.23178e-05
  gflops: 25.5563
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->18];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->18
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->18
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf3c9000
[DEBUG] GEMM shape: m=256 n=256 k=18 lda=256 ldb=18 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305299
  time (contract): 4.19636e-05
  gflops: 56.2224

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "18,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 18
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 7.84415e-05
  gflops: 30.0771
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->18];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->18
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->18
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9cb51000
[DEBUG] GEMM shape: m=256 n=256 k=18 lda=256 ldb=18 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000362865
  time (contract): 8.33096e-05
  gflops: 28.3196

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=20 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "20,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 20
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 7.71598e-05
  gflops: 33.9742
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->20];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->20
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->20
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb442a000
[DEBUG] GEMM shape: m=256 n=256 k=20 lda=256 ldb=20 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000291348
  time (contract): 2.50268e-05
  gflops: 104.745
-----------------------------------
max element torch :      10.0625
max element jit :        10.0625
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "20,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 20
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 9.76982e-05
  gflops: 26.832
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->20];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->20
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->20
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff98682000
[DEBUG] GEMM shape: m=256 n=256 k=20 lda=256 ldb=20 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306099
  time (contract): 4.4711e-05
  gflops: 58.6307

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "20,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 20
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 8.3916e-05
  gflops: 31.2388
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->20];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->20
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->20
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff997ab000
[DEBUG] GEMM shape: m=256 n=256 k=20 lda=256 ldb=20 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000381232
  time (contract): 8.91974e-05
  gflops: 29.3892

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=22 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "22,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 22
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 8.18563e-05
  gflops: 35.2274
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->22];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->22
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->22
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff950c6000
[DEBUG] GEMM shape: m=256 n=256 k=22 lda=256 ldb=22 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000330419
  time (contract): 3.26409e-05
  gflops: 88.3427
-----------------------------------
max element torch :      10.3125
max element jit :        10.3125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "22,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 22
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00013521
  gflops: 21.3267
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->22];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->22
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->22
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8297000
[DEBUG] GEMM shape: m=256 n=256 k=22 lda=256 ldb=22 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000287764
  time (contract): 4.7728e-05
  gflops: 60.417

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "22,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 22
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 8.98093e-05
  gflops: 32.1079
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->22];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->22
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->22
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9cb54000
[DEBUG] GEMM shape: m=256 n=256 k=22 lda=256 ldb=22 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000342962
  time (contract): 9.56911e-05
  gflops: 30.1343

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=24 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "24,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 24
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 8.04506e-05
  gflops: 39.1013
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->24];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->24
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3d3c000
[DEBUG] GEMM shape: m=256 n=256 k=24 lda=256 ldb=24 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000373809
  time (contract): 2.73187e-05
  gflops: 115.149
-----------------------------------
max element torch :      10.75
max element jit :        10.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "24,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 24
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000132811
  gflops: 23.6858
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->24];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->24
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9315f000
[DEBUG] GEMM shape: m=256 n=256 k=24 lda=256 ldb=24 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000297588
  time (contract): 5.05983e-05
  gflops: 62.1706

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "24,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 24
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 9.51218e-05
  gflops: 33.0705
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->24];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->24
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3aa0000
[DEBUG] GEMM shape: m=256 n=256 k=24 lda=256 ldb=24 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343953
  time (contract): 0.000102349
  gflops: 30.7352

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=26 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "26,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 26
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 8.86231e-05
  gflops: 38.4535
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->26];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->26
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->26
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80722000
[DEBUG] GEMM shape: m=256 n=256 k=26 lda=256 ldb=26 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345362
  time (contract): 3.64127e-05
  gflops: 93.5901
-----------------------------------
max element torch :      10.875
max element jit :        10.875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "26,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 26
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000109263
  gflops: 31.1896
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->26];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->26
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->26
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff888bd000
[DEBUG] GEMM shape: m=256 n=256 k=26 lda=256 ldb=26 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000311027
  time (contract): 5.3412e-05
  gflops: 63.8035

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "26,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 26
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000101756
  gflops: 33.4906
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->26];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->26
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->26
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0a83000
[DEBUG] GEMM shape: m=256 n=256 k=26 lda=256 ldb=26 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000359666
  time (contract): 0.000106527
  gflops: 31.9906

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=28 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "28,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 28
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 8.18459e-05
  gflops: 44.8406
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->28];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->28
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->28
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb94cf000
[DEBUG] GEMM shape: m=256 n=256 k=28 lda=256 ldb=28 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000350738
  time (contract): 2.91907e-05
  gflops: 125.726
-----------------------------------
max element torch :      12.0625
max element jit :        12.0625
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "28,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 28
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000134958
  gflops: 27.1937
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->28];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->28
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->28
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80e26000
[DEBUG] GEMM shape: m=256 n=256 k=28 lda=256 ldb=28 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000298995
  time (contract): 5.64335e-05
  gflops: 65.0326

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "28,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 28
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000106116
  gflops: 34.585
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->28];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->28
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->28
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8e5f000
[DEBUG] GEMM shape: m=256 n=256 k=28 lda=256 ldb=28 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034101
  time (contract): 0.000112972
  gflops: 32.4861

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=30 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "30,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 30
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 9.36528e-05
  gflops: 41.9866
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->30];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->30
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->30
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff98297000
[DEBUG] GEMM shape: m=256 n=256 k=30 lda=256 ldb=30 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00032757
  time (contract): 4.01319e-05
  gflops: 97.9809
-----------------------------------
max element torch :      12.3125
max element jit :        12.3125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "30,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 30
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000135945
  gflops: 28.9246
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->30];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->30
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->30
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5c58000
[DEBUG] GEMM shape: m=256 n=256 k=30 lda=256 ldb=30 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000294036
  time (contract): 5.93076e-05
  gflops: 66.3011

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "30,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 30
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000113722
  gflops: 34.577
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->30];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->30
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->30
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff93acb000
[DEBUG] GEMM shape: m=256 n=256 k=30 lda=256 ldb=30 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000339378
  time (contract): 0.000120136
  gflops: 32.7308

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=32 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "32,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 32
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 8.60036e-05
  gflops: 48.7689
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->32];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->32
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->32
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94c86000
[DEBUG] GEMM shape: m=256 n=256 k=32 lda=256 ldb=32 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000339122
  time (contract): 3.11385e-05
  gflops: 134.698
-----------------------------------
max element torch :      12.6875
max element jit :        12.6875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "32,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 32
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000146689
  gflops: 28.5932
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->32];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->32
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->32
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa6dd7000
[DEBUG] GEMM shape: m=256 n=256 k=32 lda=256 ldb=32 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000262101
  time (contract): 6.20364e-05
  gflops: 67.6104

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "32,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 32
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000118342
  gflops: 35.4422
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->32];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->32
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->32
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff85918000
[DEBUG] GEMM shape: m=256 n=256 k=32 lda=256 ldb=32 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325139
  time (contract): 0.000125327
  gflops: 33.467

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=34 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "34,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 34
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000101337
  gflops: 43.9766
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->34];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->34
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->34
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9fd92000
[DEBUG] GEMM shape: m=256 n=256 k=34 lda=256 ldb=34 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000283796
  time (contract): 4.35804e-05
  gflops: 102.258
-----------------------------------
max element torch :      13.875
max element jit :        13.875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "34,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 34
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000150194
  gflops: 29.6712
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->34];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->34
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->34
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90e8c000
[DEBUG] GEMM shape: m=256 n=256 k=34 lda=256 ldb=34 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327602
  time (contract): 6.4952e-05
  gflops: 68.6114

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "34,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 34
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000123791
  gflops: 35.9998
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->34];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->34
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->34
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88e7f000
[DEBUG] GEMM shape: m=256 n=256 k=34 lda=256 ldb=34 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000336819
  time (contract): 0.000130827
  gflops: 34.0635

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=36 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "36,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 36
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 8.67661e-05
  gflops: 54.3829
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->36];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->36
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->36
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbbb65000
[DEBUG] GEMM shape: m=256 n=256 k=36 lda=256 ldb=36 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035365
  time (contract): 3.31574e-05
  gflops: 142.309
-----------------------------------
max element torch :      15.5
max element jit :        15.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "36,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 36
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00015217
  gflops: 31.0086
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->36];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->36
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->36
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99485000
[DEBUG] GEMM shape: m=256 n=256 k=36 lda=256 ldb=36 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000281268
  time (contract): 6.76952e-05
  gflops: 69.7035

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "36,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 36
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000129639
  gflops: 36.398
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->36];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->36
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->36
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9684c000
[DEBUG] GEMM shape: m=256 n=256 k=36 lda=256 ldb=36 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000390096
  time (contract): 0.000137504
  gflops: 34.3161

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=38 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "38,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 38
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 9.53656e-05
  gflops: 52.2278
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->38];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->38
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->38
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff964da000
[DEBUG] GEMM shape: m=256 n=256 k=38 lda=256 ldb=38 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325587
  time (contract): 4.74644e-05
  gflops: 104.936
-----------------------------------
max element torch :      15.5
max element jit :        15.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "38,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 38
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000163815
  gflops: 30.4047
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->38];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->38
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->38
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91ead000
[DEBUG] GEMM shape: m=256 n=256 k=38 lda=256 ldb=38 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000300948
  time (contract): 7.09198e-05
  gflops: 70.2306

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "38,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 38
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000136328
  gflops: 36.5349
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->38];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->38
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->38
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad503000
[DEBUG] GEMM shape: m=256 n=256 k=38 lda=256 ldb=38 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354098
  time (contract): 0.000144713
  gflops: 34.4181

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=40 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "40,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 40
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 9.09865e-05
  gflops: 57.6226
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->40];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->40
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->40
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d4a0000
[DEBUG] GEMM shape: m=256 n=256 k=40 lda=256 ldb=40 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000385745
  time (contract): 3.51985e-05
  gflops: 148.952
-----------------------------------
max element torch :      15.375
max element jit :        15.375
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "40,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 40
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000140182
  gflops: 37.4006
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->40];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->40
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->40
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff933e0000
[DEBUG] GEMM shape: m=256 n=256 k=40 lda=256 ldb=40 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000282964
  time (contract): 7.41393e-05
  gflops: 70.7166

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "40,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 40
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000140796
  gflops: 37.2375
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->40];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->40
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->40
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87bdc000
[DEBUG] GEMM shape: m=256 n=256 k=40 lda=256 ldb=40 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000349874
  time (contract): 0.00015053
  gflops: 34.8295

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=42 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "42,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 42
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000119122
  gflops: 46.2135
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->42];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->42
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->42
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb734f000
[DEBUG] GEMM shape: m=256 n=256 k=42 lda=256 ldb=42 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00030674
  time (contract): 5.11826e-05
  gflops: 107.556
-----------------------------------
max element torch :      16.5
max element jit :        16.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "42,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 42
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000162765
  gflops: 33.8219
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->42];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->42
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->42
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff951f6000
[DEBUG] GEMM shape: m=256 n=256 k=42 lda=256 ldb=42 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00028274
  time (contract): 7.66229e-05
  gflops: 71.8457

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "42,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 42
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00014653
  gflops: 37.5692
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->42];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->42
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->42
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8b13000
[DEBUG] GEMM shape: m=256 n=256 k=42 lda=256 ldb=42 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033781
  time (contract): 0.000156328
  gflops: 35.2146

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=44 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "44,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 44
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 9.7772e-05
  gflops: 58.9859
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->44];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->44
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->44
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8753c000
[DEBUG] GEMM shape: m=256 n=256 k=44 lda=256 ldb=44 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000346706
  time (contract): 3.69796e-05
  gflops: 155.955
-----------------------------------
max element torch :      18
max element jit :        18
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "44,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 44
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000135507
  gflops: 42.5599
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->44];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->44
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->44
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88696000
[DEBUG] GEMM shape: m=256 n=256 k=44 lda=256 ldb=44 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000317907
  time (contract): 7.95548e-05
  gflops: 72.493

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "44,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 44
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000152562
  gflops: 37.8022
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->44];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->44
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->44
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffac715000
[DEBUG] GEMM shape: m=256 n=256 k=44 lda=256 ldb=44 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000378865
  time (contract): 0.000161854
  gflops: 35.6319

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=46 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "46,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 46
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000126641
  gflops: 47.6093
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->46];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->46
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->46
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa213e000
[DEBUG] GEMM shape: m=256 n=256 k=46 lda=256 ldb=46 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325043
  time (contract): 5.49784e-05
  gflops: 109.667
-----------------------------------
max element torch :      18.375
max element jit :        18.375
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "46,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 46
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000166821
  gflops: 36.1424
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->46];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->46
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->46
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96f92000
[DEBUG] GEMM shape: m=256 n=256 k=46 lda=256 ldb=46 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000273173
  time (contract): 8.27684e-05
  gflops: 72.8456

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "46,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 46
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000158176
  gflops: 38.1178
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->46];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->46
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->46
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0314000
[DEBUG] GEMM shape: m=256 n=256 k=46 lda=256 ldb=46 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000367473
  time (contract): 0.000168522
  gflops: 35.7775

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=48 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "48,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 48
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000113987
  gflops: 55.1947
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->48];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->48
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->48
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84790000
[DEBUG] GEMM shape: m=256 n=256 k=48 lda=256 ldb=48 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333331
  time (contract): 3.89945e-05
  gflops: 161.342
-----------------------------------
max element torch :      18.125
max element jit :        18.125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "48,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 48
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000174324
  gflops: 36.0906
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->48];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->48
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->48
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2f6e000
[DEBUG] GEMM shape: m=256 n=256 k=48 lda=256 ldb=48 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000274517
  time (contract): 8.55443e-05
  gflops: 73.5462

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "48,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 48
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000164147
  gflops: 38.3282
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->48];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->48
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->48
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90ae8000
[DEBUG] GEMM shape: m=256 n=256 k=48 lda=256 ldb=48 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326611
  time (contract): 0.00017633
  gflops: 35.6801

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=50 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "50,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 50
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000112369
  gflops: 58.3222
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->50];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->50
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->50
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8ba6000
[DEBUG] GEMM shape: m=256 n=256 k=50 lda=256 ldb=50 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000344946
  time (contract): 5.84792e-05
  gflops: 112.067
-----------------------------------
max element torch :      19.25
max element jit :        19.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "50,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 50
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000183217
  gflops: 35.7696
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->50];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->50
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->50
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b1c5000
[DEBUG] GEMM shape: m=256 n=256 k=50 lda=256 ldb=50 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00028594
  time (contract): 8.88772e-05
  gflops: 73.7377

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "50,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 50
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000170282
  gflops: 38.4867
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->50];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->50
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->50
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbbd84000
[DEBUG] GEMM shape: m=256 n=256 k=50 lda=256 ldb=50 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000311795
  time (contract): 0.000181142
  gflops: 36.1793

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=52 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "52,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 52
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000102386
  gflops: 66.5692
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->52];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->52
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->52
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d517000
[DEBUG] GEMM shape: m=256 n=256 k=52 lda=256 ldb=52 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000352721
  time (contract): 4.12595e-05
  gflops: 165.192
-----------------------------------
max element torch :      20.375
max element jit :        20.375
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "52,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 52
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000181667
  gflops: 37.5179
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->52];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->52
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->52
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa72bb000
[DEBUG] GEMM shape: m=256 n=256 k=52 lda=256 ldb=52 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000290324
  time (contract): 9.12561e-05
  gflops: 74.6881

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "52,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 52
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000175969
  gflops: 38.7326
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->52];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->52
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->52
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad0a8000
[DEBUG] GEMM shape: m=256 n=256 k=52 lda=256 ldb=52 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000330483
  time (contract): 0.000185334
  gflops: 36.7754

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=54 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "54,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 54
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000109115
  gflops: 64.8663
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->54];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->54
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->54
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffac529000
[DEBUG] GEMM shape: m=256 n=256 k=54 lda=256 ldb=54 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000342034
  time (contract): 6.21186e-05
  gflops: 113.941
-----------------------------------
max element torch :      19.875
max element jit :        19.875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "54,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 54
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.0001771
  gflops: 39.9655
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->54];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->54
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->54
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5db5000
[DEBUG] GEMM shape: m=256 n=256 k=54 lda=256 ldb=54 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000259029
  time (contract): 9.34036e-05
  gflops: 75.7775

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "54,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 54
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000181067
  gflops: 39.0899
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->54];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->54
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->54
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb448e000
[DEBUG] GEMM shape: m=256 n=256 k=54 lda=256 ldb=54 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000339922
  time (contract): 0.000192449
  gflops: 36.778

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=56 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "56,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 56
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000126036
  gflops: 58.2378
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->56];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->56
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->56
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff867de000
[DEBUG] GEMM shape: m=256 n=256 k=56 lda=256 ldb=56 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000304051
  time (contract): 4.30664e-05
  gflops: 170.435
-----------------------------------
max element torch :      22.375
max element jit :        22.375
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "56,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 56
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000183101
  gflops: 40.0874
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->56];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->56
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->56
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa01d7000
[DEBUG] GEMM shape: m=256 n=256 k=56 lda=256 ldb=56 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000276373
  time (contract): 9.72573e-05
  gflops: 75.4702

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "56,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 56
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000185841
  gflops: 39.4963
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->56];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->56
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->56
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab385000
[DEBUG] GEMM shape: m=256 n=256 k=56 lda=256 ldb=56 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000385776
  time (contract): 0.000197126
  gflops: 37.2352

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=58 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "58,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 58
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000113966
  gflops: 66.7056
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->58];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->58
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->58
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ee6d000
[DEBUG] GEMM shape: m=256 n=256 k=58 lda=256 ldb=58 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000340595
  time (contract): 6.59423e-05
  gflops: 115.285
-----------------------------------
max element torch :      22.25
max element jit :        22.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "58,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 58
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.0001891
  gflops: 40.2018
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->58];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->58
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->58
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd5fb000
[DEBUG] GEMM shape: m=256 n=256 k=58 lda=256 ldb=58 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000224407
  time (contract): 9.97036e-05
  gflops: 76.2477

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "58,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 58
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000191425
  gflops: 39.7135
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->58];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->58
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->58
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7fe0000
[DEBUG] GEMM shape: m=256 n=256 k=58 lda=256 ldb=58 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000334003
  time (contract): 0.000203817
  gflops: 37.2991

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=60 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "60,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 60
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00011202
  gflops: 70.2049
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->60];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->60
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->60
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8a51a000
[DEBUG] GEMM shape: m=256 n=256 k=60 lda=256 ldb=60 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000310355
  time (contract): 4.48211e-05
  gflops: 175.46
-----------------------------------
max element torch :      21.875
max element jit :        21.875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "60,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 60
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.0001933
  gflops: 40.6845
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->60];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->60
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->60
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8fdb7000
[DEBUG] GEMM shape: m=256 n=256 k=60 lda=256 ldb=60 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000310547
  time (contract): 0.000102447
  gflops: 76.765

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "60,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 60
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000198199
  gflops: 39.6788
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->60];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->60
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->60
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb61df000
[DEBUG] GEMM shape: m=256 n=256 k=60 lda=256 ldb=60 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326578
  time (contract): 0.000210525
  gflops: 37.3557

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=62 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "62,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 62
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000123287
  gflops: 65.915
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->62];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->62
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->62
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80031000
[DEBUG] GEMM shape: m=256 n=256 k=62 lda=256 ldb=62 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029874
  time (contract): 6.93182e-05
  gflops: 117.234
-----------------------------------
max element torch :      23
max element jit :        23
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "62,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 62
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000197477
  gflops: 41.1514
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->62];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->62
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->62
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa2ef1000
[DEBUG] GEMM shape: m=256 n=256 k=62 lda=256 ldb=62 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000293972
  time (contract): 0.000106488
  gflops: 76.3135

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "62,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 62
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000202548
  gflops: 40.1212
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->62];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->62
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->62
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa33e5000
[DEBUG] GEMM shape: m=256 n=256 k=62 lda=256 ldb=62 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000379921
  time (contract): 0.000213283
  gflops: 38.1019

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=64 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "64,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 64
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000112096
  gflops: 74.8343
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->64];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->64
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->64
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaefcd000
[DEBUG] GEMM shape: m=256 n=256 k=64 lda=256 ldb=64 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000287444
  time (contract): 4.73002e-05
  gflops: 177.348
-----------------------------------
max element torch :      23.125
max element jit :        23.125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "64,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 64
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000191518
  gflops: 43.8005
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->64];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->64
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->64
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff95edd000
[DEBUG] GEMM shape: m=256 n=256 k=64 lda=256 ldb=64 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000280116
  time (contract): 0.000108746
  gflops: 77.1392

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "64,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 64
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000209252
  gflops: 40.0886
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->64];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->64
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->64
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94e27000
[DEBUG] GEMM shape: m=256 n=256 k=64 lda=256 ldb=64 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000363793
  time (contract): 0.00022776
  gflops: 36.831

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=66 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "66,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 66
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000121025
  gflops: 71.4791
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->66];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->66
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->66
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff93f83000
[DEBUG] GEMM shape: m=256 n=256 k=66 lda=256 ldb=66 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000308692
  time (contract): 7.32909e-05
  gflops: 118.033
-----------------------------------
max element torch :      25.25
max element jit :        25.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "66,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 66
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000194095
  gflops: 44.5697
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->66];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->66
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->66
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9cb60000
[DEBUG] GEMM shape: m=256 n=256 k=66 lda=256 ldb=66 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000286389
  time (contract): 0.00011125
  gflops: 77.7594

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "66,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 66
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000217481
  gflops: 39.7771
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->66];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->66
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->66
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9c9b000
[DEBUG] GEMM shape: m=256 n=256 k=66 lda=256 ldb=66 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000355217
  time (contract): 0.000229129
  gflops: 37.7549

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=68 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "68,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 68
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000112222
  gflops: 79.4218
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->68];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->68
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->68
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff997df000
[DEBUG] GEMM shape: m=256 n=256 k=68 lda=256 ldb=68 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000315475
  time (contract): 4.89129e-05
  gflops: 182.22
-----------------------------------
max element torch :      24.875
max element jit :        24.875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "68,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 68
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000211382
  gflops: 42.1648
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->68];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->68
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->68
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc6aa000
[DEBUG] GEMM shape: m=256 n=256 k=68 lda=256 ldb=68 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000289044
  time (contract): 0.000114158
  gflops: 78.0752

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "68,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 68
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000222764
  gflops: 40.0105
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->68];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->68
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->68
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e4b2000
[DEBUG] GEMM shape: m=256 n=256 k=68 lda=256 ldb=68 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000330546
  time (contract): 0.000236858
  gflops: 37.6297

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=70 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "70,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 70
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000122658
  gflops: 74.8015
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->70];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->70
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->70
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8fb71000
[DEBUG] GEMM shape: m=256 n=256 k=70 lda=256 ldb=70 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000291828
  time (contract): 7.73357e-05
  gflops: 118.639
-----------------------------------
max element torch :      24.625
max element jit :        24.625
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "70,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 70
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000202035
  gflops: 45.4132
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->70];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->70
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->70
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbbbc9000
[DEBUG] GEMM shape: m=256 n=256 k=70 lda=256 ldb=70 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000275381
  time (contract): 0.00011753
  gflops: 78.0653

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "70,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 70
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000225833
  gflops: 40.6276
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->70];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->70
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->70
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b3cc000
[DEBUG] GEMM shape: m=256 n=256 k=70 lda=256 ldb=70 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034421
  time (contract): 0.000255006
  gflops: 35.9797

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=72 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "72,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 72
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000118936
  gflops: 79.3468
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->72];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->72
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->72
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f8ba000
[DEBUG] GEMM shape: m=256 n=256 k=72 lda=256 ldb=72 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335538
  time (contract): 5.12326e-05
  gflops: 184.203
-----------------------------------
max element torch :      26
max element jit :        26
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "72,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 72
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000208313
  gflops: 45.303
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->72];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->72
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->72
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa84b7000
[DEBUG] GEMM shape: m=256 n=256 k=72 lda=256 ldb=72 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000264693
  time (contract): 0.00012027
  gflops: 78.4665

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "72,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 72
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000235427
  gflops: 40.0854
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->72];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->72
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->72
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ad18000
[DEBUG] GEMM shape: m=256 n=256 k=72 lda=256 ldb=72 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00038648
  time (contract): 0.000247699
  gflops: 38.0993

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=74 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "74,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 74
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000127304
  gflops: 76.19
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->74];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->74
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->74
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8dbc7000
[DEBUG] GEMM shape: m=256 n=256 k=74 lda=256 ldb=74 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000318259
  time (contract): 8.07274e-05
  gflops: 120.149
-----------------------------------
max element torch :      27.375
max element jit :        27.375
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "74,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 74
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000208482
  gflops: 46.5236
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->74];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->74
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->74
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8758f000
[DEBUG] GEMM shape: m=256 n=256 k=74 lda=256 ldb=74 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000267637
  time (contract): 0.000123278
  gflops: 78.6786

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "74,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 74
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000237702
  gflops: 40.8046
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->74];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->74
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->74
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87a97000
[DEBUG] GEMM shape: m=256 n=256 k=74 lda=256 ldb=74 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000360913
  time (contract): 0.000252146
  gflops: 38.4671

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=76 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "76,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 76
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000120531
  gflops: 82.6463
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->76];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->76
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->76
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa6696000
[DEBUG] GEMM shape: m=256 n=256 k=76 lda=256 ldb=76 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000355698
  time (contract): 5.29733e-05
  gflops: 188.047
-----------------------------------
max element torch :      29.125
max element jit :        29.125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "76,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 76
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00022008
  gflops: 45.2629
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->76];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->76
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->76
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a5f4000
[DEBUG] GEMM shape: m=256 n=256 k=76 lda=256 ldb=76 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000278676
  time (contract): 0.000125654
  gflops: 79.2767

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "76,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 76
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00024299
  gflops: 40.9954
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->76];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->76
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->76
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaafb1000
[DEBUG] GEMM shape: m=256 n=256 k=76 lda=256 ldb=76 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000352178
  time (contract): 0.000258567
  gflops: 38.5257

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=78 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "78,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 78
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000128398
  gflops: 79.6244
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->78];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->78
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->78
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9854f000
[DEBUG] GEMM shape: m=256 n=256 k=78 lda=256 ldb=78 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000346738
  time (contract): 8.44307e-05
  gflops: 121.089
-----------------------------------
max element torch :      28.625
max element jit :        28.625
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "78,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 78
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000219236
  gflops: 46.6329
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->78];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->78
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->78
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9835000
[DEBUG] GEMM shape: m=256 n=256 k=78 lda=256 ldb=78 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000282004
  time (contract): 0.000129113
  gflops: 79.1835

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "78,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 78
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000248687
  gflops: 41.1104
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->78];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->78
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->78
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaaec2000
[DEBUG] GEMM shape: m=256 n=256 k=78 lda=256 ldb=78 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000355122
  time (contract): 0.000264509
  gflops: 38.6513

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=80 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "80,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 80
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000119817
  gflops: 87.515
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->80];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->80
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->80
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86d18000
[DEBUG] GEMM shape: m=256 n=256 k=80 lda=256 ldb=80 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348369
  time (contract): 5.51059e-05
  gflops: 190.284
-----------------------------------
max element torch :      29
max element jit :        29
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "80,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 80
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000226035
  gflops: 46.3899
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->80];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->80
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->80
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8decf000
[DEBUG] GEMM shape: m=256 n=256 k=80 lda=256 ldb=80 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312563
  time (contract): 0.000132717
  gflops: 79.0082

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "80,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 80
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000256204
  gflops: 40.9274
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->80];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->80
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->80
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4f7b000
[DEBUG] GEMM shape: m=256 n=256 k=80 lda=256 ldb=80 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000314227
  time (contract): 0.000279338
  gflops: 37.5379

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=82 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "82,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 82
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000130488
  gflops: 82.3672
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->82];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->82
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->82
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffadb96000
[DEBUG] GEMM shape: m=256 n=256 k=82 lda=256 ldb=82 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000319891
  time (contract): 8.84129e-05
  gflops: 121.565
-----------------------------------
max element torch :      29.375
max element jit :        29.375
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "82,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 82
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000224875
  gflops: 47.7949
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->82];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->82
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->82
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff877fd000
[DEBUG] GEMM shape: m=256 n=256 k=82 lda=256 ldb=82 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000262613
  time (contract): 0.000135492
  gflops: 79.3253

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "82,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 82
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000333831
  gflops: 32.1956
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->82];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->82
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->82
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80f4b000
[DEBUG] GEMM shape: m=256 n=256 k=82 lda=256 ldb=82 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000313491
  time (contract): 0.000278488
  gflops: 38.5938

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=84 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "84,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 84
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000125737
  gflops: 87.5641
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->84];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->84
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->84
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbe8c8000
[DEBUG] GEMM shape: m=256 n=256 k=84 lda=256 ldb=84 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000363089
  time (contract): 5.70943e-05
  gflops: 192.84
-----------------------------------
max element torch :      28.75
max element jit :        28.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "84,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 84
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000234085
  gflops: 47.0344
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->84];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->84
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->84
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb3877000
[DEBUG] GEMM shape: m=256 n=256 k=84 lda=256 ldb=84 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000273588
  time (contract): 0.000137409
  gflops: 80.126

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "84,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 84
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000344307
  gflops: 31.9774
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->84];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->84
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->84
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb91d0000
[DEBUG] GEMM shape: m=256 n=256 k=84 lda=256 ldb=84 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000291828
  time (contract): 0.000287288
  gflops: 38.3241

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=86 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "86,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 86
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000134154
  gflops: 84.0246
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->86];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->86
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->86
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9975e000
[DEBUG] GEMM shape: m=256 n=256 k=86 lda=256 ldb=86 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000390128
  time (contract): 9.18306e-05
  gflops: 122.75
-----------------------------------
max element torch :      30
max element jit :        30
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "86,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 86
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000248126
  gflops: 45.4293
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->86];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->86
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->86
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbdf4a000
[DEBUG] GEMM shape: m=256 n=256 k=86 lda=256 ldb=86 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000283221
  time (contract): 0.000142051
  gflops: 79.3532

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "86,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 86
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000349883
  gflops: 32.217
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->86];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->86
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->86
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba796000
[DEBUG] GEMM shape: m=256 n=256 k=86 lda=256 ldb=86 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00028818
  time (contract): 0.00029737
  gflops: 37.9063

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=88 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "88,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 88
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000127252
  gflops: 90.642
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->88];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->88
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->88
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7fd2a000
[DEBUG] GEMM shape: m=256 n=256 k=88 lda=256 ldb=88 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000359441
  time (contract): 5.9064e-05
  gflops: 195.285
-----------------------------------
max element torch :      30.875
max element jit :        30.875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "88,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 88
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00025518
  gflops: 45.2009
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->88];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->88
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->88
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d168000
[DEBUG] GEMM shape: m=256 n=256 k=88 lda=256 ldb=88 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00024735
  time (contract): 0.000143648
  gflops: 80.2959

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "88,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 88
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000364409
  gflops: 31.6522
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->88];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->88
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->88
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80922000
[DEBUG] GEMM shape: m=256 n=256 k=88 lda=256 ldb=88 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337171
  time (contract): 0.000311814
  gflops: 36.9911

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=90 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "90,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 90
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000140467
  gflops: 83.9806
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->90];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->90
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->90
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8ef32000
[DEBUG] GEMM shape: m=256 n=256 k=90 lda=256 ldb=90 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000278805
  time (contract): 9.56431e-05
  gflops: 123.339
-----------------------------------
max element torch :      30.875
max element jit :        30.875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "90,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 90
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000263931
  gflops: 44.6954
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->90];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->90
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->90
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1f78000
[DEBUG] GEMM shape: m=256 n=256 k=90 lda=256 ldb=90 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00024703
  time (contract): 0.000147327
  gflops: 80.0702

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "90,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 90
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000360096
  gflops: 32.7592
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->90];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->90
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->90
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9763b000
[DEBUG] GEMM shape: m=256 n=256 k=90 lda=256 ldb=90 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000314643
  time (contract): 0.000314093
  gflops: 37.5572

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=92 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "92,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 92
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000132118
  gflops: 91.2717
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->92];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->92
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->92
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad1ce000
[DEBUG] GEMM shape: m=256 n=256 k=92 lda=256 ldb=92 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331699
  time (contract): 6.07428e-05
  gflops: 198.519
-----------------------------------
max element torch :      32.75
max element jit :        32.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "92,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 92
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000264601
  gflops: 45.5729
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->92];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->92
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->92
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8bf12000
[DEBUG] GEMM shape: m=256 n=256 k=92 lda=256 ldb=92 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000233015
  time (contract): 0.000149218
  gflops: 80.812

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "92,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 92
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000367704
  gflops: 32.7944
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->92];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->92
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->92
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1008000
[DEBUG] GEMM shape: m=256 n=256 k=92 lda=256 ldb=92 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000390672
  time (contract): 0.000323405
  gflops: 37.2864

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=94 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "94,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 94
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000140822
  gflops: 87.4915
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->94];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->94
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->94
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2e20000
[DEBUG] GEMM shape: m=256 n=256 k=94 lda=256 ldb=94 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335346
  time (contract): 9.92542e-05
  gflops: 124.133
-----------------------------------
max element torch :      32.25
max element jit :        32.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "94,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 94
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000266331
  gflops: 46.2612
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->94];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->94
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->94
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84990000
[DEBUG] GEMM shape: m=256 n=256 k=94 lda=256 ldb=94 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000241718
  time (contract): 0.0001526
  gflops: 80.7391

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "94,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 94
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000374816
  gflops: 32.8715
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->94];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->94
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->94
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb254e000
[DEBUG] GEMM shape: m=256 n=256 k=94 lda=256 ldb=94 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000350673
  time (contract): 0.000326677
  gflops: 37.7155

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=96 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "96,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 96
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000134352
  gflops: 93.6564
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->96];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->96
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8aae2000
[DEBUG] GEMM shape: m=256 n=256 k=96 lda=256 ldb=96 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000364049
  time (contract): 6.31301e-05
  gflops: 199.317
-----------------------------------
max element torch :      33.5
max element jit :        33.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "96,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 96
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000264244
  gflops: 47.6185
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->96];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->96
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8479a000
[DEBUG] GEMM shape: m=256 n=256 k=96 lda=256 ldb=96 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000269013
  time (contract): 0.000158902
  gflops: 79.1868

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "96,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 96
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000379475
  gflops: 33.1587
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->96];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->96
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff901f6000
[DEBUG] GEMM shape: m=256 n=256 k=96 lda=256 ldb=96 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000309331
  time (contract): 0.00033959
  gflops: 37.0532

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=98 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "98,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 98
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000143582
  gflops: 89.4612
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->98];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->98
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->98
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9389b000
[DEBUG] GEMM shape: m=256 n=256 k=98 lda=256 ldb=98 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000346866
  time (contract): 0.000102817
  gflops: 124.931
-----------------------------------
max element torch :      32.25
max element jit :        32.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "98,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 98
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000275313
  gflops: 46.6561
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->98];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->98
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->98
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9f1d000
[DEBUG] GEMM shape: m=256 n=256 k=98 lda=256 ldb=98 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312147
  time (contract): 0.00015927
  gflops: 80.6496

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "98,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 98
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000383653
  gflops: 33.481
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->98];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->98
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->98
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb3684000
[DEBUG] GEMM shape: m=256 n=256 k=98 lda=256 ldb=98 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345426
  time (contract): 0.000336765
  gflops: 38.1425

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=100 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "100,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 100
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000137591
  gflops: 95.2622
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->100];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->100
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->100
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9591b000
[DEBUG] GEMM shape: m=256 n=256 k=100 lda=256 ldb=100 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331378
  time (contract): 6.5103e-05
  gflops: 201.33
-----------------------------------
max element torch :      33.75
max element jit :        33.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "100,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 100
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000283153
  gflops: 46.2901
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->100];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->100
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->100
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9064f000
[DEBUG] GEMM shape: m=256 n=256 k=100 lda=256 ldb=100 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000296148
  time (contract): 0.00016113
  gflops: 81.3455

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "100,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 100
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000390178
  gflops: 33.5929
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->100];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->100
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->100
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff886ff000
[DEBUG] GEMM shape: m=256 n=256 k=100 lda=256 ldb=100 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000293748
  time (contract): 0.000346116
  gflops: 37.8694

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=102 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "102,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 102
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.0001491
  gflops: 89.6668
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->102];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->102
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->102
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f101000
[DEBUG] GEMM shape: m=256 n=256 k=102 lda=256 ldb=102 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312244
  time (contract): 0.000106767
  gflops: 125.219
-----------------------------------
max element torch :      35.75
max element jit :        35.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "102,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 102
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000275954
  gflops: 48.4477
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->102];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->102
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->102
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8f43000
[DEBUG] GEMM shape: m=256 n=256 k=102 lda=256 ldb=102 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000281013
  time (contract): 0.00016389
  gflops: 81.5751

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "102,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 102
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000393221
  gflops: 33.9996
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->102];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->102
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->102
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd2e8000
[DEBUG] GEMM shape: m=256 n=256 k=102 lda=256 ldb=102 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00032293
  time (contract): 0.000349723
  gflops: 38.2284

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=104 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "104,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 104
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00014361
  gflops: 94.9204
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->104];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->104
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->104
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff98519000
[DEBUG] GEMM shape: m=256 n=256 k=104 lda=256 ldb=104 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000310004
  time (contract): 6.75399e-05
  gflops: 201.829
-----------------------------------
max element torch :      35.5
max element jit :        35.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "104,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 104
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000286017
  gflops: 47.6596
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->104];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->104
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->104
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8539d000
[DEBUG] GEMM shape: m=256 n=256 k=104 lda=256 ldb=104 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000269301
  time (contract): 0.000168522
  gflops: 80.8882

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "104,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 104
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00039886
  gflops: 34.1761
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->104];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->104
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->104
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff93206000
[DEBUG] GEMM shape: m=256 n=256 k=104 lda=256 ldb=104 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335922
  time (contract): 0.000364801
  gflops: 37.3669

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=106 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "106,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 106
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000152294
  gflops: 91.2289
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->106];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->106
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->106
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88855000
[DEBUG] GEMM shape: m=256 n=256 k=106 lda=256 ldb=106 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000276277
  time (contract): 0.000110828
  gflops: 125.362
-----------------------------------
max element torch :      34.75
max element jit :        34.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "106,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 106
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000277167
  gflops: 50.1273
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->106];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->106
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->106
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4463000
[DEBUG] GEMM shape: m=256 n=256 k=106 lda=256 ldb=106 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000279093
  time (contract): 0.000170832
  gflops: 81.3292

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "106,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 106
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000406166
  gflops: 34.2067
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->106];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->106
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->106
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8cde5000
[DEBUG] GEMM shape: m=256 n=256 k=106 lda=256 ldb=106 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323411
  time (contract): 0.000367507
  gflops: 37.8051

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=108 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "108,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 108
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000145437
  gflops: 97.3329
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->108];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->108
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->108
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8ec1000
[DEBUG] GEMM shape: m=256 n=256 k=108 lda=256 ldb=108 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320594
  time (contract): 6.91222e-05
  gflops: 204.793
-----------------------------------
max element torch :      35.25
max element jit :        35.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "108,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 108
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000283913
  gflops: 49.8596
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->108];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->108
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->108
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9c93000
[DEBUG] GEMM shape: m=256 n=256 k=108 lda=256 ldb=108 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000272468
  time (contract): 0.000173811
  gflops: 81.4436

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "108,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 108
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000412955
  gflops: 34.2792
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->108];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->108
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->108
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa51d6000
[DEBUG] GEMM shape: m=256 n=256 k=108 lda=256 ldb=108 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000351506
  time (contract): 0.000372491
  gflops: 38.003

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=110 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "110,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 110
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000154931
  gflops: 93.0603
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->110];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->110
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->110
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb19a2000
[DEBUG] GEMM shape: m=256 n=256 k=110 lda=256 ldb=110 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000291316
  time (contract): 0.000114472
  gflops: 125.951
-----------------------------------
max element torch :      36.75
max element jit :        36.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "110,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 110
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000255057
  gflops: 56.5282
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->110];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->110
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->110
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff817d9000
[DEBUG] GEMM shape: m=256 n=256 k=110 lda=256 ldb=110 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000244086
  time (contract): 0.000177131
  gflops: 81.397

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "110,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 110
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000416356
  gflops: 34.6288
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->110];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->110
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->110
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb158b000
[DEBUG] GEMM shape: m=256 n=256 k=110 lda=256 ldb=110 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329426
  time (contract): 0.000377604
  gflops: 38.1827

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=112 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "112,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 112
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000148646
  gflops: 98.7584
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->112];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->112
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->112
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82400000
[DEBUG] GEMM shape: m=256 n=256 k=112 lda=256 ldb=112 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328339
  time (contract): 7.08151e-05
  gflops: 207.301
-----------------------------------
max element torch :      38
max element jit :        38
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "112,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 112
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000288484
  gflops: 50.8869
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->112];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->112
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->112
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4276000
[DEBUG] GEMM shape: m=256 n=256 k=112 lda=256 ldb=112 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000287572
  time (contract): 0.00018029
  gflops: 81.4246

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "112,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 112
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000420845
  gflops: 34.8824
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->112];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->112
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->112
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff820d5000
[DEBUG] GEMM shape: m=256 n=256 k=112 lda=256 ldb=112 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329011
  time (contract): 0.000398648
  gflops: 36.8247

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=114 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "114,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 114
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000159072
  gflops: 93.9334
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->114];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->114
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->114
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9fd26000
[DEBUG] GEMM shape: m=256 n=256 k=114 lda=256 ldb=114 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325811
  time (contract): 0.000118038
  gflops: 126.588
-----------------------------------
max element torch :      37.25
max element jit :        37.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "114,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 114
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000299548
  gflops: 49.8826
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->114];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->114
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->114
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8bb3000
[DEBUG] GEMM shape: m=256 n=256 k=114 lda=256 ldb=114 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000271541
  time (contract): 0.000181836
  gflops: 82.1743

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "114,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 114
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000426271
  gflops: 35.0533
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->114];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->114
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->114
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ecbc000
[DEBUG] GEMM shape: m=256 n=256 k=114 lda=256 ldb=114 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000334386
  time (contract): 0.00039077
  gflops: 38.2378

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=116 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "116,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 116
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000155063
  gflops: 98.053
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->116];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->116
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->116
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94e18000
[DEBUG] GEMM shape: m=256 n=256 k=116 lda=256 ldb=116 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343154
  time (contract): 7.34073e-05
  gflops: 207.123
-----------------------------------
max element torch :      38
max element jit :        38
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "116,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 116
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000294714
  gflops: 51.5902
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->116];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->116
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->116
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbbf27000
[DEBUG] GEMM shape: m=256 n=256 k=116 lda=256 ldb=116 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000279508
  time (contract): 0.000184375
  gflops: 82.4644

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "116,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 116
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000432513
  gflops: 35.1535
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->116];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->116
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->116
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbefd2000
[DEBUG] GEMM shape: m=256 n=256 k=116 lda=256 ldb=116 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000363857
  time (contract): 0.000398041
  gflops: 38.1979

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=118 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "118,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 118
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000160535
  gflops: 96.3435
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->118];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->118
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->118
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c4df000
[DEBUG] GEMM shape: m=256 n=256 k=118 lda=256 ldb=118 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029122
  time (contract): 0.000122009
  gflops: 126.765
-----------------------------------
max element torch :      39
max element jit :        39
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "118,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 118
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000299126
  gflops: 51.7056
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->118];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->118
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->118
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf112000
[DEBUG] GEMM shape: m=256 n=256 k=118 lda=256 ldb=118 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000276181
  time (contract): 0.000188357
  gflops: 82.1127

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "118,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 118
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000439344
  gflops: 35.2036
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->118];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->118
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->118
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbafdf000
[DEBUG] GEMM shape: m=256 n=256 k=118 lda=256 ldb=118 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000350289
  time (contract): 0.000405016
  gflops: 38.1874

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=120 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "120,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 120
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000154595
  gflops: 101.741
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->120];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->120
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->120
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb48f0000
[DEBUG] GEMM shape: m=256 n=256 k=120 lda=256 ldb=120 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000322291
  time (contract): 7.51388e-05
  gflops: 209.328
-----------------------------------
max element torch :      40
max element jit :        40
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "120,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 120
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000299238
  gflops: 52.5624
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->120];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->120
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->120
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7f7eb000
[DEBUG] GEMM shape: m=256 n=256 k=120 lda=256 ldb=120 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000283732
  time (contract): 0.000190372
  gflops: 82.6206

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "120,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 120
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000445506
  gflops: 35.3051
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->120];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->120
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->120
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89a60000
[DEBUG] GEMM shape: m=256 n=256 k=120 lda=256 ldb=120 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000344786
  time (contract): 0.000416752
  gflops: 37.741

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=122 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "122,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 122
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000165417
  gflops: 96.6695
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->122];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->122
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->122
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab45c000
[DEBUG] GEMM shape: m=256 n=256 k=122 lda=256 ldb=122 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000308403
  time (contract): 0.000126095
  gflops: 126.815
-----------------------------------
max element torch :      40.25
max element jit :        40.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "122,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 122
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00031791
  gflops: 50.2998
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->122];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->122
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->122
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96adf000
[DEBUG] GEMM shape: m=256 n=256 k=122 lda=256 ldb=122 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000277781
  time (contract): 0.000193773
  gflops: 82.5231

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "122,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 122
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00044846
  gflops: 35.6571
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->122];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->122
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->122
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa42c8000
[DEBUG] GEMM shape: m=256 n=256 k=122 lda=256 ldb=122 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00032901
  time (contract): 0.000418442
  gflops: 38.215

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=124 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "124,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 124
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000158099
  gflops: 102.802
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->124];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->124
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->124
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8e09000
[DEBUG] GEMM shape: m=256 n=256 k=124 lda=256 ldb=124 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354226
  time (contract): 7.68889e-05
  gflops: 211.382
-----------------------------------
max element torch :      43
max element jit :        43
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "124,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 124
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000297251
  gflops: 54.6774
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->124];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->124
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->124
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff83bd0000
[DEBUG] GEMM shape: m=256 n=256 k=124 lda=256 ldb=124 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000293876
  time (contract): 0.000196506
  gflops: 82.7096

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "124,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 124
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000455457
  gflops: 35.6849
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->124];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->124
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->124
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8caf8000
[DEBUG] GEMM shape: m=256 n=256 k=124 lda=256 ldb=124 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033045
  time (contract): 0.000426711
  gflops: 38.0888

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=126 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "126,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 126
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000170109
  gflops: 97.0854
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->126];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->126
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->126
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa61b6000
[DEBUG] GEMM shape: m=256 n=256 k=126 lda=256 ldb=126 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000316083
  time (contract): 0.000129298
  gflops: 127.728
-----------------------------------
max element torch :      41.75
max element jit :        41.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "126,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 126
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000314584
  gflops: 52.4981
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->126];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->126
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->126
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa0a83000
[DEBUG] GEMM shape: m=256 n=256 k=126 lda=256 ldb=126 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000276693
  time (contract): 0.000200419
  gflops: 82.4028

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "126,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 126
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000461212
  gflops: 35.808
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->126];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->126
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->126
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9cf30000
[DEBUG] GEMM shape: m=256 n=256 k=126 lda=256 ldb=126 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345714
  time (contract): 0.000437631
  gflops: 37.7375

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=128 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "128,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 128
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000165992
  gflops: 101.073
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->128];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->128
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->128
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e2c5000
[DEBUG] GEMM shape: m=256 n=256 k=128 lda=256 ldb=128 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000330579
  time (contract): 8.07602e-05
  gflops: 207.741
-----------------------------------
max element torch :      44
max element jit :        44
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "128,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 128
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000371442
  gflops: 45.1679
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->128];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->128
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->128
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb22c3000
[DEBUG] GEMM shape: m=256 n=256 k=128 lda=256 ldb=128 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000295444
  time (contract): 0.00020848
  gflops: 80.4742

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "128,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 128
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000469612
  gflops: 35.7257
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->128];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->128
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->128
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad953000
[DEBUG] GEMM shape: m=256 n=256 k=128 lda=256 ldb=128 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000362673
  time (contract): 0.00045573
  gflops: 36.814

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=130 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "130,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 130
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000175068
  gflops: 97.3298
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->130];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->130
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->130
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8acc000
[DEBUG] GEMM shape: m=256 n=256 k=130 lda=256 ldb=130 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000295956
  time (contract): 0.000135021
  gflops: 126.198
-----------------------------------
max element torch :      43
max element jit :        43
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "130,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 130
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000364623
  gflops: 46.7314
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->130];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->130
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->130
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1814000
[DEBUG] GEMM shape: m=256 n=256 k=130 lda=256 ldb=130 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000308979
  time (contract): 0.000204981
  gflops: 83.1266

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "130,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 130
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000475028
  gflops: 35.8702
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->130];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->130
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->130
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbe4e8000
[DEBUG] GEMM shape: m=256 n=256 k=130 lda=256 ldb=130 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000355026
  time (contract): 0.000447024
  gflops: 38.1173

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=132 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "132,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 132
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000163893
  gflops: 105.566
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->132];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->132
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->132
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d158000
[DEBUG] GEMM shape: m=256 n=256 k=132 lda=256 ldb=132 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348306
  time (contract): 8.16293e-05
  gflops: 211.952
-----------------------------------
max element torch :      43.75
max element jit :        43.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "132,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 132
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000302829
  gflops: 57.1329
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->132];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->132
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->132
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff894ee000
[DEBUG] GEMM shape: m=256 n=256 k=132 lda=256 ldb=132 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000286996
  time (contract): 0.000207011
  gflops: 83.5776

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "132,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 132
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000482613
  gflops: 35.8497
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->132];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->132
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->132
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9cc7c000
[DEBUG] GEMM shape: m=256 n=256 k=132 lda=256 ldb=132 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312467
  time (contract): 0.00047133
  gflops: 36.7079

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=134 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "134,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 134
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000176144
  gflops: 99.7119
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->134];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->134
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->134
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbdb90000
[DEBUG] GEMM shape: m=256 n=256 k=134 lda=256 ldb=134 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324914
  time (contract): 0.000138461
  gflops: 126.849
-----------------------------------
max element torch :      45.5
max element jit :        45.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "134,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 134
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000312956
  gflops: 56.1217
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->134];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->134
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->134
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9655a000
[DEBUG] GEMM shape: m=256 n=256 k=134 lda=256 ldb=134 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029106
  time (contract): 0.000211282
  gflops: 83.1291

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "134,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 134
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000485048
  gflops: 36.2101
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->134];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->134
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->134
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf82c000
[DEBUG] GEMM shape: m=256 n=256 k=134 lda=256 ldb=134 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035285
  time (contract): 0.000458662
  gflops: 38.2932

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=136 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "136,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 136
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000170417
  gflops: 104.601
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->136];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->136
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->136
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8f3d3000
[DEBUG] GEMM shape: m=256 n=256 k=136 lda=256 ldb=136 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323443
  time (contract): 8.30754e-05
  gflops: 214.574
-----------------------------------
max element torch :      45.25
max element jit :        45.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "136,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 136
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000314063
  gflops: 56.7587
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->136];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->136
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->136
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff919d0000
[DEBUG] GEMM shape: m=256 n=256 k=136 lda=256 ldb=136 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000313299
  time (contract): 0.000214716
  gflops: 83.0202

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "136,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 136
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000488855
  gflops: 36.4644
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->136];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->136
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->136
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff919cb000
[DEBUG] GEMM shape: m=256 n=256 k=136 lda=256 ldb=136 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000319763
  time (contract): 0.000475244
  gflops: 37.5087

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=138 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "138,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 138
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000205902
  gflops: 87.8472
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->138];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->138
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->138
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81b08000
[DEBUG] GEMM shape: m=256 n=256 k=138 lda=256 ldb=138 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000300788
  time (contract): 0.000142869
  gflops: 126.605
-----------------------------------
max element torch :      47
max element jit :        47
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "138,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 138
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000317297
  gflops: 57.0064
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->138];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->138
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->138
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99c42000
[DEBUG] GEMM shape: m=256 n=256 k=138 lda=256 ldb=138 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000282997
  time (contract): 0.000216819
  gflops: 83.4241

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "138,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 138
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000493573
  gflops: 36.6469
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->138];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->138
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->138
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb41bc000
[DEBUG] GEMM shape: m=256 n=256 k=138 lda=256 ldb=138 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000330674
  time (contract): 0.000475774
  gflops: 38.0179

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=140 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "140,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 140
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000194713
  gflops: 94.2416
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->140];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->140
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->140
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa60fc000
[DEBUG] GEMM shape: m=256 n=256 k=140 lda=256 ldb=140 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000318611
  time (contract): 8.5893e-05
  gflops: 213.639
-----------------------------------
max element torch :      46.25
max element jit :        46.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "140,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 140
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000313679
  gflops: 58.4996
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->140];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->140
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->140
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb3505000
[DEBUG] GEMM shape: m=256 n=256 k=140 lda=256 ldb=140 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000293332
  time (contract): 0.000220368
  gflops: 83.2702

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "140,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 140
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000499631
  gflops: 36.7273
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->140];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->140
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->140
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92e72000
[DEBUG] GEMM shape: m=256 n=256 k=140 lda=256 ldb=140 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035637
  time (contract): 0.000478836
  gflops: 38.3222

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=142 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "142,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 142
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000210421
  gflops: 88.4523
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->142];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->142
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->142
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7624000
[DEBUG] GEMM shape: m=256 n=256 k=142 lda=256 ldb=142 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000303348
  time (contract): 0.000146509
  gflops: 127.038
-----------------------------------
max element torch :      46
max element jit :        46
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "142,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 142
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000314616
  gflops: 59.1586
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->142];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->142
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->142
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9ff2000
[DEBUG] GEMM shape: m=256 n=256 k=142 lda=256 ldb=142 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000281557
  time (contract): 0.000221981
  gflops: 83.846

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "142,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 142
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000508217
  gflops: 36.6226
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->142];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->142
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->142
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffac374000
[DEBUG] GEMM shape: m=256 n=256 k=142 lda=256 ldb=142 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000346002
  time (contract): 0.000494049
  gflops: 37.6728

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=144 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "144,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 144
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000195883
  gflops: 96.3552
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->144];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->144
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->144
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8a02d000
[DEBUG] GEMM shape: m=256 n=256 k=144 lda=256 ldb=144 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328627
  time (contract): 8.87887e-05
  gflops: 212.576
-----------------------------------
max element torch :      48.5
max element jit :        48.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "144,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 144
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000313778
  gflops: 60.1521
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->144];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->144
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->144
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff98372000
[DEBUG] GEMM shape: m=256 n=256 k=144 lda=256 ldb=144 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000282068
  time (contract): 0.000228006
  gflops: 82.78

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "144,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 144
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000514482
  gflops: 36.6862
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->144];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->144
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->144
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7e88000
[DEBUG] GEMM shape: m=256 n=256 k=144 lda=256 ldb=144 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00032677
  time (contract): 0.00052271
  gflops: 36.1087

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=146 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "146,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 146
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000214609
  gflops: 89.1693
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->146];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->146
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->146
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8a606000
[DEBUG] GEMM shape: m=256 n=256 k=146 lda=256 ldb=146 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000300339
  time (contract): 0.000151852
  gflops: 126.021
-----------------------------------
max element torch :      47.25
max element jit :        47.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "146,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 146
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000324811
  gflops: 58.9159
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->146];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->146
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->146
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9401f000
[DEBUG] GEMM shape: m=256 n=256 k=146 lda=256 ldb=146 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000344914
  time (contract): 0.000230842
  gflops: 82.8987

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "146,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 146
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000513451
  gflops: 37.2703
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->146];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->146
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->146
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffae452000
[DEBUG] GEMM shape: m=256 n=256 k=146 lda=256 ldb=146 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000291252
  time (contract): 0.00050378
  gflops: 37.9859

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=148 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "148,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 148
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000201825
  gflops: 96.1163
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->148];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->148
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->148
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97687000
[DEBUG] GEMM shape: m=256 n=256 k=148 lda=256 ldb=148 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000365553
  time (contract): 9.00208e-05
  gflops: 215.491
-----------------------------------
max element torch :      49.75
max element jit :        49.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "148,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 148
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000320929
  gflops: 60.4454
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->148];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->148
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->148
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab74c000
[DEBUG] GEMM shape: m=256 n=256 k=148 lda=256 ldb=148 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000299347
  time (contract): 0.000234678
  gflops: 82.6607

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "148,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 148
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000524538
  gflops: 36.9824
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->148];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->148
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->148
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7920000
[DEBUG] GEMM shape: m=256 n=256 k=148 lda=256 ldb=148 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324115
  time (contract): 0.000506807
  gflops: 38.2762

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=150 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "150,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 150
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000229498
  gflops: 85.6686
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->150];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->150
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->150
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff85707000
[DEBUG] GEMM shape: m=256 n=256 k=150 lda=256 ldb=150 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329299
  time (contract): 0.000156122
  gflops: 125.933
-----------------------------------
max element torch :      49.5
max element jit :        49.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "150,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 150
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000339533
  gflops: 57.9055
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->150];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->150
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->150
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2804000
[DEBUG] GEMM shape: m=256 n=256 k=150 lda=256 ldb=150 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000275765
  time (contract): 0.000236619
  gflops: 83.0906

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "150,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 150
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000528102
  gflops: 37.2291
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->150];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->150
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->150
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e694000
[DEBUG] GEMM shape: m=256 n=256 k=150 lda=256 ldb=150 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327059
  time (contract): 0.000513115
  gflops: 38.3165

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=152 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "152,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 152
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000204664
  gflops: 97.3448
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->152];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->152
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->152
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff998de000
[DEBUG] GEMM shape: m=256 n=256 k=152 lda=256 ldb=152 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000297588
  time (contract): 9.16085e-05
  gflops: 217.479
-----------------------------------
max element torch :      50.25
max element jit :        50.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "152,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 152
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000327626
  gflops: 60.81
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->152];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->152
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->152
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9bce2000
[DEBUG] GEMM shape: m=256 n=256 k=152 lda=256 ldb=152 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000255126
  time (contract): 0.000238277
  gflops: 83.6124

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "152,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 152
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00053245
  gflops: 37.4175
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->152];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->152
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->152
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff985e0000
[DEBUG] GEMM shape: m=256 n=256 k=152 lda=256 ldb=152 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000368433
  time (contract): 0.000544343
  gflops: 36.6

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=154 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "154,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 154
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000231356
  gflops: 87.247
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->154];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->154
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->154
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbb7a1000
[DEBUG] GEMM shape: m=256 n=256 k=154 lda=256 ldb=154 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000274101
  time (contract): 0.000160876
  gflops: 125.47
-----------------------------------
max element torch :      49
max element jit :        49
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "154,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 154
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000337098
  gflops: 59.879
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->154];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->154
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->154
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7990000
[DEBUG] GEMM shape: m=256 n=256 k=154 lda=256 ldb=154 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000263957
  time (contract): 0.000241702
  gflops: 83.5123

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "154,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 154
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00054147
  gflops: 37.2783
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->154];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->154
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->154
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d602000
[DEBUG] GEMM shape: m=256 n=256 k=154 lda=256 ldb=154 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000352402
  time (contract): 0.000556421
  gflops: 36.2767

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=156 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "156,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 156
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000208973
  gflops: 97.8462
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->156];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->156
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->156
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa73dd000
[DEBUG] GEMM shape: m=256 n=256 k=156 lda=256 ldb=156 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.0002901
  time (contract): 9.48716e-05
  gflops: 215.525
-----------------------------------
max element torch :      49.75
max element jit :        49.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "156,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 156
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.0003512
  gflops: 58.2211
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->156];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->156
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->156
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8ad27000
[DEBUG] GEMM shape: m=256 n=256 k=156 lda=256 ldb=156 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000269685
  time (contract): 0.000244619
  gflops: 83.5879

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "156,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 156
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000544165
  gflops: 37.5754
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->156];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->156
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->156
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb78a8000
[DEBUG] GEMM shape: m=256 n=256 k=156 lda=256 ldb=156 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000353041
  time (contract): 0.000552745
  gflops: 36.9922

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=158 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "158,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 158
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000236602
  gflops: 87.5284
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->158];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->158
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->158
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba9ba000
[DEBUG] GEMM shape: m=256 n=256 k=158 lda=256 ldb=158 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000300212
  time (contract): 0.000164606
  gflops: 125.811
-----------------------------------
max element torch :      51
max element jit :        51
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "158,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 158
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000340164
  gflops: 60.8806
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->158];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->158
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->158
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa984f000
[DEBUG] GEMM shape: m=256 n=256 k=158 lda=256 ldb=158 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000289876
  time (contract): 0.000247308
  gflops: 83.7392

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "158,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 158
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000633503
  gflops: 32.6903
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->158];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->158
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->158
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff909a4000
[DEBUG] GEMM shape: m=256 n=256 k=158 lda=256 ldb=158 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000301236
  time (contract): 0.000540117
  gflops: 38.3424

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=160 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "160,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 160
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000211702
  gflops: 99.0613
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->160];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->160
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->160
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8ac26000
[DEBUG] GEMM shape: m=256 n=256 k=160 lda=256 ldb=160 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312692
  time (contract): 9.6e-05
  gflops: 218.453
-----------------------------------
max element torch :      51
max element jit :        51
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "160,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 160
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000355991
  gflops: 58.9103
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->160];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->160
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->160
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4cfa000
[DEBUG] GEMM shape: m=256 n=256 k=160 lda=256 ldb=160 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000286772
  time (contract): 0.000260682
  gflops: 80.4487

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "160,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 160
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000646136
  gflops: 32.4568
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->160];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->160
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->160
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff992bf000
[DEBUG] GEMM shape: m=256 n=256 k=160 lda=256 ldb=160 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000273876
  time (contract): 0.000581262
  gflops: 36.0793

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=162 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "162,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 162
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000236213
  gflops: 89.8922
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->162];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->162
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->162
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa01a5000
[DEBUG] GEMM shape: m=256 n=256 k=162 lda=256 ldb=162 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000294868
  time (contract): 0.00016896
  gflops: 125.673
-----------------------------------
max element torch :      51.25
max element jit :        51.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "162,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 162
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000368034
  gflops: 57.6948
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->162];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->162
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->162
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff83806000
[DEBUG] GEMM shape: m=256 n=256 k=162 lda=256 ldb=162 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000262549
  time (contract): 0.000252823
  gflops: 83.9863

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "162,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 162
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000655779
  gflops: 32.3793
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->162];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->162
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->162
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa2c56000
[DEBUG] GEMM shape: m=256 n=256 k=162 lda=256 ldb=162 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000373041
  time (contract): 0.000562055
  gflops: 37.7786

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=164 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "164,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 164
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000214331
  gflops: 100.293
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->164];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->164
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->164
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff93378000
[DEBUG] GEMM shape: m=256 n=256 k=164 lda=256 ldb=164 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000322931
  time (contract): 9.77404e-05
  gflops: 219.928
-----------------------------------
max element torch :      52.25
max element jit :        52.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "164,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 164
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000407459
  gflops: 52.7558
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->164];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->164
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->164
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad005000
[DEBUG] GEMM shape: m=256 n=256 k=164 lda=256 ldb=164 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000263989
  time (contract): 0.000256462
  gflops: 83.8168

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "164,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 164
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000651772
  gflops: 32.9806
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->164];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->164
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->164
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8ca14000
[DEBUG] GEMM shape: m=256 n=256 k=164 lda=256 ldb=164 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000303284
  time (contract): 0.000579822
  gflops: 37.0731

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=166 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "166,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 166
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000243224
  gflops: 89.4565
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->166];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->166
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->166
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e523000
[DEBUG] GEMM shape: m=256 n=256 k=166 lda=256 ldb=166 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305908
  time (contract): 0.000172738
  gflops: 125.959
-----------------------------------
max element torch :      52.75
max element jit :        52.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "166,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 166
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000413173
  gflops: 52.6607
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->166];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->166
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->166
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b705000
[DEBUG] GEMM shape: m=256 n=256 k=166 lda=256 ldb=166 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000271765
  time (contract): 0.000260942
  gflops: 83.3824

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "166,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 166
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000657967
  gflops: 33.0684
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->166];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->166
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->166
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb6421000
[DEBUG] GEMM shape: m=256 n=256 k=166 lda=256 ldb=166 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029474
  time (contract): 0.000572805
  gflops: 37.985

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=168 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "168,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 168
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000216584
  gflops: 101.67
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->168];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->168
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->168
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91489000
[DEBUG] GEMM shape: m=256 n=256 k=168 lda=256 ldb=168 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335922
  time (contract): 0.000100872
  gflops: 218.298
-----------------------------------
max element torch :      53.25
max element jit :        53.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "168,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 168
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000414739
  gflops: 53.0939
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->168];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->168
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->168
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7c51000
[DEBUG] GEMM shape: m=256 n=256 k=168 lda=256 ldb=168 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00022799
  time (contract): 0.000263806
  gflops: 83.4707

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "168,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 168
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000670781
  gflops: 32.8276
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->168];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->168
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->168
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff867fb000
[DEBUG] GEMM shape: m=256 n=256 k=168 lda=256 ldb=168 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000308275
  time (contract): 0.000581
  gflops: 37.9004

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=170 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "170,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 170
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000241129
  gflops: 92.4081
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->170];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->170
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->170
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf15c000
[DEBUG] GEMM shape: m=256 n=256 k=170 lda=256 ldb=170 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343346
  time (contract): 0.000176669
  gflops: 126.125
-----------------------------------
max element torch :      56.25
max element jit :        56.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "170,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 170
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000418336
  gflops: 53.264
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->170];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->170
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->170
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7a48000
[DEBUG] GEMM shape: m=256 n=256 k=170 lda=256 ldb=170 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000206136
  time (contract): 0.000265951
  gflops: 83.7833

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "170,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 170
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000679958
  gflops: 32.77
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->170];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->170
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->170
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffae87a000
[DEBUG] GEMM shape: m=256 n=256 k=170 lda=256 ldb=170 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000279029
  time (contract): 0.000598718
  gflops: 37.2166

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=172 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "172,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 172
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000222291
  gflops: 101.418
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->172];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->172
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->172
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e4f7000
[DEBUG] GEMM shape: m=256 n=256 k=172 lda=256 ldb=172 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000290805
  time (contract): 0.000101759
  gflops: 221.547
-----------------------------------
max element torch :      54
max element jit :        54
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "172,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 172
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000420001
  gflops: 53.6769
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->172];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->172
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->172
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa86ea000
[DEBUG] GEMM shape: m=256 n=256 k=172 lda=256 ldb=172 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000223959
  time (contract): 0.000268715
  gflops: 83.897

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "172,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 172
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000701785
  gflops: 32.1244
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->172];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->172
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->172
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b366000
[DEBUG] GEMM shape: m=256 n=256 k=172 lda=256 ldb=172 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000287796
  time (contract): 0.000602063
  gflops: 37.4452

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=174 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "174,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 174
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000250393
  gflops: 91.0828
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->174];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->174
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->174
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97149000
[DEBUG] GEMM shape: m=256 n=256 k=174 lda=256 ldb=174 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000287604
  time (contract): 0.000179196
  gflops: 127.271
-----------------------------------
max element torch :      55
max element jit :        55
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "174,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 174
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00043845
  gflops: 52.0163
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->174];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->174
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->174
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffade30000
[DEBUG] GEMM shape: m=256 n=256 k=174 lda=256 ldb=174 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000232631
  time (contract): 0.000273083
  gflops: 83.515

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "174,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 174
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000690326
  gflops: 33.0374
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->174];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->174
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->174
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97a88000
[DEBUG] GEMM shape: m=256 n=256 k=174 lda=256 ldb=174 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000293108
  time (contract): 0.000602856
  gflops: 37.8308

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=176 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "176,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 176
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000225685
  gflops: 102.216
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->176];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->176
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->176
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff854bb000
[DEBUG] GEMM shape: m=256 n=256 k=176 lda=256 ldb=176 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000291892
  time (contract): 0.000103791
  gflops: 222.261
-----------------------------------
max element torch :      56.5
max element jit :        56.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "176,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 176
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000425554
  gflops: 54.2086
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->176];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->176
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->176
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87387000
[DEBUG] GEMM shape: m=256 n=256 k=176 lda=256 ldb=176 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000277365
  time (contract): 0.000287644
  gflops: 80.1986

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "176,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 176
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000695658
  gflops: 33.1609
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->176];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->176
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->176
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbae52000
[DEBUG] GEMM shape: m=256 n=256 k=176 lda=256 ldb=176 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000314259
  time (contract): 0.000633931
  gflops: 36.3899

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=178 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "178,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 178
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000240973
  gflops: 96.8192
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->178];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->178
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->178
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2294000
[DEBUG] GEMM shape: m=256 n=256 k=178 lda=256 ldb=178 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000270453
  time (contract): 0.000185068
  gflops: 126.066
-----------------------------------
max element torch :      57.25
max element jit :        57.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "178,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 178
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000413761
  gflops: 56.3872
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->178];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->178
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->178
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd988000
[DEBUG] GEMM shape: m=256 n=256 k=178 lda=256 ldb=178 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000277109
  time (contract): 0.000279483
  gflops: 83.4786

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "178,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 178
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000710324
  gflops: 32.8453
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->178];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->178
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->178
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9bf0000
[DEBUG] GEMM shape: m=256 n=256 k=178 lda=256 ldb=178 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324019
  time (contract): 0.000610815
  gflops: 38.1962

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=180 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "180,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 180
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000227387
  gflops: 103.757
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->180];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->180
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->180
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91578000
[DEBUG] GEMM shape: m=256 n=256 k=180 lda=256 ldb=180 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000284053
  time (contract): 0.00010753
  gflops: 219.409
-----------------------------------
max element torch :      56.75
max element jit :        56.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "180,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 180
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000407895
  gflops: 57.8408
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->180];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->180
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->180
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbaf23000
[DEBUG] GEMM shape: m=256 n=256 k=180 lda=256 ldb=180 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000276149
  time (contract): 0.000282716
  gflops: 83.451

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "180,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 180
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000709923
  gflops: 33.2331
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->180];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->180
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->180
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa49cf000
[DEBUG] GEMM shape: m=256 n=256 k=180 lda=256 ldb=180 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337298
  time (contract): 0.000626978
  gflops: 37.6297

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=182 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "182,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 182
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000245965
  gflops: 96.9857
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->182];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->182
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->182
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb6447000
[DEBUG] GEMM shape: m=256 n=256 k=182 lda=256 ldb=182 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000277076
  time (contract): 0.0001891
  gflops: 126.151
-----------------------------------
max element torch :      57.75
max element jit :        57.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "182,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 182
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000425346
  gflops: 56.084
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->182];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->182
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->182
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff945ec000
[DEBUG] GEMM shape: m=256 n=256 k=182 lda=256 ldb=182 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00028514
  time (contract): 0.00028542
  gflops: 83.579

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "182,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 182
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000713404
  gflops: 33.4384
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->182];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->182
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->182
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba403000
[DEBUG] GEMM shape: m=256 n=256 k=182 lda=256 ldb=182 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000347026
  time (contract): 0.000629656
  gflops: 37.8859

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=184 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "184,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 184
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000225786
  gflops: 106.814
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->184];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->184
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->184
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc607000
[DEBUG] GEMM shape: m=256 n=256 k=184 lda=256 ldb=184 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000316563
  time (contract): 0.000108078
  gflops: 223.147
-----------------------------------
max element torch :      58.25
max element jit :        58.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "184,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 184
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000409141
  gflops: 58.946
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->184];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->184
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->184
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5b48000
[DEBUG] GEMM shape: m=256 n=256 k=184 lda=256 ldb=184 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000269877
  time (contract): 0.000288852
  gflops: 83.4934

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "184,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 184
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000725467
  gflops: 33.2437
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->184];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->184
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->184
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf82f000
[DEBUG] GEMM shape: m=256 n=256 k=184 lda=256 ldb=184 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000307155
  time (contract): 0.000654198
  gflops: 36.8653

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=186 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "186,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 186
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000257791
  gflops: 94.5705
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->186];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->186
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->186
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86a52000
[DEBUG] GEMM shape: m=256 n=256 k=186 lda=256 ldb=186 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323731
  time (contract): 0.000194242
  gflops: 125.511
-----------------------------------
max element torch :      59.25
max element jit :        59.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "186,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 186
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000415459
  gflops: 58.6806
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->186];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->186
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->186
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87859000
[DEBUG] GEMM shape: m=256 n=256 k=186 lda=256 ldb=186 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000285685
  time (contract): 0.000289412
  gflops: 84.2375

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "186,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 186
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00072595
  gflops: 33.5828
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->186];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->186
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->186
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbbede000
[DEBUG] GEMM shape: m=256 n=256 k=186 lda=256 ldb=186 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306004
  time (contract): 0.000690797
  gflops: 35.2917

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=188 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "188,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 188
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000227561
  gflops: 108.285
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->188];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->188
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->188
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff95e17000
[DEBUG] GEMM shape: m=256 n=256 k=188 lda=256 ldb=188 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000361073
  time (contract): 0.000110385
  gflops: 223.232
-----------------------------------
max element torch :      61.5
max element jit :        61.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "188,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 188
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000426286
  gflops: 57.8052
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->188];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->188
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->188
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf1b6000
[DEBUG] GEMM shape: m=256 n=256 k=188 lda=256 ldb=188 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000264085
  time (contract): 0.000303951
  gflops: 81.0707

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "188,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 188
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000752623
  gflops: 32.7409
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->188];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->188
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->188
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ea71000
[DEBUG] GEMM shape: m=256 n=256 k=188 lda=256 ldb=188 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000311219
  time (contract): 0.000716124
  gflops: 34.4096

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=190 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "190,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 190
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000253911
  gflops: 98.0805
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->190];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->190
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->190
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa71ae000
[DEBUG] GEMM shape: m=256 n=256 k=190 lda=256 ldb=190 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000303188
  time (contract): 0.000197761
  gflops: 125.928
-----------------------------------
max element torch :      59.25
max element jit :        59.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "190,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 190
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00044753
  gflops: 55.6469
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->190];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->190
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->190
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9045000
[DEBUG] GEMM shape: m=256 n=256 k=190 lda=256 ldb=190 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000279797
  time (contract): 0.000301162
  gflops: 82.6919

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "190,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 190
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000741794
  gflops: 33.5723
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->190];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->190
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->190
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90b03000
[DEBUG] GEMM shape: m=256 n=256 k=190 lda=256 ldb=190 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000358514
  time (contract): 0.000682028
  gflops: 36.5142

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=192 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "192,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 192
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000232258
  gflops: 108.353
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->192];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->192
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->192
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2dde000
[DEBUG] GEMM shape: m=256 n=256 k=192 lda=256 ldb=192 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000302836
  time (contract): 0.000115991
  gflops: 216.963
-----------------------------------
max element torch :      60.25
max element jit :        60.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "192,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 192
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000456908
  gflops: 55.0785
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->192];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->192
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->192
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b8ee000
[DEBUG] GEMM shape: m=256 n=256 k=192 lda=256 ldb=192 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000284436
  time (contract): 0.000315869
  gflops: 79.6717

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "192,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 192
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000757279
  gflops: 33.2319
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->192];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->192
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->192
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84c4f000
[DEBUG] GEMM shape: m=256 n=256 k=192 lda=256 ldb=192 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000299668
  time (contract): 0.000719828
  gflops: 34.9609

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=194 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "194,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 194
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000259705
  gflops: 97.9109
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->194];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->194
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->194
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99320000
[DEBUG] GEMM shape: m=256 n=256 k=194 lda=256 ldb=194 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000302164
  time (contract): 0.000201465
  gflops: 126.215
-----------------------------------
max element torch :      61.5
max element jit :        61.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "194,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 194
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000462337
  gflops: 54.9988
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->194];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->194
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->194
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff928c8000
[DEBUG] GEMM shape: m=256 n=256 k=194 lda=256 ldb=194 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000254709
  time (contract): 0.00030358
  gflops: 83.7604

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "194,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 194
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000770517
  gflops: 33.0012
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->194];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->194
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->194
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88a16000
[DEBUG] GEMM shape: m=256 n=256 k=194 lda=256 ldb=194 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324114
  time (contract): 0.000676517
  gflops: 37.5866

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=196 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "196,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 196
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000240523
  gflops: 106.809
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->196];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->196
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->196
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5254000
[DEBUG] GEMM shape: m=256 n=256 k=196 lda=256 ldb=196 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326483
  time (contract): 0.000114326
  gflops: 224.709
-----------------------------------
max element torch :      60.75
max element jit :        60.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "196,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 196
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000468669
  gflops: 54.8151
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->196];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->196
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->196
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xfffface17000
[DEBUG] GEMM shape: m=256 n=256 k=196 lda=256 ldb=196 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000283284
  time (contract): 0.000305612
  gflops: 84.0612

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "196,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 196
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000576546
  gflops: 44.5586
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->196];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->196
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->196
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90392000
[DEBUG] GEMM shape: m=256 n=256 k=196 lda=256 ldb=196 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312179
  time (contract): 0.0006727
  gflops: 38.1895

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=198 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "198,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 198
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00026742
  gflops: 97.0468
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->198];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->198
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->198
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff812bf000
[DEBUG] GEMM shape: m=256 n=256 k=198 lda=256 ldb=198 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000316627
  time (contract): 0.000203863
  gflops: 127.302
-----------------------------------
max element torch :      62.5
max element jit :        62.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "198,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 198
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00047409
  gflops: 54.7412
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->198];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->198
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->198
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff874c8000
[DEBUG] GEMM shape: m=256 n=256 k=198 lda=256 ldb=198 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000257558
  time (contract): 0.000306945
  gflops: 84.5501

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "198,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 198
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000578086
  gflops: 44.8934
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->198];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->198
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->198
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0434000
[DEBUG] GEMM shape: m=256 n=256 k=198 lda=256 ldb=198 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000300948
  time (contract): 0.00067885
  gflops: 38.2298

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=200 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "200,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 200
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00023686
  gflops: 110.675
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->200];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->200
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->200
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff93caa000
[DEBUG] GEMM shape: m=256 n=256 k=200 lda=256 ldb=200 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000317491
  time (contract): 0.000116397
  gflops: 225.216
-----------------------------------
max element torch :      62.5
max element jit :        62.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "200,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 200
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00047762
  gflops: 54.8855
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->200];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->200
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->200
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90268000
[DEBUG] GEMM shape: m=256 n=256 k=200 lda=256 ldb=200 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000280341
  time (contract): 0.000312861
  gflops: 83.7894

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "200,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 200
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000600463
  gflops: 43.657
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->200];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->200
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->200
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99777000
[DEBUG] GEMM shape: m=256 n=256 k=200 lda=256 ldb=200 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033173
  time (contract): 0.000691537
  gflops: 37.9074

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=202 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "202,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 202
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000261879
  gflops: 101.102
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->202];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->202
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->202
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa2bf6000
[DEBUG] GEMM shape: m=256 n=256 k=202 lda=256 ldb=202 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000273621
  time (contract): 0.000207788
  gflops: 127.421
-----------------------------------
max element torch :      62.5
max element jit :        62.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "202,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 202
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00049142
  gflops: 53.8776
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->202];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->202
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->202
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89888000
[DEBUG] GEMM shape: m=256 n=256 k=202 lda=256 ldb=202 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000277813
  time (contract): 0.000317414
  gflops: 83.4133

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "202,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 202
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000592947
  gflops: 44.6525
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->202];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->202
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->202
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbe434000
[DEBUG] GEMM shape: m=256 n=256 k=202 lda=256 ldb=202 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000339603
  time (contract): 0.000739024
  gflops: 35.8264

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=204 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "204,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 204
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000229446
  gflops: 116.536
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->204];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->204
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->204
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7091000
[DEBUG] GEMM shape: m=256 n=256 k=204 lda=256 ldb=204 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000302644
  time (contract): 0.000119235
  gflops: 224.252
-----------------------------------
max element torch :      62.5
max element jit :        62.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "204,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 204
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000484057
  gflops: 55.2388
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->204];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->204
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->204
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffadf0c000
[DEBUG] GEMM shape: m=256 n=256 k=204 lda=256 ldb=204 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000243126
  time (contract): 0.000319628
  gflops: 83.6557

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "204,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 204
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000598359
  gflops: 44.6867
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->204];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->204
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->204
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7fb10000
[DEBUG] GEMM shape: m=256 n=256 k=204 lda=256 ldb=204 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000321331
  time (contract): 0.00074054
  gflops: 36.107

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=206 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "206,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 206
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000260711
  gflops: 103.566
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->206];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->206
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->206
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97ce5000
[DEBUG] GEMM shape: m=256 n=256 k=206 lda=256 ldb=206 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00026543
  time (contract): 0.000213473
  gflops: 126.484
-----------------------------------
max element torch :      63.25
max element jit :        63.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "206,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 206
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000488685
  gflops: 55.252
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->206];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->206
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->206
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa6d1e000
[DEBUG] GEMM shape: m=256 n=256 k=206 lda=256 ldb=206 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000237238
  time (contract): 0.000323901
  gflops: 83.3613

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "206,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 206
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000612315
  gflops: 44.0963
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->206];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->206
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->206
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa86f5000
[DEBUG] GEMM shape: m=256 n=256 k=206 lda=256 ldb=206 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323091
  time (contract): 0.000707495
  gflops: 38.164

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=208 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "208,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 208
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000248744
  gflops: 109.602
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->208];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->208
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->208
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86903000
[DEBUG] GEMM shape: m=256 n=256 k=208 lda=256 ldb=208 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000307475
  time (contract): 0.00011999
  gflops: 227.21
-----------------------------------
max element torch :      64
max element jit :        64
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "208,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 208
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000492205
  gflops: 55.3895
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->208];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->208
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->208
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa4f21000
[DEBUG] GEMM shape: m=256 n=256 k=208 lda=256 ldb=208 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000262069
  time (contract): 0.000331992
  gflops: 82.1194

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "208,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 208
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000610713
  gflops: 44.6412
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->208];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->208
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->208
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb947a000
[DEBUG] GEMM shape: m=256 n=256 k=208 lda=256 ldb=208 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000340146
  time (contract): 0.000793907
  gflops: 34.3402

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=210 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "210,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 210
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000259108
  gflops: 106.23
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->210];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->210
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->210
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb6207000
[DEBUG] GEMM shape: m=256 n=256 k=210 lda=256 ldb=210 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000303219
  time (contract): 0.000217803
  gflops: 126.376
-----------------------------------
max element torch :      65.5
max element jit :        65.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "210,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 210
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000494637
  gflops: 55.6471
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->210];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->210
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->210
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1ec9000
[DEBUG] GEMM shape: m=256 n=256 k=210 lda=256 ldb=210 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000269333
  time (contract): 0.000327647
  gflops: 84.0084

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "210,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 210
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000629531
  gflops: 43.7232
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->210];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->210
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->210
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff960ad000
[DEBUG] GEMM shape: m=256 n=256 k=210 lda=256 ldb=210 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000347858
  time (contract): 0.000730175
  gflops: 37.6966

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=212 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "212,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 212
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000248049
  gflops: 112.023
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->212];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->212
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->212
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9df1c000
[DEBUG] GEMM shape: m=256 n=256 k=212 lda=256 ldb=212 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331442
  time (contract): 0.00012338
  gflops: 225.218
-----------------------------------
max element torch :      65
max element jit :        65
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "212,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 212
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000506658
  gflops: 54.8442
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->212];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->212
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->212
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb02a3000
[DEBUG] GEMM shape: m=256 n=256 k=212 lda=256 ldb=212 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000273076
  time (contract): 0.000335458
  gflops: 82.8338

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "212,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 212
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000624799
  gflops: 44.4739
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->212];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->212
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->212
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb345d000
[DEBUG] GEMM shape: m=256 n=256 k=212 lda=256 ldb=212 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326674
  time (contract): 0.000824521
  gflops: 33.7011

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=214 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "214,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 214
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000263263
  gflops: 106.545
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->214];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->214
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->214
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92587000
[DEBUG] GEMM shape: m=256 n=256 k=214 lda=256 ldb=214 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029538
  time (contract): 0.000222427
  gflops: 126.106
-----------------------------------
max element torch :      65.5
max element jit :        65.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "214,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 214
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000503052
  gflops: 55.7585
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->214];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->214
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->214
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97952000
[DEBUG] GEMM shape: m=256 n=256 k=214 lda=256 ldb=214 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000286164
  time (contract): 0.000334679
  gflops: 83.81

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "214,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 214
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000623223
  gflops: 45.007
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->214];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->214
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->214
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8eb04000
[DEBUG] GEMM shape: m=256 n=256 k=214 lda=256 ldb=214 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354801
  time (contract): 0.000741018
  gflops: 37.8525

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=216 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "216,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 216
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000266636
  gflops: 106.18
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->216];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->216
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->216
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81dc7000
[DEBUG] GEMM shape: m=256 n=256 k=216 lda=256 ldb=216 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332691
  time (contract): 0.000124467
  gflops: 227.462
-----------------------------------
max element torch :      65.5
max element jit :        65.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "216,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 216
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000508897
  gflops: 55.6331
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->216];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->216
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->216
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd6c1000
[DEBUG] GEMM shape: m=256 n=256 k=216 lda=256 ldb=216 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000276661
  time (contract): 0.000337687
  gflops: 83.8397

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "216,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 216
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000645941
  gflops: 43.83
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->216];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->216
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->216
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff98584000
[DEBUG] GEMM shape: m=256 n=256 k=216 lda=256 ldb=216 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331762
  time (contract): 0.000778523
  gflops: 36.3657

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=218 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "218,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 218
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000280767
  gflops: 101.77
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->218];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->218
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->218
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89ec8000
[DEBUG] GEMM shape: m=256 n=256 k=218 lda=256 ldb=218 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323379
  time (contract): 0.000227176
  gflops: 125.778
-----------------------------------
max element torch :      68.5
max element jit :        68.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "218,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 218
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000512733
  gflops: 55.7282
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->218];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->218
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->218
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f3a2000
[DEBUG] GEMM shape: m=256 n=256 k=218 lda=256 ldb=218 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000282837
  time (contract): 0.000342857
  gflops: 83.3401

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "218,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 218
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000643397
  gflops: 44.4107
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->218];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->218
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->218
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8468f000
[DEBUG] GEMM shape: m=256 n=256 k=218 lda=256 ldb=218 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000334003
  time (contract): 0.000813884
  gflops: 35.1078

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=220 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "220,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 220
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000252287
  gflops: 114.298
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->220];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->220
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->220
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d64d000
[DEBUG] GEMM shape: m=256 n=256 k=220 lda=256 ldb=220 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320883
  time (contract): 0.000127613
  gflops: 225.963
-----------------------------------
max element torch :      69.5
max element jit :        69.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "220,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 220
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000514493
  gflops: 56.0471
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->220];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->220
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->220
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff814c2000
[DEBUG] GEMM shape: m=256 n=256 k=220 lda=256 ldb=220 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000282676
  time (contract): 0.000345346
  gflops: 83.4983

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "220,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 220
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000643397
  gflops: 44.8181
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->220];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->220
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->220
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbe403000
[DEBUG] GEMM shape: m=256 n=256 k=220 lda=256 ldb=220 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329202
  time (contract): 0.000781791
  gflops: 36.8843

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=222 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "222,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 222
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000280068
  gflops: 103.896
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->222];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->222
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->222
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4fa0000
[DEBUG] GEMM shape: m=256 n=256 k=222 lda=256 ldb=222 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000317811
  time (contract): 0.000227788
  gflops: 127.741
-----------------------------------
max element torch :      73.5
max element jit :        73.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "222,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 222
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000515972
  gflops: 56.3946
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->222];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->222
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->222
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff93789000
[DEBUG] GEMM shape: m=256 n=256 k=222 lda=256 ldb=222 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000269781
  time (contract): 0.000351333
  gflops: 82.8217

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "222,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 222
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000658773
  gflops: 44.17
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->222];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->222
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->222
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8581f000
[DEBUG] GEMM shape: m=256 n=256 k=222 lda=256 ldb=222 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000336338
  time (contract): 0.000769306
  gflops: 37.8237

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=224 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "224,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 224
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000256257
  gflops: 114.573
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->224];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->224
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->224
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffac0de000
[DEBUG] GEMM shape: m=256 n=256 k=224 lda=256 ldb=224 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000277108
  time (contract): 0.000131675
  gflops: 222.973
-----------------------------------
max element torch :      70
max element jit :        70
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "224,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 224
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00056909
  gflops: 51.5914
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->224];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->224
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->224
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8de4000
[DEBUG] GEMM shape: m=256 n=256 k=224 lda=256 ldb=224 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000262389
  time (contract): 0.000371349
  gflops: 79.0635

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "224,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 224
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000657387
  gflops: 44.6619
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->224];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->224
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->224
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86c98000
[DEBUG] GEMM shape: m=256 n=256 k=224 lda=256 ldb=224 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345009
  time (contract): 0.000829949
  gflops: 35.3758

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=226 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "226,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 226
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000286201
  gflops: 103.502
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->226];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->226
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->226
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8397c000
[DEBUG] GEMM shape: m=256 n=256 k=226 lda=256 ldb=226 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000276372
  time (contract): 0.000235068
  gflops: 126.016
-----------------------------------
max element torch :      71.5
max element jit :        71.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "226,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 226
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000501291
  gflops: 59.0919
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->226];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->226
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->226
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbca0d000
[DEBUG] GEMM shape: m=256 n=256 k=226 lda=256 ldb=226 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000300692
  time (contract): 0.000358694
  gflops: 82.5837

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "226,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 226
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000678081
  gflops: 43.6855
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->226];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->226
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->226
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e2da000
[DEBUG] GEMM shape: m=256 n=256 k=226 lda=256 ldb=226 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332018
  time (contract): 0.000864213
  gflops: 34.2766

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=228 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "228,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 228
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000277751
  gflops: 107.594
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->228];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->228
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->228
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbaebd000
[DEBUG] GEMM shape: m=256 n=256 k=228 lda=256 ldb=228 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000313524
  time (contract): 0.000130605
  gflops: 228.816
-----------------------------------
max element torch :      70
max element jit :        70
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "228,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 228
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000526758
  gflops: 56.7328
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->228];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->228
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->228
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad794000
[DEBUG] GEMM shape: m=256 n=256 k=228 lda=256 ldb=228 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000293844
  time (contract): 0.000358207
  gflops: 83.4277

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "228,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 228
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000672497
  gflops: 44.438
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->228];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->228
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->228
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9d18000
[DEBUG] GEMM shape: m=256 n=256 k=228 lda=256 ldb=228 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000340466
  time (contract): 0.000817671
  gflops: 36.5482

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=230 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "230,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 230
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00027947
  gflops: 107.87
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->230];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->230
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->230
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87c51000
[DEBUG] GEMM shape: m=256 n=256 k=230 lda=256 ldb=230 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000282484
  time (contract): 0.000237414
  gflops: 126.979
-----------------------------------
max element torch :      70.5
max element jit :        70.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "230,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 230
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000518129
  gflops: 58.1835
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->230];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->230
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->230
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89b69000
[DEBUG] GEMM shape: m=256 n=256 k=230 lda=256 ldb=230 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000280116
  time (contract): 0.000359923
  gflops: 83.7584

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "230,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 230
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000670753
  gflops: 44.9444
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->230];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->230
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->230
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbefb4000
[DEBUG] GEMM shape: m=256 n=256 k=230 lda=256 ldb=230 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000336082
  time (contract): 0.000809223
  gflops: 37.2537

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=232 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "232,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 232
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000251811
  gflops: 120.76
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->232];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->232
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->232
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb964a000
[DEBUG] GEMM shape: m=256 n=256 k=232 lda=256 ldb=232 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327955
  time (contract): 0.000134016
  gflops: 226.903
-----------------------------------
max element torch :      71
max element jit :        71
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "232,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 232
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000540365
  gflops: 56.2744
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->232];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->232
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->232
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbadcd000
[DEBUG] GEMM shape: m=256 n=256 k=232 lda=256 ldb=232 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000293812
  time (contract): 0.000363962
  gflops: 83.549

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "232,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 232
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000689425
  gflops: 44.1073
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->232];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->232
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->232
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffadcc3000
[DEBUG] GEMM shape: m=256 n=256 k=232 lda=256 ldb=232 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338483
  time (contract): 0.000859597
  gflops: 35.3755

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=234 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "234,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 234
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000298168
  gflops: 102.864
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->234];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->234
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->234
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaea81000
[DEBUG] GEMM shape: m=256 n=256 k=234 lda=256 ldb=234 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333715
  time (contract): 0.000242153
  gflops: 126.659
-----------------------------------
max element torch :      73
max element jit :        73
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "234,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 234
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000525674
  gflops: 58.3457
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->234];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->234
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->234
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8859b000
[DEBUG] GEMM shape: m=256 n=256 k=234 lda=256 ldb=234 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00027762
  time (contract): 0.000366795
  gflops: 83.6185

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "234,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 234
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000688818
  gflops: 44.5268
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->234];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->234
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->234
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff924e0000
[DEBUG] GEMM shape: m=256 n=256 k=234 lda=256 ldb=234 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033733
  time (contract): 0.000874107
  gflops: 35.0882

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=236 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "236,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 236
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000262397
  gflops: 117.886
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->236];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->236
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->236
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa27a7000
[DEBUG] GEMM shape: m=256 n=256 k=236 lda=256 ldb=236 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324307
  time (contract): 0.000136108
  gflops: 227.267
-----------------------------------
max element torch :      72.5
max element jit :        72.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "236,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 236
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000519811
  gflops: 59.5082
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->236];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->236
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->236
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff95540000
[DEBUG] GEMM shape: m=256 n=256 k=236 lda=256 ldb=236 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312883
  time (contract): 0.000375152
  gflops: 82.4546

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "236,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 236
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00069132
  gflops: 44.7448
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->236];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->236
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->236
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5b8c000
[DEBUG] GEMM shape: m=256 n=256 k=236 lda=256 ldb=236 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332403
  time (contract): 0.000847845
  gflops: 36.4842

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=238 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "238,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 238
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000292427
  gflops: 106.676
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->238];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->238
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->238
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba66b000
[DEBUG] GEMM shape: m=256 n=256 k=238 lda=256 ldb=238 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000309204
  time (contract): 0.000247199
  gflops: 126.195
-----------------------------------
max element torch :      73.5
max element jit :        73.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "238,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 238
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000524702
  gflops: 59.453
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->238];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->238
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->238
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a483000
[DEBUG] GEMM shape: m=256 n=256 k=238 lda=256 ldb=238 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000287989
  time (contract): 0.000370434
  gflops: 84.2125

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "238,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 238
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000707255
  gflops: 44.1073
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->238];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->238
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->238
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a136000
[DEBUG] GEMM shape: m=256 n=256 k=238 lda=256 ldb=238 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337906
  time (contract): 0.000848221
  gflops: 36.7771

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=240 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "240,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 240
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000275898
  gflops: 114.018
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->240];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->240
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->240
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c2e5000
[DEBUG] GEMM shape: m=256 n=256 k=240 lda=256 ldb=240 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326163
  time (contract): 0.00013844
  gflops: 227.226
-----------------------------------
max element torch :      74
max element jit :        74
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "240,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 240
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000574123
  gflops: 54.7919
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->240];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->240
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->240
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbbbc6000
[DEBUG] GEMM shape: m=256 n=256 k=240 lda=256 ldb=240 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000260149
  time (contract): 0.000378937
  gflops: 83.0146

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "240,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 240
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000703319
  gflops: 44.7269
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->240];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->240
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->240
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb757d000
[DEBUG] GEMM shape: m=256 n=256 k=240 lda=256 ldb=240 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320467
  time (contract): 0.000910292
  gflops: 34.5573

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=242 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "242,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 242
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000292028
  gflops: 108.618
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->242];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->242
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->242
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8cd5c000
[DEBUG] GEMM shape: m=256 n=256 k=242 lda=256 ldb=242 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000310388
  time (contract): 0.000251659
  gflops: 126.041
-----------------------------------
max element torch :      74.5
max element jit :        74.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "242,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 242
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000515629
  gflops: 61.516
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->242];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->242
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->242
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb3259000
[DEBUG] GEMM shape: m=256 n=256 k=242 lda=256 ldb=242 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000276724
  time (contract): 0.000374407
  gflops: 84.719

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "242,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 242
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000702757
  gflops: 45.1357
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->242];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->242
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->242
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97a28000
[DEBUG] GEMM shape: m=256 n=256 k=242 lda=256 ldb=242 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305204
  time (contract): 0.000885433
  gflops: 35.8236

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=244 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "244,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 244
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000268977
  gflops: 118.901
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->244];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->244
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->244
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8047a000
[DEBUG] GEMM shape: m=256 n=256 k=244 lda=256 ldb=244 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327155
  time (contract): 0.000141224
  gflops: 226.46
-----------------------------------
max element torch :      72.5
max element jit :        72.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "244,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 244
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000532354
  gflops: 60.0757
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->244];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->244
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->244
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaeb66000
[DEBUG] GEMM shape: m=256 n=256 k=244 lda=256 ldb=244 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000264501
  time (contract): 0.000394041
  gflops: 81.163

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "244,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 244
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000719077
  gflops: 44.4759
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->244];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->244
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->244
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaa25c000
[DEBUG] GEMM shape: m=256 n=256 k=244 lda=256 ldb=244 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326866
  time (contract): 0.000930696
  gflops: 34.3631

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=246 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "246,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 246
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000288518
  gflops: 111.756
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->246];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->246
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->246
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7f822000
[DEBUG] GEMM shape: m=256 n=256 k=246 lda=256 ldb=246 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328595
  time (contract): 0.000254772
  gflops: 126.559
-----------------------------------
max element torch :      75
max element jit :        75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "246,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 246
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000574279
  gflops: 56.1465
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->246];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->246
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->246
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb94e2000
[DEBUG] GEMM shape: m=256 n=256 k=246 lda=256 ldb=246 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00025679
  time (contract): 0.000386739
  gflops: 83.3733

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "246,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 246
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000718569
  gflops: 44.8721
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->246];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->246
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->246
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb77ae000
[DEBUG] GEMM shape: m=256 n=256 k=246 lda=256 ldb=246 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000304724
  time (contract): 0.000871572
  gflops: 36.9949

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=248 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "248,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 248
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000277069
  gflops: 117.321
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->248];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->248
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->248
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb50c7000
[DEBUG] GEMM shape: m=256 n=256 k=248 lda=256 ldb=248 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029666
  time (contract): 0.000144562
  gflops: 224.858
-----------------------------------
max element torch :      77.5
max element jit :        77.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "248,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 248
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000588333
  gflops: 55.2508
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->248];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->248
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->248
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96ccd000
[DEBUG] GEMM shape: m=256 n=256 k=248 lda=256 ldb=248 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00024351
  time (contract): 0.000405994
  gflops: 80.0649

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "248,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 248
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000737793
  gflops: 44.0583
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->248];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->248
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->248
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87cf1000
[DEBUG] GEMM shape: m=256 n=256 k=248 lda=256 ldb=248 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000287764
  time (contract): 0.000926665
  gflops: 35.0783

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=250 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "250,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 250
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000323701
  gflops: 101.229
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->250];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->250
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->250
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88838000
[DEBUG] GEMM shape: m=256 n=256 k=250 lda=256 ldb=250 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000301972
  time (contract): 0.000260611
  gflops: 125.735
-----------------------------------
max element torch :      78.5
max element jit :        78.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "250,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 250
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000561088
  gflops: 58.4008
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->250];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->250
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->250
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b0f5000
[DEBUG] GEMM shape: m=256 n=256 k=250 lda=256 ldb=250 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000256309
  time (contract): 0.000391579
  gflops: 83.6817

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "250,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 250
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000733782
  gflops: 44.6563
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->250];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->250
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->250
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2823000
[DEBUG] GEMM shape: m=256 n=256 k=250 lda=256 ldb=250 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000301044
  time (contract): 0.00100641
  gflops: 32.5591

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=252 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "252,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 252
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00028461
  gflops: 116.054
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->252];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->252
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->252
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b5c6000
[DEBUG] GEMM shape: m=256 n=256 k=252 lda=256 ldb=252 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000319507
  time (contract): 0.000145322
  gflops: 227.29
-----------------------------------
max element torch :      77
max element jit :        77
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "252,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 252
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000553371
  gflops: 59.689
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->252];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->252
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->252
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9dec1000
[DEBUG] GEMM shape: m=256 n=256 k=252 lda=256 ldb=252 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000243222
  time (contract): 0.000399762
  gflops: 82.6244

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "252,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 252
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000729936
  gflops: 45.2507
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->252];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->252
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->252
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7faa000
[DEBUG] GEMM shape: m=256 n=256 k=252 lda=256 ldb=252 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035109
  time (contract): 0.000959626
  gflops: 34.4198

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=254 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "254,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 254
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000323793
  gflops: 102.82
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->254];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->254
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->254
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa16ae000
[DEBUG] GEMM shape: m=256 n=256 k=254 lda=256 ldb=254 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000316787
  time (contract): 0.000261581
  gflops: 127.273
-----------------------------------
max element torch :      79.5
max element jit :        79.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "254,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 254
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00058846
  gflops: 56.5753
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->254];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->254
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->254
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbab97000
[DEBUG] GEMM shape: m=256 n=256 k=254 lda=256 ldb=254 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000258101
  time (contract): 0.000399411
  gflops: 83.3534

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "254,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 254
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000751126
  gflops: 44.3232
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->254];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->254
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->254
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8095d000
[DEBUG] GEMM shape: m=256 n=256 k=254 lda=256 ldb=254 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000301908
  time (contract): 0.000919781
  gflops: 36.1959

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=256 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "256,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 256
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000342709
  gflops: 97.9093
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->256];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->256
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->256
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d0f6000
[DEBUG] GEMM shape: m=256 n=256 k=256 lda=256 ldb=256 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000293236
  time (contract): 0.000149891
  gflops: 223.859
-----------------------------------
max element torch :      77.5
max element jit :        77.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "256,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 256
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000620842
  gflops: 54.0467
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->256];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->256
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->256
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb46cc000
[DEBUG] GEMM shape: m=256 n=256 k=256 lda=256 ldb=256 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000278709
  time (contract): 0.00042851
  gflops: 78.3048

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "256,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 256
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000744897
  gflops: 45.0457
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->256];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->256
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->256
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82efd000
[DEBUG] GEMM shape: m=256 n=256 k=256 lda=256 ldb=256 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333139
  time (contract): 0.000987451
  gflops: 33.9808

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=258 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "258,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 258
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000348873
  gflops: 96.9309
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->258];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->258
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->258
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff934bf000
[DEBUG] GEMM shape: m=256 n=256 k=258 lda=256 ldb=258 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000288084
  time (contract): 0.000269969
  gflops: 125.261
-----------------------------------
max element torch :      77.5
max element jit :        77.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "258,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 258
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00053054
  gflops: 63.7399
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->258];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->258
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->258
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c983000
[DEBUG] GEMM shape: m=256 n=256 k=258 lda=256 ldb=258 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000284629
  time (contract): 0.000408275
  gflops: 82.8279

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "258,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 258
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000753877
  gflops: 44.8569
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->258];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->258
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->258
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90e41000
[DEBUG] GEMM shape: m=256 n=256 k=258 lda=256 ldb=258 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343954
  time (contract): 0.00103453
  gflops: 32.6878

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=260 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "260,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 260
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000319756
  gflops: 106.577
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->260];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->260
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->260
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf137000
[DEBUG] GEMM shape: m=256 n=256 k=260 lda=256 ldb=260 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000299508
  time (contract): 0.000149851
  gflops: 227.417
-----------------------------------
max element torch :      80.5
max element jit :        80.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "260,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 260
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000543726
  gflops: 62.6763
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->260];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->260
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->260
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d62e000
[DEBUG] GEMM shape: m=256 n=256 k=260 lda=256 ldb=260 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000253142
  time (contract): 0.000409109
  gflops: 83.2998

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "260,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 260
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00076939
  gflops: 44.2932
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->260];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->260
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->260
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4be8000
[DEBUG] GEMM shape: m=256 n=256 k=260 lda=256 ldb=260 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326194
  time (contract): 0.000930229
  gflops: 36.6348

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=262 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "262,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 262
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000335323
  gflops: 102.411
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->262];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->262
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->262
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87805000
[DEBUG] GEMM shape: m=256 n=256 k=262 lda=256 ldb=262 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000321235
  time (contract): 0.000271143
  gflops: 126.652
-----------------------------------
max element torch :      80
max element jit :        80
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "262,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 262
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000557559
  gflops: 61.5914
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->262];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->262
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->262
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbe175000
[DEBUG] GEMM shape: m=256 n=256 k=262 lda=256 ldb=262 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000267669
  time (contract): 0.000414323
  gflops: 82.8842

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "262,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 262
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000759624
  gflops: 45.2077
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->262];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->262
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->262
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9fced000
[DEBUG] GEMM shape: m=256 n=256 k=262 lda=256 ldb=262 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335763
  time (contract): 0.000968231
  gflops: 35.4676

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=264 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "264,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 264
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000319826
  gflops: 108.193
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->264];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->264
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->264
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ad40000
[DEBUG] GEMM shape: m=256 n=256 k=264 lda=256 ldb=264 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354257
  time (contract): 0.00015209
  gflops: 227.516
-----------------------------------
max element torch :      80.5
max element jit :        80.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "264,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 264
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000601043
  gflops: 57.5716
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->264];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->264
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->264
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff981b5000
[DEBUG] GEMM shape: m=256 n=256 k=264 lda=256 ldb=264 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000292148
  time (contract): 0.00041493
  gflops: 83.3948

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "264,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 264
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000763744
  gflops: 45.3071
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->264];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->264
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->264
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa27b3000
[DEBUG] GEMM shape: m=256 n=256 k=264 lda=256 ldb=264 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000322355
  time (contract): 0.00100805
  gflops: 34.3266

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=266 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "266,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 266
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000340821
  gflops: 102.298
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->266];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->266
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->266
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad3c6000
[DEBUG] GEMM shape: m=256 n=256 k=266 lda=256 ldb=266 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000292916
  time (contract): 0.000274715
  gflops: 126.914
-----------------------------------
max element torch :      82
max element jit :        82
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "266,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 266
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00062159
  gflops: 56.0903
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->266];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->266
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->266
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa209a000
[DEBUG] GEMM shape: m=256 n=256 k=266 lda=256 ldb=266 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000317267
  time (contract): 0.000414673
  gflops: 84.0786

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "266,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 266
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000779933
  gflops: 44.7027
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->266];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->266
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->266
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa86e5000
[DEBUG] GEMM shape: m=256 n=256 k=266 lda=256 ldb=266 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000349873
  time (contract): 0.000964106
  gflops: 36.1632

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=268 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "268,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 268
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000326575
  gflops: 107.563
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->268];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->268
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->268
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff939c5000
[DEBUG] GEMM shape: m=256 n=256 k=268 lda=256 ldb=268 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332211
  time (contract): 0.000154212
  gflops: 227.786
-----------------------------------
max element torch :      82
max element jit :        82
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "268,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 268
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000596818
  gflops: 58.8577
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->268];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->268
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->268
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5393000
[DEBUG] GEMM shape: m=256 n=256 k=268 lda=256 ldb=268 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000288501
  time (contract): 0.000420361
  gflops: 83.5647

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "268,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 268
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000779526
  gflops: 45.0624
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->268];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->268
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->268
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa4076000
[DEBUG] GEMM shape: m=256 n=256 k=268 lda=256 ldb=268 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343922
  time (contract): 0.00100754
  gflops: 34.8645

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=270 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "270,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 270
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000351452
  gflops: 100.695
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->270];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->270
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->270
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8c3e000
[DEBUG] GEMM shape: m=256 n=256 k=270 lda=256 ldb=270 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000311347
  time (contract): 0.00027788
  gflops: 127.355
-----------------------------------
max element torch :      85.5
max element jit :        85.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "270,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 270
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000588053
  gflops: 60.1807
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->270];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->270
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->270
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa73e4000
[DEBUG] GEMM shape: m=256 n=256 k=270 lda=256 ldb=270 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000315411
  time (contract): 0.000422831
  gflops: 83.6965

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "270,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 270
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000799571
  gflops: 44.2605
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->270];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->270
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->270
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d6c0000
[DEBUG] GEMM shape: m=256 n=256 k=270 lda=256 ldb=270 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000384272
  time (contract): 0.00101705
  gflops: 34.7962

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=272 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "272,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 272
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000328976
  gflops: 108.371
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->272];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->272
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->272
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0eb2000
[DEBUG] GEMM shape: m=256 n=256 k=272 lda=256 ldb=272 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000402319
  time (contract): 0.000156253
  gflops: 228.166
-----------------------------------
max element torch :      81.5
max element jit :        81.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "272,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 272
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000630644
  gflops: 56.532
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->272];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->272
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->272
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf35c000
[DEBUG] GEMM shape: m=256 n=256 k=272 lda=256 ldb=272 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000288148
  time (contract): 0.000436101
  gflops: 81.7508

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "272,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 272
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000792208
  gflops: 45.0028
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->272];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->272
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->272
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa0a61000
[DEBUG] GEMM shape: m=256 n=256 k=272 lda=256 ldb=272 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306196
  time (contract): 0.00109696
  gflops: 32.5003

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=274 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "274,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 274
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000353725
  gflops: 101.53
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->274];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->274
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->274
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9d8e000
[DEBUG] GEMM shape: m=256 n=256 k=274 lda=256 ldb=274 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324179
  time (contract): 0.000281471
  gflops: 127.593
-----------------------------------
max element torch :      83.5
max element jit :        83.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "274,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 274
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000625015
  gflops: 57.4606
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->274];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->274
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->274
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96222000
[DEBUG] GEMM shape: m=256 n=256 k=274 lda=256 ldb=274 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323187
  time (contract): 0.000428921
  gflops: 83.7304

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "274,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 274
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000791726
  gflops: 45.3613
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->274];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->274
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->274
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9189c000
[DEBUG] GEMM shape: m=256 n=256 k=274 lda=256 ldb=274 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320658
  time (contract): 0.00111346
  gflops: 32.2542

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=276 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "276,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 276
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000338261
  gflops: 106.947
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->276];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->276
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->276
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5c29000
[DEBUG] GEMM shape: m=256 n=256 k=276 lda=256 ldb=276 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00037048
  time (contract): 0.000158748
  gflops: 227.883
-----------------------------------
max element torch :      83.5
max element jit :        83.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "276,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 276
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00061115
  gflops: 59.1931
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->276];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->276
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->276
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ac9c000
[DEBUG] GEMM shape: m=256 n=256 k=276 lda=256 ldb=276 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000311443
  time (contract): 0.000435907
  gflops: 82.9899

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "276,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 276
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000819517
  gflops: 44.1429
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->276];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->276
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->276
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa4edd000
[DEBUG] GEMM shape: m=256 n=256 k=276 lda=256 ldb=276 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305652
  time (contract): 0.00104238
  gflops: 34.705

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=278 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "278,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 278
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000350426
  gflops: 103.982
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->278];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->278
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->278
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8495c000
[DEBUG] GEMM shape: m=256 n=256 k=278 lda=256 ldb=278 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000357489
  time (contract): 0.000287014
  gflops: 126.956
-----------------------------------
max element torch :      84
max element jit :        84
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "278,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 278
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000560806
  gflops: 64.9744
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->278];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->278
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->278
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9b51000
[DEBUG] GEMM shape: m=256 n=256 k=278 lda=256 ldb=278 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000292916
  time (contract): 0.000435579
  gflops: 83.6543

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "278,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 278
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000809689
  gflops: 45.0025
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->278];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->278
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->278
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c912000
[DEBUG] GEMM shape: m=256 n=256 k=278 lda=256 ldb=278 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000292308
  time (contract): 0.00102781
  gflops: 35.4521

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=280 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "280,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 280
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000343088
  gflops: 106.97
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->280];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->280
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->280
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9bfa000
[DEBUG] GEMM shape: m=256 n=256 k=280 lda=256 ldb=280 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034133
  time (contract): 0.000161845
  gflops: 226.761
-----------------------------------
max element torch :      83
max element jit :        83
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "280,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 280
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000567753
  gflops: 64.6411
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->280];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->280
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->280
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba856000
[DEBUG] GEMM shape: m=256 n=256 k=280 lda=256 ldb=280 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000248598
  time (contract): 0.000443209
  gflops: 82.8055

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "280,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 280
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000810159
  gflops: 45.3
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->280];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->280
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->280
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaeb02000
[DEBUG] GEMM shape: m=256 n=256 k=280 lda=256 ldb=280 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338226
  time (contract): 0.00101957
  gflops: 35.9957

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=282 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "282,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 282
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000362284
  gflops: 102.026
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->282];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->282
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->282
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8fd0d000
[DEBUG] GEMM shape: m=256 n=256 k=282 lda=256 ldb=282 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000315891
  time (contract): 0.000291194
  gflops: 126.934
-----------------------------------
max element torch :      86.5
max element jit :        86.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "282,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 282
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000618679
  gflops: 59.7439
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->282];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->282
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->282
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d42b000
[DEBUG] GEMM shape: m=256 n=256 k=282 lda=256 ldb=282 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000270421
  time (contract): 0.000446325
  gflops: 82.8148

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "282,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 282
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000821738
  gflops: 44.9806
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->282];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->282
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->282
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97236000
[DEBUG] GEMM shape: m=256 n=256 k=282 lda=256 ldb=282 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000313971
  time (contract): 0.00106782
  gflops: 34.6147

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=284 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "284,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 284
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000348742
  gflops: 106.739
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->284];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->284
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->284
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffadf0b000
[DEBUG] GEMM shape: m=256 n=256 k=284 lda=256 ldb=284 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.0002893
  time (contract): 0.000159768
  gflops: 232.99
-----------------------------------
max element torch :      86.5
max element jit :        86.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "284,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 284
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000618303
  gflops: 60.2042
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->284];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->284
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->284
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8fdf2000
[DEBUG] GEMM shape: m=256 n=256 k=284 lda=256 ldb=284 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000247862
  time (contract): 0.000455265
  gflops: 81.7643

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "284,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 284
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000821792
  gflops: 45.2967
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->284];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->284
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->284
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7d4a000
[DEBUG] GEMM shape: m=256 n=256 k=284 lda=256 ldb=284 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000301268
  time (contract): 0.00108216
  gflops: 34.3983

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=286 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "286,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 286
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000353243
  gflops: 106.121
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->286];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->286
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->286
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8850c000
[DEBUG] GEMM shape: m=256 n=256 k=286 lda=256 ldb=286 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000318227
  time (contract): 0.000295296
  gflops: 126.946
-----------------------------------
max element torch :      85.5
max element jit :        85.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "286,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 286
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000623214
  gflops: 60.1504
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->286];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->286
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->286
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb441d000
[DEBUG] GEMM shape: m=256 n=256 k=286 lda=256 ldb=286 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000349746
  time (contract): 0.000451468
  gflops: 83.0326

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "286,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 286
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000842066
  gflops: 44.5174
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->286];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->286
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->286
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff981e2000
[DEBUG] GEMM shape: m=256 n=256 k=286 lda=256 ldb=286 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324851
  time (contract): 0.00101425
  gflops: 36.9598

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=288 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "288,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 288
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000351085
  gflops: 107.52
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->288];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->288
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->288
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff98160000
[DEBUG] GEMM shape: m=256 n=256 k=288 lda=256 ldb=288 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329971
  time (contract): 0.000168553
  gflops: 223.957
-----------------------------------
max element torch :      86.5
max element jit :        86.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "288,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 288
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000649813
  gflops: 58.0917
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->288];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->288
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->288
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84276000
[DEBUG] GEMM shape: m=256 n=256 k=288 lda=256 ldb=288 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000321171
  time (contract): 0.000513396
  gflops: 73.5276

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "288,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 288
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000841281
  gflops: 44.8706
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->288];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->288
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->288
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3a43000
[DEBUG] GEMM shape: m=256 n=256 k=288 lda=256 ldb=288 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325395
  time (contract): 0.00116153
  gflops: 32.4993

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=290 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "290,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 290
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000374645
  gflops: 101.458
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->290];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->290
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->290
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84413000
[DEBUG] GEMM shape: m=256 n=256 k=290 lda=256 ldb=290 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000275637
  time (contract): 0.000301382
  gflops: 126.122
-----------------------------------
max element torch :      90
max element jit :        90
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "290,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 290
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000624431
  gflops: 60.8728
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->290];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->290
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->290
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8ed26000
[DEBUG] GEMM shape: m=256 n=256 k=290 lda=256 ldb=290 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000289301
  time (contract): 0.00050039
  gflops: 75.9625

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "290,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 290
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000839075
  gflops: 45.3009
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->290];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->290
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->290
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d9c3000
[DEBUG] GEMM shape: m=256 n=256 k=290 lda=256 ldb=290 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000349618
  time (contract): 0.00111305
  gflops: 34.1503

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=292 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "292,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 292
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000352543
  gflops: 108.563
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->292];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->292
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->292
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1cee000
[DEBUG] GEMM shape: m=256 n=256 k=292 lda=256 ldb=292 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000373904
  time (contract): 0.000165499
  gflops: 231.259
-----------------------------------
max element torch :      86.5
max element jit :        86.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "292,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 292
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000623166
  gflops: 61.4171
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->292];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->292
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->292
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8f2c4000
[DEBUG] GEMM shape: m=256 n=256 k=292 lda=256 ldb=292 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000293876
  time (contract): 0.000459552
  gflops: 83.2833

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "292,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 292
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000857329
  gflops: 44.6422
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->292];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->292
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->292
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbbc83000
[DEBUG] GEMM shape: m=256 n=256 k=292 lda=256 ldb=292 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000311347
  time (contract): 0.0010246
  gflops: 37.354

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=294 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "294,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 294
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000365117
  gflops: 105.542
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->294];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->294
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->294
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc8ac000
[DEBUG] GEMM shape: m=256 n=256 k=294 lda=256 ldb=294 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331922
  time (contract): 0.000304263
  gflops: 126.651
-----------------------------------
max element torch :      89
max element jit :        89
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "294,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 294
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00067066
  gflops: 57.4586
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->294];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->294
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->294
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa84a7000
[DEBUG] GEMM shape: m=256 n=256 k=294 lda=256 ldb=294 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000272533
  time (contract): 0.000465844
  gflops: 82.7211

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "294,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 294
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000851657
  gflops: 45.2473
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->294];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->294
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->294
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99fad000
[DEBUG] GEMM shape: m=256 n=256 k=294 lda=256 ldb=294 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305268
  time (contract): 0.00121688
  gflops: 31.6671

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=296 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "296,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 296
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000355589
  gflops: 109.107
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->296];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->296
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->296
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbeccc000
[DEBUG] GEMM shape: m=256 n=256 k=296 lda=256 ldb=296 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000308724
  time (contract): 0.000169803
  gflops: 228.485
-----------------------------------
max element torch :      88.5
max element jit :        88.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "296,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 296
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000654722
  gflops: 59.2577
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->296];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->296
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->296
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb6b54000
[DEBUG] GEMM shape: m=256 n=256 k=296 lda=256 ldb=296 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000239798
  time (contract): 0.000473749
  gflops: 81.8942

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "296,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 296
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000852972
  gflops: 45.4848
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->296];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->296
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->296
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa0bee000
[DEBUG] GEMM shape: m=256 n=256 k=296 lda=256 ldb=296 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000336018
  time (contract): 0.00109335
  gflops: 35.4847

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=298 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "298,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 298
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000379407
  gflops: 102.949
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->298];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->298
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->298
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff882e3000
[DEBUG] GEMM shape: m=256 n=256 k=298 lda=256 ldb=298 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000278196
  time (contract): 0.000307793
  gflops: 126.902
-----------------------------------
max element torch :      89.5
max element jit :        89.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "298,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 298
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000639965
  gflops: 61.0337
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->298];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->298
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->298
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89940000
[DEBUG] GEMM shape: m=256 n=256 k=298 lda=256 ldb=298 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000301076
  time (contract): 0.000464463
  gflops: 84.0959

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "298,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 298
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000873093
  gflops: 44.7369
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->298];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->298
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->298
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96778000
[DEBUG] GEMM shape: m=256 n=256 k=298 lda=256 ldb=298 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338994
  time (contract): 0.00108356
  gflops: 36.0473

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=300 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "300,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 300
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000352292
  gflops: 111.616
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->300];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->300
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->300
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c144000
[DEBUG] GEMM shape: m=256 n=256 k=300 lda=256 ldb=300 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000288436
  time (contract): 0.000171603
  gflops: 229.143
-----------------------------------
max element torch :      93
max element jit :        93
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "300,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 300
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000649845
  gflops: 60.5092
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->300];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->300
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->300
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92756000
[DEBUG] GEMM shape: m=256 n=256 k=300 lda=256 ldb=300 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029426
  time (contract): 0.00048374
  gflops: 81.2867

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "300,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 300
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000869314
  gflops: 45.2329
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->300];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->300
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->300
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff83aff000
[DEBUG] GEMM shape: m=256 n=256 k=300 lda=256 ldb=300 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000357489
  time (contract): 0.00114487
  gflops: 34.346

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=302 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "302,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 302
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000342426
  gflops: 115.598
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->302];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->302
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->302
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffafc1c000
[DEBUG] GEMM shape: m=256 n=256 k=302 lda=256 ldb=302 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000283381
  time (contract): 0.000313576
  gflops: 126.233
-----------------------------------
max element torch :      94.5
max element jit :        94.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "302,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 302
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000658573
  gflops: 60.1053
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->302];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->302
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->302
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc3c7000
[DEBUG] GEMM shape: m=256 n=256 k=302 lda=256 ldb=302 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000295699
  time (contract): 0.000518866
  gflops: 76.2889

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "302,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 302
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000869801
  gflops: 45.509
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->302];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->302
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->302
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91bf1000
[DEBUG] GEMM shape: m=256 n=256 k=302 lda=256 ldb=302 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000358225
  time (contract): 0.00121861
  gflops: 32.4827

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=304 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "304,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 304
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000371044
  gflops: 107.389
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->304];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->304
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->304
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa92db000
[DEBUG] GEMM shape: m=256 n=256 k=304 lda=256 ldb=304 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000294388
  time (contract): 0.000170255
  gflops: 234.036
-----------------------------------
max element torch :      91
max element jit :        91
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "304,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 304
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000659558
  gflops: 60.413
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->304];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->304
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->304
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffabdd2000
[DEBUG] GEMM shape: m=256 n=256 k=304 lda=256 ldb=304 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000281396
  time (contract): 0.000482504
  gflops: 82.5814

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "304,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 304
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000888337
  gflops: 44.8545
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->304];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->304
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->304
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa514f000
[DEBUG] GEMM shape: m=256 n=256 k=304 lda=256 ldb=304 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000364721
  time (contract): 0.00130126
  gflops: 30.6209

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=306 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "306,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 306
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00039
  gflops: 102.841
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->306];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->306
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->306
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb56b4000
[DEBUG] GEMM shape: m=256 n=256 k=306 lda=256 ldb=306 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000307187
  time (contract): 0.000316568
  gflops: 126.696
-----------------------------------
max element torch :      91.5
max element jit :        91.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "306,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 306
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000678234
  gflops: 59.136
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->306];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->306
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->306
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9fc22000
[DEBUG] GEMM shape: m=256 n=256 k=306 lda=256 ldb=306 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035013
  time (contract): 0.00047958
  gflops: 83.6316

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "306,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 306
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000885638
  gflops: 45.2871
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->306];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->306
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->306
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc263000
[DEBUG] GEMM shape: m=256 n=256 k=306 lda=256 ldb=306 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000366577
  time (contract): 0.00114893
  gflops: 34.9092

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=308 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "308,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 308
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000339661
  gflops: 118.854
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->308];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->308
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->308
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b02f000
[DEBUG] GEMM shape: m=256 n=256 k=308 lda=256 ldb=308 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325714
  time (contract): 0.000175315
  gflops: 230.273
-----------------------------------
max element torch :      92.5
max element jit :        92.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "308,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 308
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00067163
  gflops: 60.1078
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->308];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->308
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->308
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ea9a000
[DEBUG] GEMM shape: m=256 n=256 k=308 lda=256 ldb=308 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000273013
  time (contract): 0.000487486
  gflops: 82.8129

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "308,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 308
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000909172
  gflops: 44.4032
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->308];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->308
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->308
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb6e69000
[DEBUG] GEMM shape: m=256 n=256 k=308 lda=256 ldb=308 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000351602
  time (contract): 0.00143486
  gflops: 28.1353

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=310 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "310,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 310
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000368578
  gflops: 110.241
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->310];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->310
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->310
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd667000
[DEBUG] GEMM shape: m=256 n=256 k=310 lda=256 ldb=310 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325171
  time (contract): 0.000318367
  gflops: 127.627
-----------------------------------
max element torch :      92.5
max element jit :        92.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "310,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 310
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000675096
  gflops: 60.1875
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->310];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->310
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->310
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa0e65000
[DEBUG] GEMM shape: m=256 n=256 k=310 lda=256 ldb=310 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000266581
  time (contract): 0.000490148
  gflops: 82.8981

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "310,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 310
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000902579
  gflops: 45.018
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->310];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->310
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->310
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b71e000
[DEBUG] GEMM shape: m=256 n=256 k=310 lda=256 ldb=310 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000342962
  time (contract): 0.0012513
  gflops: 32.4722

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=312 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "312,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 312
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000383467
  gflops: 106.644
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->312];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->312
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->312
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff965f5000
[DEBUG] GEMM shape: m=256 n=256 k=312 lda=256 ldb=312 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348434
  time (contract): 0.00017663
  gflops: 231.526
-----------------------------------
max element torch :      97
max element jit :        97
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "312,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 312
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000673482
  gflops: 60.7209
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->312];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->312
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->312
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd9c5000
[DEBUG] GEMM shape: m=256 n=256 k=312 lda=256 ldb=312 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000275925
  time (contract): 0.000496866
  gflops: 82.3048

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "312,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 312
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000900634
  gflops: 45.4063
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->312];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->312
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->312
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaedf7000
[DEBUG] GEMM shape: m=256 n=256 k=312 lda=256 ldb=312 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00032213
  time (contract): 0.00120729
  gflops: 33.8731

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=314 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "314,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 314
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000414196
  gflops: 99.3651
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->314];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->314
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->314
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84ecd000
[DEBUG] GEMM shape: m=256 n=256 k=314 lda=256 ldb=314 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000336754
  time (contract): 0.000324093
  gflops: 126.99
-----------------------------------
max element torch :      99.5
max element jit :        99.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "314,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 314
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000685782
  gflops: 60.0141
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->314];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->314
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->314
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff85390000
[DEBUG] GEMM shape: m=256 n=256 k=314 lda=256 ldb=314 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000288148
  time (contract): 0.000495684
  gflops: 83.0299

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "314,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 314
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00091958
  gflops: 44.7559
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->314];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->314
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->314
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5cb6000
[DEBUG] GEMM shape: m=256 n=256 k=314 lda=256 ldb=314 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000339698
  time (contract): 0.00130763
  gflops: 31.4742

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=316 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "316,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 316
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000385381
  gflops: 107.475
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->316];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->316
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->316
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0c42000
[DEBUG] GEMM shape: m=256 n=256 k=316 lda=256 ldb=316 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000334098
  time (contract): 0.000178553
  gflops: 231.968
-----------------------------------
max element torch :      93
max element jit :        93
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "316,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 316
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000688523
  gflops: 60.156
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->316];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->316
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->316
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff923b0000
[DEBUG] GEMM shape: m=256 n=256 k=316 lda=256 ldb=316 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000288052
  time (contract): 0.000505476
  gflops: 81.9401

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "316,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 316
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000913479
  gflops: 45.3417
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->316];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->316
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->316
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96aba000
[DEBUG] GEMM shape: m=256 n=256 k=316 lda=256 ldb=316 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332178
  time (contract): 0.00144124
  gflops: 28.7383

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=318 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "318,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 318
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000405932
  gflops: 102.679
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->318];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->318
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->318
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b7e1000
[DEBUG] GEMM shape: m=256 n=256 k=318 lda=256 ldb=318 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000316531
  time (contract): 0.000325548
  gflops: 128.033
-----------------------------------
max element torch :      96.5
max element jit :        96.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "318,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 318
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000706263
  gflops: 59.0161
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->318];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->318
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->318
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8681f000
[DEBUG] GEMM shape: m=256 n=256 k=318 lda=256 ldb=318 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000341842
  time (contract): 0.000515955
  gflops: 80.784

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "318,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 318
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000916138
  gflops: 45.4963
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->318];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->318
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->318
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1f17000
[DEBUG] GEMM shape: m=256 n=256 k=318 lda=256 ldb=318 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033701
  time (contract): 0.00130027
  gflops: 32.0555

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=320 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "320,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 320
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000401715
  gflops: 104.41
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->320];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->320
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->320
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaa2fc000
[DEBUG] GEMM shape: m=256 n=256 k=320 lda=256 ldb=320 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00032821
  time (contract): 0.000190835
  gflops: 219.787
-----------------------------------
max element torch :      95.5
max element jit :        95.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "320,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 320
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000705321
  gflops: 59.4666
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->320];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->320
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->320
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaefee000
[DEBUG] GEMM shape: m=256 n=256 k=320 lda=256 ldb=320 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000273012
  time (contract): 0.000570633
  gflops: 73.5027

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "320,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 320
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000928458
  gflops: 45.1749
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->320];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->320
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->320
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1dff000
[DEBUG] GEMM shape: m=256 n=256 k=320 lda=256 ldb=320 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328466
  time (contract): 0.00141387
  gflops: 29.6653

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=322 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "322,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 322
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000406821
  gflops: 103.744
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->322];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->322
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->322
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb20ef000
[DEBUG] GEMM shape: m=256 n=256 k=322 lda=256 ldb=322 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00032341
  time (contract): 0.000333377
  gflops: 126.599
-----------------------------------
max element torch :      95.5
max element jit :        95.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "322,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 322
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000698966
  gflops: 60.3823
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->322];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->322
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->322
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c430000
[DEBUG] GEMM shape: m=256 n=256 k=322 lda=256 ldb=322 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000278901
  time (contract): 0.000505547
  gflops: 83.4842

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "322,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 322
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000926749
  gflops: 45.5411
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->322];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->322
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->322
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0093000
[DEBUG] GEMM shape: m=256 n=256 k=322 lda=256 ldb=322 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337907
  time (contract): 0.00126183
  gflops: 33.4477

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=324 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "324,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 324
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000385082
  gflops: 110.281
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->324];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->324
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->324
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d677000
[DEBUG] GEMM shape: m=256 n=256 k=324 lda=256 ldb=324 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000340498
  time (contract): 0.000185776
  gflops: 228.595
-----------------------------------
max element torch :      97.5
max element jit :        97.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "324,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 324
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000707525
  gflops: 60.0223
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->324];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->324
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->324
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4951000
[DEBUG] GEMM shape: m=256 n=256 k=324 lda=256 ldb=324 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000268789
  time (contract): 0.000510372
  gflops: 83.2085

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "324,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 324
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000951876
  gflops: 44.6143
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->324];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->324
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->324
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff93478000
[DEBUG] GEMM shape: m=256 n=256 k=324 lda=256 ldb=324 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000330547
  time (contract): 0.00121841
  gflops: 34.8548

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=326 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "326,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 326
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000408523
  gflops: 104.595
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->326];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->326
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->326
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff878f8000
[DEBUG] GEMM shape: m=256 n=256 k=326 lda=256 ldb=326 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035253
  time (contract): 0.000336399
  gflops: 127.02
-----------------------------------
max element torch :      98
max element jit :        98
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "326,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 326
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000708393
  gflops: 60.3189
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->326];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->326
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->326
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e964000
[DEBUG] GEMM shape: m=256 n=256 k=326 lda=256 ldb=326 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000272565
  time (contract): 0.000583167
  gflops: 73.2714

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "326,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 326
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000955577
  gflops: 44.7159
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->326];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->326
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->326
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad709000
[DEBUG] GEMM shape: m=256 n=256 k=326 lda=256 ldb=326 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029986
  time (contract): 0.00125624
  gflops: 34.0138

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=328 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "328,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 328
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000391849
  gflops: 109.715
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->328];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->328
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->328
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8afa4000
[DEBUG] GEMM shape: m=256 n=256 k=328 lda=256 ldb=328 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000307539
  time (contract): 0.000185972
  gflops: 231.172
-----------------------------------
max element torch :      98.5
max element jit :        98.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "328,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 328
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000723925
  gflops: 59.3868
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->328];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->328
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->328
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb73d1000
[DEBUG] GEMM shape: m=256 n=256 k=328 lda=256 ldb=328 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000223543
  time (contract): 0.000537628
  gflops: 79.9654

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "328,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 328
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000942055
  gflops: 45.636
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->328];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->328
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->328
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff929f0000
[DEBUG] GEMM shape: m=256 n=256 k=328 lda=256 ldb=328 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00030018
  time (contract): 0.00138265
  gflops: 31.0936

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=330 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "330,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 330
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000373299
  gflops: 115.869
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->330];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->330
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->330
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff919a2000
[DEBUG] GEMM shape: m=256 n=256 k=330 lda=256 ldb=330 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343091
  time (contract): 0.000340618
  gflops: 126.986
-----------------------------------
max element torch :      97.5
max element jit :        97.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "330,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 330
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000731212
  gflops: 59.1535
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->330];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->330
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->330
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff815b5000
[DEBUG] GEMM shape: m=256 n=256 k=330 lda=256 ldb=330 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000244566
  time (contract): 0.000538422
  gflops: 80.3343

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "330,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 330
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000967426
  gflops: 44.7102
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->330];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->330
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->330
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80e26000
[DEBUG] GEMM shape: m=256 n=256 k=330 lda=256 ldb=330 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033845
  time (contract): 0.00143938
  gflops: 30.0502

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=332 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "332,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 332
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000379454
  gflops: 114.68
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->332];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->332
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->332
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbabe8000
[DEBUG] GEMM shape: m=256 n=256 k=332 lda=256 ldb=332 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331954
  time (contract): 0.000187417
  gflops: 232.187
-----------------------------------
max element torch :      99
max element jit :        99
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "332,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 332
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000723988
  gflops: 60.1058
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->332];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->332
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->332
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa0dec000
[DEBUG] GEMM shape: m=256 n=256 k=332 lda=256 ldb=332 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000248662
  time (contract): 0.000541823
  gflops: 80.3138

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "332,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 332
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000965749
  gflops: 45.0592
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->332];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->332
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->332
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff943b4000
[DEBUG] GEMM shape: m=256 n=256 k=332 lda=256 ldb=332 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328498
  time (contract): 0.00128796
  gflops: 33.7867

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=334 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "334,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 334
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000387967
  gflops: 112.84
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->334];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->334
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->334
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e5d7000
[DEBUG] GEMM shape: m=256 n=256 k=334 lda=256 ldb=334 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.0003045
  time (contract): 0.000344549
  gflops: 127.059
-----------------------------------
max element torch :      100.5
max element jit :        100.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "334,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 334
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000728911
  gflops: 60.0595
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->334];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->334
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->334
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9bf8a000
[DEBUG] GEMM shape: m=256 n=256 k=334 lda=256 ldb=334 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000261078
  time (contract): 0.000532757
  gflops: 82.1727

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "334,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 334
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000964161
  gflops: 45.4053
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->334];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->334
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->334
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2aea000
[DEBUG] GEMM shape: m=256 n=256 k=334 lda=256 ldb=334 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343698
  time (contract): 0.00155057
  gflops: 28.2335

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=336 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "336,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 336
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000376677
  gflops: 116.918
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->336];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->336
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->336
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8ea67000
[DEBUG] GEMM shape: m=256 n=256 k=336 lda=256 ldb=336 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000281173
  time (contract): 0.000190674
  gflops: 230.971
-----------------------------------
max element torch :      103
max element jit :        103
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "336,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 336
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000740293
  gflops: 59.4902
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->336];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->336
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->336
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa246c000
[DEBUG] GEMM shape: m=256 n=256 k=336 lda=256 ldb=336 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328147
  time (contract): 0.000552572
  gflops: 79.7004

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "336,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 336
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000981464
  gflops: 44.8719
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->336];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->336
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->336
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e3b6000
[DEBUG] GEMM shape: m=256 n=256 k=336 lda=256 ldb=336 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345522
  time (contract): 0.00158396
  gflops: 27.8039

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=338 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "338,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 338
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000383022
  gflops: 115.665
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->338];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->338
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->338
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf0c2000
[DEBUG] GEMM shape: m=256 n=256 k=338 lda=256 ldb=338 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.0002829
  time (contract): 0.000349247
  gflops: 126.851
-----------------------------------
max element torch :      102
max element jit :        102
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "338,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 338
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000712241
  gflops: 62.2014
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->338];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->338
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->338
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8086000
[DEBUG] GEMM shape: m=256 n=256 k=338 lda=256 ldb=338 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000284692
  time (contract): 0.000544082
  gflops: 81.4258

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "338,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 338
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000974941
  gflops: 45.441
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->338];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->338
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->338
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad1dd000
[DEBUG] GEMM shape: m=256 n=256 k=338 lda=256 ldb=338 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000364177
  time (contract): 0.00136585
  gflops: 32.4358

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=340 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "340,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 340
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000403721
  gflops: 110.384
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->340];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->340
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->340
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff85506000
[DEBUG] GEMM shape: m=256 n=256 k=340 lda=256 ldb=340 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000285684
  time (contract): 0.000194827
  gflops: 228.738
-----------------------------------
max element torch :      104.5
max element jit :        104.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "340,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 340
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000718342
  gflops: 62.038
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->340];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->340
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->340
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8604e000
[DEBUG] GEMM shape: m=256 n=256 k=340 lda=256 ldb=340 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000282965
  time (contract): 0.000577603
  gflops: 77.1542

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "340,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 340
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000974828
  gflops: 45.7152
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->340];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->340
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->340
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d659000
[DEBUG] GEMM shape: m=256 n=256 k=340 lda=256 ldb=340 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000363121
  time (contract): 0.00137612
  gflops: 32.3841

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=342 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "342,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 342
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000404123
  gflops: 110.923
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->342];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->342
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->342
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa0e41000
[DEBUG] GEMM shape: m=256 n=256 k=342 lda=256 ldb=342 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000271925
  time (contract): 0.000351015
  gflops: 127.706
-----------------------------------
max element torch :      102
max element jit :        102
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "342,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 342
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000719578
  gflops: 62.2957
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->342];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->342
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->342
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa66ed000
[DEBUG] GEMM shape: m=256 n=256 k=342 lda=256 ldb=342 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000271668
  time (contract): 0.000544661
  gflops: 82.3019

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "342,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 342
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000991645
  gflops: 45.2043
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->342];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->342
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->342
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa55de000
[DEBUG] GEMM shape: m=256 n=256 k=342 lda=256 ldb=342 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000372113
  time (contract): 0.00143603
  gflops: 31.2156

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=344 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "344,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 344
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000379718
  gflops: 118.743
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->344];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->344
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->344
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ef54000
[DEBUG] GEMM shape: m=256 n=256 k=344 lda=256 ldb=344 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033461
  time (contract): 0.000197366
  gflops: 228.452
-----------------------------------
max element torch :      103
max element jit :        103
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "344,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 344
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000728582
  gflops: 61.8857
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->344];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->344
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->344
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff938f1000
[DEBUG] GEMM shape: m=256 n=256 k=344 lda=256 ldb=344 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000284436
  time (contract): 0.000723117
  gflops: 62.3534

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "344,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 344
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.000990111
  gflops: 45.5391
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->344];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->344
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->344
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86058000
[DEBUG] GEMM shape: m=256 n=256 k=344 lda=256 ldb=344 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328851
  time (contract): 0.00160137
  gflops: 28.1564

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=346 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "346,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 346
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000391332
  gflops: 115.889
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->346];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->346
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->346
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9bae000
[DEBUG] GEMM shape: m=256 n=256 k=346 lda=256 ldb=346 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000322867
  time (contract): 0.000358569
  gflops: 126.477
-----------------------------------
max element torch :      101.5
max element jit :        101.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "346,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 346
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000716077
  gflops: 63.3325
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->346];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->346
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->346
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8819000
[DEBUG] GEMM shape: m=256 n=256 k=346 lda=256 ldb=346 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000314355
  time (contract): 0.000553223
  gflops: 81.9759

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "346,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 346
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00101313
  gflops: 44.7631
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->346];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->346
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->346
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab6cd000
[DEBUG] GEMM shape: m=256 n=256 k=346 lda=256 ldb=346 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034853
  time (contract): 0.0016313
  gflops: 27.8005

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=348 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "348,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 348
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00037564
  gflops: 121.428
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->348];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->348
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->348
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7f745000
[DEBUG] GEMM shape: m=256 n=256 k=348 lda=256 ldb=348 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000379569
  time (contract): 0.000197117
  gflops: 231.401
-----------------------------------
max element torch :      104.5
max element jit :        104.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "348,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 348
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000720577
  gflops: 63.3007
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->348];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->348
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->348
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc12c000
[DEBUG] GEMM shape: m=256 n=256 k=348 lda=256 ldb=348 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000266581
  time (contract): 0.000574747
  gflops: 79.362

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "348,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 348
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00101186
  gflops: 45.0784
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->348];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->348
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->348
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84e2c000
[DEBUG] GEMM shape: m=256 n=256 k=348 lda=256 ldb=348 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323859
  time (contract): 0.0017611
  gflops: 25.9003

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=350 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "350,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 350
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000409054
  gflops: 112.149
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->350];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->350
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->350
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97047000
[DEBUG] GEMM shape: m=256 n=256 k=350 lda=256 ldb=350 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000357041
  time (contract): 0.000362408
  gflops: 126.585
-----------------------------------
max element torch :      105.5
max element jit :        105.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "350,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 350
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000740561
  gflops: 61.9466
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->350];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->350
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->350
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4438000
[DEBUG] GEMM shape: m=256 n=256 k=350 lda=256 ldb=350 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000285204
  time (contract): 0.000566747
  gflops: 80.9447

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "350,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 350
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00101357
  gflops: 45.2609
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->350];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->350
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->350
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82122000
[DEBUG] GEMM shape: m=256 n=256 k=350 lda=256 ldb=350 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000342738
  time (contract): 0.00144942
  gflops: 31.6507

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=352 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "352,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 352
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000387256
  gflops: 119.139
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->352];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->352
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->352
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8458c000
[DEBUG] GEMM shape: m=256 n=256 k=352 lda=256 ldb=352 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326611
  time (contract): 0.000201363
  gflops: 229.126
-----------------------------------
max element torch :      107
max element jit :        107
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "352,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 352
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000740855
  gflops: 62.2758
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->352];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->352
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->352
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8832000
[DEBUG] GEMM shape: m=256 n=256 k=352 lda=256 ldb=352 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000278581
  time (contract): 0.000602364
  gflops: 76.5939

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "352,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 352
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00100962
  gflops: 45.6977
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->352];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->352
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->352
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7cc9000
[DEBUG] GEMM shape: m=256 n=256 k=352 lda=256 ldb=352 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033813
  time (contract): 0.00151885
  gflops: 30.3764

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=354 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "354,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 354
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000401477
  gflops: 115.572
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->354];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->354
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->354
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaac2f000
[DEBUG] GEMM shape: m=256 n=256 k=354 lda=256 ldb=354 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305587
  time (contract): 0.000368095
  gflops: 126.053
-----------------------------------
max element torch :      103.5
max element jit :        103.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "354,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 354
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000730715
  gflops: 63.4988
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->354];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->354
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->354
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff85fd6000
[DEBUG] GEMM shape: m=256 n=256 k=354 lda=256 ldb=354 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325522
  time (contract): 0.000613801
  gflops: 75.5937

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "354,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 354
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00101733
  gflops: 45.6091
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->354];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->354
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->354
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff920f6000
[DEBUG] GEMM shape: m=256 n=256 k=354 lda=256 ldb=354 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000359569
  time (contract): 0.00138591
  gflops: 33.4795

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=356 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "356,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 356
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000396983
  gflops: 117.541
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->356];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->356
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->356
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7e57000
[DEBUG] GEMM shape: m=256 n=256 k=356 lda=256 ldb=356 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029634
  time (contract): 0.000204682
  gflops: 227.972
-----------------------------------
max element torch :      105
max element jit :        105
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "356,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 356
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000738903
  gflops: 63.1499
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->356];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->356
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->356
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff914ef000
[DEBUG] GEMM shape: m=256 n=256 k=356 lda=256 ldb=356 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000276117
  time (contract): 0.000604463
  gflops: 77.1952

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "356,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 356
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.0010203
  gflops: 45.7332
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->356];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->356
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->356
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1189000
[DEBUG] GEMM shape: m=256 n=256 k=356 lda=256 ldb=356 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000380113
  time (contract): 0.00155165
  gflops: 30.0723

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=358 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "358,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 358
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000403762
  gflops: 116.216
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->358];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->358
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->358
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9cf6c000
[DEBUG] GEMM shape: m=256 n=256 k=358 lda=256 ldb=358 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000278164
  time (contract): 0.000373424
  gflops: 125.658
-----------------------------------
max element torch :      105.5
max element jit :        105.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "358,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 358
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00075669
  gflops: 62.0119
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->358];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->358
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->358
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86e71000
[DEBUG] GEMM shape: m=256 n=256 k=358 lda=256 ldb=358 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000269109
  time (contract): 0.000608826
  gflops: 77.0725

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "358,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 358
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00102782
  gflops: 45.6537
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->358];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->358
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->358
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9047e000
[DEBUG] GEMM shape: m=256 n=256 k=358 lda=256 ldb=358 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000422799
  time (contract): 0.00171485
  gflops: 27.3633

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=360 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "360,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 360
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000413902
  gflops: 114.003
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->360];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->360
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->360
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9408d000
[DEBUG] GEMM shape: m=256 n=256 k=360 lda=256 ldb=360 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000350834
  time (contract): 0.000207935
  gflops: 226.926
-----------------------------------
max element torch :      108.5
max element jit :        108.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "360,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 360
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000753704
  gflops: 62.6053
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->360];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->360
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->360
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa28ee000
[DEBUG] GEMM shape: m=256 n=256 k=360 lda=256 ldb=360 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000278388
  time (contract): 0.000602165
  gflops: 78.3605

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "360,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 360
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00103403
  gflops: 45.6332
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->360];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->360
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->360
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd3b9000
[DEBUG] GEMM shape: m=256 n=256 k=360 lda=256 ldb=360 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000391408
  time (contract): 0.00156195
  gflops: 30.2096

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=362 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "362,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 362
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00040592
  gflops: 116.89
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->362];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->362
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->362
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffafb69000
[DEBUG] GEMM shape: m=256 n=256 k=362 lda=256 ldb=362 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325843
  time (contract): 0.000377595
  gflops: 125.658
-----------------------------------
max element torch :      106.5
max element jit :        106.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "362,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 362
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000757914
  gflops: 62.6035
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->362];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->362
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->362
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e317000
[DEBUG] GEMM shape: m=256 n=256 k=362 lda=256 ldb=362 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000281429
  time (contract): 0.000572625
  gflops: 82.8606

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "362,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 362
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00103697
  gflops: 45.7565
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->362];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->362
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->362
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa0269000
[DEBUG] GEMM shape: m=256 n=256 k=362 lda=256 ldb=362 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000365905
  time (contract): 0.00161496
  gflops: 29.3803

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=364 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "364,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 364
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000405153
  gflops: 117.758
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->364];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->364
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->364
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8da2000
[DEBUG] GEMM shape: m=256 n=256 k=364 lda=256 ldb=364 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000353169
  time (contract): 0.000210482
  gflops: 226.671
-----------------------------------
max element torch :      110
max element jit :        110
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "364,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 364
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00076766
  gflops: 62.1502
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->364];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->364
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->364
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9358a000
[DEBUG] GEMM shape: m=256 n=256 k=364 lda=256 ldb=364 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00028562
  time (contract): 0.000677485
  gflops: 70.4225

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "364,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 364
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00104449
  gflops: 45.6781
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->364];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->364
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->364
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf2a4000
[DEBUG] GEMM shape: m=256 n=256 k=364 lda=256 ldb=364 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035205
  time (contract): 0.00166971
  gflops: 28.5739

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=366 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "366,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 366
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000413799
  gflops: 115.932
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->366];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->366
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->366
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba3e1000
[DEBUG] GEMM shape: m=256 n=256 k=366 lda=256 ldb=366 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327923
  time (contract): 0.000383308
  gflops: 125.153
-----------------------------------
max element torch :      108
max element jit :        108
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "366,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 366
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00077974
  gflops: 61.5235
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->366];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->366
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->366
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa2bd1000
[DEBUG] GEMM shape: m=256 n=256 k=366 lda=256 ldb=366 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000282612
  time (contract): 0.000616451
  gflops: 77.8203

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "366,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 366
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00105184
  gflops: 45.6081
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->366];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->366
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->366
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81415000
[DEBUG] GEMM shape: m=256 n=256 k=366 lda=256 ldb=366 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327698
  time (contract): 0.0015683
  gflops: 30.5887

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=368 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "368,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 368
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000413396
  gflops: 116.679
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->368];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->368
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->368
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91618000
[DEBUG] GEMM shape: m=256 n=256 k=368 lda=256 ldb=368 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000378577
  time (contract): 0.00021544
  gflops: 223.889
-----------------------------------
max element torch :      107
max element jit :        107
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "368,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 368
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000769759
  gflops: 62.6618
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->368];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->368
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->368
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaebaf000
[DEBUG] GEMM shape: m=256 n=256 k=368 lda=256 ldb=368 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00028162
  time (contract): 0.000591083
  gflops: 81.6036

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "368,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 368
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00105567
  gflops: 45.6907
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->368];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->368
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->368
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff898a9000
[DEBUG] GEMM shape: m=256 n=256 k=368 lda=256 ldb=368 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329139
  time (contract): 0.00166097
  gflops: 29.04

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=370 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "370,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 370
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00041428
  gflops: 117.062
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->370];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->370
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->370
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf87c000
[DEBUG] GEMM shape: m=256 n=256 k=370 lda=256 ldb=370 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306675
  time (contract): 0.000387966
  gflops: 125.002
-----------------------------------
max element torch :      109
max element jit :        109
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "370,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 370
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000784566
  gflops: 61.8133
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->370];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->370
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->370
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1ca2000
[DEBUG] GEMM shape: m=256 n=256 k=370 lda=256 ldb=370 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306388
  time (contract): 0.000627643
  gflops: 77.2679

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "370,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 370
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00105833
  gflops: 45.8238
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->370];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->370
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->370
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa27d4000
[DEBUG] GEMM shape: m=256 n=256 k=370 lda=256 ldb=370 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000319859
  time (contract): 0.00180125
  gflops: 26.9239

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=372 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "372,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 372
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000417552
  gflops: 116.773
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->372];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->372
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->372
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8f8c8000
[DEBUG] GEMM shape: m=256 n=256 k=372 lda=256 ldb=372 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329971
  time (contract): 0.000215554
  gflops: 226.202
-----------------------------------
max element torch :      110.5
max element jit :        110.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "372,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 372
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000784266
  gflops: 62.1712
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->372];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->372
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->372
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e6fc000
[DEBUG] GEMM shape: m=256 n=256 k=372 lda=256 ldb=372 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329907
  time (contract): 0.000596093
  gflops: 81.7972

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "372,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 372
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.001062
  gflops: 45.9122
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->372];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->372
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->372
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb922f000
[DEBUG] GEMM shape: m=256 n=256 k=372 lda=256 ldb=372 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000314963
  time (contract): 0.00152251
  gflops: 32.0252

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=374 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "374,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 374
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00041554
  gflops: 117.969
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->374];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->374
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->374
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81f25000
[DEBUG] GEMM shape: m=256 n=256 k=374 lda=256 ldb=374 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000321715
  time (contract): 0.000390811
  gflops: 125.434
-----------------------------------
max element torch :      110
max element jit :        110
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "374,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 374
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00079926
  gflops: 61.3329
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->374];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->374
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->374
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff864b9000
[DEBUG] GEMM shape: m=256 n=256 k=374 lda=256 ldb=374 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329554
  time (contract): 0.000594148
  gflops: 82.5062

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "374,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 374
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00107007
  gflops: 45.8108
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->374];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->374
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->374
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0e50000
[DEBUG] GEMM shape: m=256 n=256 k=374 lda=256 ldb=374 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335058
  time (contract): 0.00184624
  gflops: 26.5517

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=376 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "376,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 376
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000427732
  gflops: 115.22
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->376];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->376
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->376
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff961d6000
[DEBUG] GEMM shape: m=256 n=256 k=376 lda=256 ldb=376 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000297459
  time (contract): 0.00022042
  gflops: 223.587
-----------------------------------
max element torch :      116.5
max element jit :        116.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "376,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 376
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000799735
  gflops: 61.6243
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->376];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->376
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->376
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87e32000
[DEBUG] GEMM shape: m=256 n=256 k=376 lda=256 ldb=376 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000259958
  time (contract): 0.00060385
  gflops: 81.6147

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "376,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 376
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00107612
  gflops: 45.797
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->376];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->376
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->376
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8dd66000
[DEBUG] GEMM shape: m=256 n=256 k=376 lda=256 ldb=376 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354193
  time (contract): 0.0016111
  gflops: 30.5897

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=378 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "378,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 378
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000424562
  gflops: 116.697
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->378];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->378
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->378
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffadcc4000
[DEBUG] GEMM shape: m=256 n=256 k=378 lda=256 ldb=378 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000271061
  time (contract): 0.00039347
  gflops: 125.919
-----------------------------------
max element torch :      111.5
max element jit :        111.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "378,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 378
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000799098
  gflops: 62.0014
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->378];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->378
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->378
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7fe36000
[DEBUG] GEMM shape: m=256 n=256 k=378 lda=256 ldb=378 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000282644
  time (contract): 0.000595213
  gflops: 83.2395

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "378,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 378
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00108911
  gflops: 45.4916
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->378];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->378
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->378
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8aa41000
[DEBUG] GEMM shape: m=256 n=256 k=378 lda=256 ldb=378 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000387888
  time (contract): 0.00163221
  gflops: 30.3547

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=380 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "380,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 380
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000427977
  gflops: 116.378
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->380];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->380
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->380
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b650000
[DEBUG] GEMM shape: m=256 n=256 k=380 lda=256 ldb=380 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000309107
  time (contract): 0.000217767
  gflops: 228.718
-----------------------------------
max element torch :      113
max element jit :        113
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "380,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 380
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00078739
  gflops: 63.2563
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->380];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->380
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->380
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff93997000
[DEBUG] GEMM shape: m=256 n=256 k=380 lda=256 ldb=380 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00024463
  time (contract): 0.000655281
  gflops: 76.0092

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "380,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 380
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00108649
  gflops: 45.8424
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->380];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->380
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->380
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8115e000
[DEBUG] GEMM shape: m=256 n=256 k=380 lda=256 ldb=380 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000367345
  time (contract): 0.00167916
  gflops: 29.6621

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=382 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "382,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 382
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000425878
  gflops: 117.568
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->382];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->382
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->382
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb810b000
[DEBUG] GEMM shape: m=256 n=256 k=382 lda=256 ldb=382 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029394
  time (contract): 0.000399577
  gflops: 125.306
-----------------------------------
max element torch :      112.5
max element jit :        112.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "382,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 382
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000813096
  gflops: 61.5789
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->382];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->382
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->382
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8be1c000
[DEBUG] GEMM shape: m=256 n=256 k=382 lda=256 ldb=382 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000286996
  time (contract): 0.000630656
  gflops: 79.3927

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "382,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 382
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00109835
  gflops: 45.5862
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->382];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->382
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->382
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5e0d000
[DEBUG] GEMM shape: m=256 n=256 k=382 lda=256 ldb=382 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034741
  time (contract): 0.00171571
  gflops: 29.1829

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=384 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "384,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 384
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000440612
  gflops: 114.231
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->384];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->384
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->384
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa0fae000
[DEBUG] GEMM shape: m=256 n=256 k=384 lda=256 ldb=384 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000366449
  time (contract): 0.0002351
  gflops: 214.086
-----------------------------------
max element torch :      112
max element jit :        112
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "384,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 384
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00083006
  gflops: 60.6361
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->384];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->384
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->384
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbb826000
[DEBUG] GEMM shape: m=256 n=256 k=384 lda=256 ldb=384 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323731
  time (contract): 0.000664947
  gflops: 75.6927

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "384,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 384
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00109793
  gflops: 45.8422
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->384];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->384
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->384
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa65a4000
[DEBUG] GEMM shape: m=256 n=256 k=384 lda=256 ldb=384 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00032437
  time (contract): 0.00194683
  gflops: 25.8532

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=386 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "386,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 386
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000428514
  gflops: 118.068
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->386];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->386
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->386
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa6d4a000
[DEBUG] GEMM shape: m=256 n=256 k=386 lda=256 ldb=386 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000321714
  time (contract): 0.000405405
  gflops: 124.798
-----------------------------------
max element torch :      116
max element jit :        116
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "386,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 386
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000821671
  gflops: 61.5743
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->386];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->386
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->386
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb3cf2000
[DEBUG] GEMM shape: m=256 n=256 k=386 lda=256 ldb=386 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000295476
  time (contract): 0.000614676
  gflops: 82.3097

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "386,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 386
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00110365
  gflops: 45.8421
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->386];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->386
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->386
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9462f000
[DEBUG] GEMM shape: m=256 n=256 k=386 lda=256 ldb=386 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331507
  time (contract): 0.00170667
  gflops: 29.6448

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=388 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "388,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 388
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000445115
  gflops: 114.254
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->388];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->388
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->388
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffacc03000
[DEBUG] GEMM shape: m=256 n=256 k=388 lda=256 ldb=388 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000351858
  time (contract): 0.000222436
  gflops: 228.632
-----------------------------------
max element torch :      117
max element jit :        117
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "388,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 388
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000814961
  gflops: 62.4029
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->388];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->388
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->388
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb887d000
[DEBUG] GEMM shape: m=256 n=256 k=388 lda=256 ldb=388 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000294932
  time (contract): 0.000625505
  gflops: 81.3038

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "388,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 388
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00111639
  gflops: 45.5539
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->388];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->388
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->388
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3f46000
[DEBUG] GEMM shape: m=256 n=256 k=388 lda=256 ldb=388 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332722
  time (contract): 0.00182255
  gflops: 27.9038

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=390 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "390,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 390
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000430517
  gflops: 118.737
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->390];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->390
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->390
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ffc6000
[DEBUG] GEMM shape: m=256 n=256 k=390 lda=256 ldb=390 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035061
  time (contract): 0.000405123
  gflops: 126.179
-----------------------------------
max element torch :      118.5
max element jit :        118.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "390,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 390
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000844496
  gflops: 60.5309
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->390];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->390
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->390
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89a06000
[DEBUG] GEMM shape: m=256 n=256 k=390 lda=256 ldb=390 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000304243
  time (contract): 0.000648366
  gflops: 78.8414

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "390,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 390
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00112105
  gflops: 45.5983
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->390];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->390
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->390
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbebbb000
[DEBUG] GEMM shape: m=256 n=256 k=390 lda=256 ldb=390 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000326322
  time (contract): 0.00160888
  gflops: 31.7725

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=392 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "392,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 392
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000456485
  gflops: 112.556
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->392];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->392
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->392
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7fb8a000
[DEBUG] GEMM shape: m=256 n=256 k=392 lda=256 ldb=392 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320115
  time (contract): 0.000227591
  gflops: 225.757
-----------------------------------
max element torch :      115.5
max element jit :        115.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "392,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 392
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000826954
  gflops: 62.1319
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->392];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->392
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->392
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba46a000
[DEBUG] GEMM shape: m=256 n=256 k=392 lda=256 ldb=392 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000259318
  time (contract): 0.000640925
  gflops: 80.1657

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "392,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 392
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00112065
  gflops: 45.8488
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->392];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->392
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->392
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92751000
[DEBUG] GEMM shape: m=256 n=256 k=392 lda=256 ldb=392 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000373521
  time (contract): 0.001681
  gflops: 30.5652

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=394 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "394,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 394
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00043861
  gflops: 117.741
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->394];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->394
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->394
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b2f5000
[DEBUG] GEMM shape: m=256 n=256 k=394 lda=256 ldb=394 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000277205
  time (contract): 0.000413349
  gflops: 124.936
-----------------------------------
max element torch :      117
max element jit :        117
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "394,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 394
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000826092
  gflops: 62.514
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->394];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->394
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->394
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa812f000
[DEBUG] GEMM shape: m=256 n=256 k=394 lda=256 ldb=394 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000250678
  time (contract): 0.000655502
  gflops: 78.7829

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "394,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 394
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00112441
  gflops: 45.9286
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->394];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->394
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->394
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb21a1000
[DEBUG] GEMM shape: m=256 n=256 k=394 lda=256 ldb=394 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000361329
  time (contract): 0.0017514
  gflops: 29.4864

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=396 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "396,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 396
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00045785
  gflops: 113.366
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->396];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->396
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->396
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff965c7000
[DEBUG] GEMM shape: m=256 n=256 k=396 lda=256 ldb=396 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000278741
  time (contract): 0.000228572
  gflops: 227.081
-----------------------------------
max element torch :      115.5
max element jit :        115.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "396,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 396
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000825104
  gflops: 62.9066
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->396];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->396
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->396
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b738000
[DEBUG] GEMM shape: m=256 n=256 k=396 lda=256 ldb=396 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000278229
  time (contract): 0.000632747
  gflops: 82.0305

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "396,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 396
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00113941
  gflops: 45.5538
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->396];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->396
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->396
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9763c000
[DEBUG] GEMM shape: m=256 n=256 k=396 lda=256 ldb=396 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000380784
  time (contract): 0.00170838
  gflops: 30.3823

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=398 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "398,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 398
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000443759
  gflops: 117.556
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->398];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->398
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->398
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa6c0d000
[DEBUG] GEMM shape: m=256 n=256 k=398 lda=256 ldb=398 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305683
  time (contract): 0.000415865
  gflops: 125.441
-----------------------------------
max element torch :      119
max element jit :        119
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "398,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 398
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000851482
  gflops: 61.2657
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->398];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->398
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->398
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8565000
[DEBUG] GEMM shape: m=256 n=256 k=398 lda=256 ldb=398 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00030562
  time (contract): 0.000683267
  gflops: 76.3489

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "398,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 398
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00114159
  gflops: 45.6966
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->398];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->398
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->398
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b62e000
[DEBUG] GEMM shape: m=256 n=256 k=398 lda=256 ldb=398 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000371473
  time (contract): 0.00175183
  gflops: 29.7784

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=400 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "400,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 400
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000461627
  gflops: 113.574
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->400];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->400
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->400
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2adc000
[DEBUG] GEMM shape: m=256 n=256 k=400 lda=256 ldb=400 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000292948
  time (contract): 0.000233012
  gflops: 225.005
-----------------------------------
max element torch :      118.5
max element jit :        118.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "400,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 400
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000851317
  gflops: 61.5855
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->400];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->400
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->400
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb10ed000
[DEBUG] GEMM shape: m=256 n=256 k=400 lda=256 ldb=400 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029282
  time (contract): 0.000657379
  gflops: 79.7543

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "400,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 400
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.0011463
  gflops: 45.7374
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->400];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->400
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->400
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9be78000
[DEBUG] GEMM shape: m=256 n=256 k=400 lda=256 ldb=400 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000366449
  time (contract): 0.00199889
  gflops: 26.2289

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=402 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "402,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 402
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000445655
  gflops: 118.233
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->402];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->402
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->402
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff866b0000
[DEBUG] GEMM shape: m=256 n=256 k=402 lda=256 ldb=402 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000352337
  time (contract): 0.000418534
  gflops: 125.894
-----------------------------------
max element torch :      118
max element jit :        118
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "402,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 402
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000848512
  gflops: 62.098
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->402];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->402
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->402
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a429000
[DEBUG] GEMM shape: m=256 n=256 k=402 lda=256 ldb=402 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000285812
  time (contract): 0.00064927
  gflops: 81.1541

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "402,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 402
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00115474
  gflops: 45.6303
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->402];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->402
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->402
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9fea000
[DEBUG] GEMM shape: m=256 n=256 k=402 lda=256 ldb=402 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000365393
  time (contract): 0.00184583
  gflops: 28.5459

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=404 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "404,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 404
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000476433
  gflops: 111.145
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->404];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->404
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->404
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81aeb000
[DEBUG] GEMM shape: m=256 n=256 k=404 lda=256 ldb=404 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354001
  time (contract): 0.000233547
  gflops: 226.734
-----------------------------------
max element torch :      121
max element jit :        121
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "404,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 404
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00084954
  gflops: 62.3315
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->404];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->404
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->404
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab364000
[DEBUG] GEMM shape: m=256 n=256 k=404 lda=256 ldb=404 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000295924
  time (contract): 0.000660008
  gflops: 80.231

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "404,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 404
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00115605
  gflops: 45.805
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->404];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->404
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->404
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbe83e000
[DEBUG] GEMM shape: m=256 n=256 k=404 lda=256 ldb=404 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000365073
  time (contract): 0.0018439
  gflops: 28.7181

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=406 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "406,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 406
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000449934
  gflops: 118.273
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->406];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->406
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->406
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb6178000
[DEBUG] GEMM shape: m=256 n=256 k=406 lda=256 ldb=406 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000360465
  time (contract): 0.000424252
  gflops: 125.433
-----------------------------------
max element torch :      119.5
max element jit :        119.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "406,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 406
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00085805
  gflops: 62.0188
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->406];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->406
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->406
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96726000
[DEBUG] GEMM shape: m=256 n=256 k=406 lda=256 ldb=406 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000295092
  time (contract): 0.00066209
  gflops: 80.3746

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "406,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 406
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00116542
  gflops: 45.662
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->406];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->406
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->406
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9379c000
[DEBUG] GEMM shape: m=256 n=256 k=406 lda=256 ldb=406 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348978
  time (contract): 0.00202459
  gflops: 26.2844

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=408 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "408,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 408
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000467028
  gflops: 114.506
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->408];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->408
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->408
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4645000
[DEBUG] GEMM shape: m=256 n=256 k=408 lda=256 ldb=408 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331602
  time (contract): 0.00023577
  gflops: 226.82
-----------------------------------
max element torch :      120.5
max element jit :        120.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "408,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 408
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000870495
  gflops: 61.4333
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->408];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->408
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->408
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaca72000
[DEBUG] GEMM shape: m=256 n=256 k=408 lda=256 ldb=408 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000302515
  time (contract): 0.0006529
  gflops: 81.9074

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "408,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 408
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00116551
  gflops: 45.8832
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->408];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->408
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->408
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa4b06000
[DEBUG] GEMM shape: m=256 n=256 k=408 lda=256 ldb=408 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000336722
  time (contract): 0.00205476
  gflops: 26.0261

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=410 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "410,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 410
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000458678
  gflops: 117.162
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->410];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->410
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->410
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3c72000
[DEBUG] GEMM shape: m=256 n=256 k=410 lda=256 ldb=410 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333394
  time (contract): 0.000429081
  gflops: 125.243
-----------------------------------
max element torch :      120
max element jit :        120
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "410,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 410
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000875454
  gflops: 61.3847
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->410];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->410
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->410
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9dfb9000
[DEBUG] GEMM shape: m=256 n=256 k=410 lda=256 ldb=410 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000290932
  time (contract): 0.000657028
  gflops: 81.7919

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "410,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 410
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00118241
  gflops: 45.449
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->410];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->410
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->410
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9cd96000
[DEBUG] GEMM shape: m=256 n=256 k=410 lda=256 ldb=410 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034117
  time (contract): 0.00178904
  gflops: 30.0382

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=412 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "412,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 412
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000473566
  gflops: 114.032
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->412];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->412
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->412
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa4503000
[DEBUG] GEMM shape: m=256 n=256 k=412 lda=256 ldb=412 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337394
  time (contract): 0.000237648
  gflops: 227.234
-----------------------------------
max element torch :      121
max element jit :        121
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "412,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 412
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000869537
  gflops: 62.1039
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->412];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->412
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->412
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaa915000
[DEBUG] GEMM shape: m=256 n=256 k=412 lda=256 ldb=412 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327891
  time (contract): 0.000708411
  gflops: 76.2293

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "412,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 412
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00118291
  gflops: 45.6514
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->412];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->412
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->412
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad5b5000
[DEBUG] GEMM shape: m=256 n=256 k=412 lda=256 ldb=412 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345522
  time (contract): 0.00191292
  gflops: 28.23

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=414 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "414,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 414
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000459909
  gflops: 117.988
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->414];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->414
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->414
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f4f8000
[DEBUG] GEMM shape: m=256 n=256 k=414 lda=256 ldb=414 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000317203
  time (contract): 0.000428416
  gflops: 126.662
-----------------------------------
max element torch :      122.5
max element jit :        122.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "414,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 414
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000882608
  gflops: 61.4812
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->414];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->414
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->414
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80384000
[DEBUG] GEMM shape: m=256 n=256 k=414 lda=256 ldb=414 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306579
  time (contract): 0.000713625
  gflops: 76.0397

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "414,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 414
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00119558
  gflops: 45.387
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->414];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->414
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->414
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7a79000
[DEBUG] GEMM shape: m=256 n=256 k=414 lda=256 ldb=414 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000381584
  time (contract): 0.00191175
  gflops: 28.3843

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=416 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "416,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 416
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000478366
  gflops: 113.984
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->416];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->416
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->416
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffadfc6000
[DEBUG] GEMM shape: m=256 n=256 k=416 lda=256 ldb=416 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000288148
  time (contract): 0.000247682
  gflops: 220.145
-----------------------------------
max element torch :      125.5
max element jit :        125.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "416,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 416
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000883292
  gflops: 61.7304
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->416];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->416
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->416
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96cc6000
[DEBUG] GEMM shape: m=256 n=256 k=416 lda=256 ldb=416 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000294388
  time (contract): 0.000790844
  gflops: 68.9465

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "416,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 416
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00119281
  gflops: 45.712
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->416];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->416
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->416
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88122000
[DEBUG] GEMM shape: m=256 n=256 k=416 lda=256 ldb=416 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000367569
  time (contract): 0.00215041
  gflops: 25.3561

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=418 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "418,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 418
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000481871
  gflops: 113.699
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->418];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->418
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->418
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab7cf000
[DEBUG] GEMM shape: m=256 n=256 k=418 lda=256 ldb=418 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000287348
  time (contract): 0.00043521
  gflops: 125.889
-----------------------------------
max element torch :      123.5
max element jit :        123.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "418,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 418
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000888394
  gflops: 61.6709
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->418];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->418
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->418
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff832e5000
[DEBUG] GEMM shape: m=256 n=256 k=418 lda=256 ldb=418 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000295316
  time (contract): 0.000682408
  gflops: 80.2864

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "418,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 418
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00120096
  gflops: 45.6204
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->418];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->418
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->418
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa06d1000
[DEBUG] GEMM shape: m=256 n=256 k=418 lda=256 ldb=418 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000371185
  time (contract): 0.00187693
  gflops: 29.1902

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=420 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "420,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 420
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000478022
  gflops: 115.163
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->420];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->420
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->420
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc52f000
[DEBUG] GEMM shape: m=256 n=256 k=420 lda=256 ldb=420 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000299188
  time (contract): 0.000241948
  gflops: 227.53
-----------------------------------
max element torch :      122
max element jit :        122
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "420,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 420
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000879887
  gflops: 62.5651
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->420];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->420
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->420
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab260000
[DEBUG] GEMM shape: m=256 n=256 k=420 lda=256 ldb=420 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000276212
  time (contract): 0.000674152
  gflops: 81.6585

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "420,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 420
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00119921
  gflops: 45.9053
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->420];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->420
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->420
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb19ee000
[DEBUG] GEMM shape: m=256 n=256 k=420 lda=256 ldb=420 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000397743
  time (contract): 0.00195813
  gflops: 28.1137

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=422 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "422,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 422
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000482122
  gflops: 114.727
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->422];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->422
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->422
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa0c47000
[DEBUG] GEMM shape: m=256 n=256 k=422 lda=256 ldb=422 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00028818
  time (contract): 0.000440752
  gflops: 125.496
-----------------------------------
max element torch :      122
max element jit :        122
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "422,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 422
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00088952
  gflops: 62.1823
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->422];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->422
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->422
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2350000
[DEBUG] GEMM shape: m=256 n=256 k=422 lda=256 ldb=422 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000283732
  time (contract): 0.000677477
  gflops: 81.6447

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "422,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 422
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00120769
  gflops: 45.8002
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->422];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->422
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->422
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84ad2000
[DEBUG] GEMM shape: m=256 n=256 k=422 lda=256 ldb=422 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000366417
  time (contract): 0.00194638
  gflops: 28.4181

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=424 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "424,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 424
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000487669
  gflops: 113.959
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->424];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->424
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->424
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb879d000
[DEBUG] GEMM shape: m=256 n=256 k=424 lda=256 ldb=424 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354353
  time (contract): 0.000245617
  gflops: 226.265
-----------------------------------
max element torch :      126
max element jit :        126
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "424,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 424
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000901846
  gflops: 61.6231
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->424];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->424
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->424
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbece5000
[DEBUG] GEMM shape: m=256 n=256 k=424 lda=256 ldb=424 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000307188
  time (contract): 0.000780481
  gflops: 71.2055

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "424,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 424
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00121148
  gflops: 45.8734
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->424];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->424
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->424
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7fe8d000
[DEBUG] GEMM shape: m=256 n=256 k=424 lda=256 ldb=424 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000366609
  time (contract): 0.00201853
  gflops: 27.5322

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=426 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "426,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 426
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000482455
  gflops: 115.734
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->426];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->426
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->426
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9de12000
[DEBUG] GEMM shape: m=256 n=256 k=426 lda=256 ldb=426 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332755
  time (contract): 0.000444483
  gflops: 125.622
-----------------------------------
max element torch :      125
max element jit :        125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "426,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 426
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000899448
  gflops: 62.0788
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->426];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->426
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->426
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4365000
[DEBUG] GEMM shape: m=256 n=256 k=426 lda=256 ldb=426 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000281397
  time (contract): 0.000720023
  gflops: 77.5484

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "426,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 426
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00121673
  gflops: 45.8908
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->426];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->426
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->426
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7ff1a000
[DEBUG] GEMM shape: m=256 n=256 k=426 lda=256 ldb=426 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000382801
  time (contract): 0.00194362
  gflops: 28.7282

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=428 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "428,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 428
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000493941
  gflops: 113.574
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->428];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->428
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->428
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4667000
[DEBUG] GEMM shape: m=256 n=256 k=428 lda=256 ldb=428 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000353298
  time (contract): 0.000249626
  gflops: 224.732
-----------------------------------
max element torch :      125
max element jit :        125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "428,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 428
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00089757
  gflops: 62.5008
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->428];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->428
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->428
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ff1e000
[DEBUG] GEMM shape: m=256 n=256 k=428 lda=256 ldb=428 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000293044
  time (contract): 0.000726219
  gflops: 77.2478

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "428,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 428
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00122415
  gflops: 45.8266
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->428];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->428
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->428
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaa41e000
[DEBUG] GEMM shape: m=256 n=256 k=428 lda=256 ldb=428 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000361233
  time (contract): 0.0019666
  gflops: 28.5258

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=430 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "430,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 430
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00049463
  gflops: 113.946
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->430];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->430
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->430
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99077000
[DEBUG] GEMM shape: m=256 n=256 k=430 lda=256 ldb=430 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306196
  time (contract): 0.000447323
  gflops: 125.996
-----------------------------------
max element torch :      129
max element jit :        129
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "430,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 430
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000906824
  gflops: 62.152
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->430];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->430
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->430
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b5a1000
[DEBUG] GEMM shape: m=256 n=256 k=430 lda=256 ldb=430 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000304084
  time (contract): 0.000757206
  gflops: 74.4328

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "430,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 430
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00124004
  gflops: 45.451
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->430];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->430
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->430
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd9a0000
[DEBUG] GEMM shape: m=256 n=256 k=430 lda=256 ldb=430 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000371057
  time (contract): 0.00194692
  gflops: 28.9488

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=432 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "432,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 432
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000515766
  gflops: 109.784
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->432];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->432
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->432
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9031f000
[DEBUG] GEMM shape: m=256 n=256 k=432 lda=256 ldb=432 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335378
  time (contract): 0.000255009
  gflops: 222.044
-----------------------------------
max element torch :      126
max element jit :        126
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "432,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 432
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000911005
  gflops: 62.1545
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->432];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->432
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->432
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8a46a000
[DEBUG] GEMM shape: m=256 n=256 k=432 lda=256 ldb=432 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000312116
  time (contract): 0.000839798
  gflops: 67.4247

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "432,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 432
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.0012357
  gflops: 45.8225
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->432];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->432
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->432
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa05a2000
[DEBUG] GEMM shape: m=256 n=256 k=432 lda=256 ldb=432 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000316979
  time (contract): 0.00210076
  gflops: 26.9536

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=434 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "434,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 434
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000499632
  gflops: 113.854
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->434];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->434
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->434
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffae71c000
[DEBUG] GEMM shape: m=256 n=256 k=434 lda=256 ldb=434 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000339826
  time (contract): 0.000452461
  gflops: 125.724
-----------------------------------
max element torch :      124.5
max element jit :        124.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "434,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 434
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000911098
  gflops: 62.4359
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->434];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->434
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->434
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c7a2000
[DEBUG] GEMM shape: m=256 n=256 k=434 lda=256 ldb=434 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305652
  time (contract): 0.000700145
  gflops: 81.2479

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "434,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 434
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00124693
  gflops: 45.6201
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->434];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->434
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->434
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86cbe000
[DEBUG] GEMM shape: m=256 n=256 k=434 lda=256 ldb=434 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320179
  time (contract): 0.00193039
  gflops: 29.4682

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=436 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "436,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 436
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000518346
  gflops: 110.25
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->436];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->436
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->436
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9119000
[DEBUG] GEMM shape: m=256 n=256 k=436 lda=256 ldb=436 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343922
  time (contract): 0.000252071
  gflops: 226.712
-----------------------------------
max element torch :      126
max element jit :        126
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "436,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 436
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000915104
  gflops: 62.449
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->436];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->436
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->436
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5eeb000
[DEBUG] GEMM shape: m=256 n=256 k=436 lda=256 ldb=436 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305012
  time (contract): 0.000712805
  gflops: 80.1725

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "436,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 436
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.0012428
  gflops: 45.9828
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->436];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->436
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->436
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf331000
[DEBUG] GEMM shape: m=256 n=256 k=436 lda=256 ldb=436 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323987
  time (contract): 0.00195422
  gflops: 29.2431

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=438 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "438,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 438
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000507876
  gflops: 113.039
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->438];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->438
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->438
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7ff58000
[DEBUG] GEMM shape: m=256 n=256 k=438 lda=256 ldb=438 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327186
  time (contract): 0.000460524
  gflops: 124.661
-----------------------------------
max element torch :      129
max element jit :        129
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "438,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 438
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000928068
  gflops: 61.8592
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->438];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->438
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->438
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92889000
[DEBUG] GEMM shape: m=256 n=256 k=438 lda=256 ldb=438 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029426
  time (contract): 0.00071571
  gflops: 80.2134

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "438,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 438
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00125279
  gflops: 45.8252
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->438];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->438
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->438
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b9cf000
[DEBUG] GEMM shape: m=256 n=256 k=438 lda=256 ldb=438 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325682
  time (contract): 0.00203204
  gflops: 28.2522

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=440 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "440,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 440
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000520217
  gflops: 110.861
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->440];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->440
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->440
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf223000
[DEBUG] GEMM shape: m=256 n=256 k=440 lda=256 ldb=440 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000340114
  time (contract): 0.000257785
  gflops: 223.72
-----------------------------------
max element torch :      129
max element jit :        129
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "440,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 440
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000927631
  gflops: 62.1709
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->440];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->440
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->440
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa087c000
[DEBUG] GEMM shape: m=256 n=256 k=440 lda=256 ldb=440 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000260597
  time (contract): 0.000709426
  gflops: 81.2934

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "440,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 440
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00125996
  gflops: 45.7727
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->440];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->440
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->440
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf81e000
[DEBUG] GEMM shape: m=256 n=256 k=440 lda=256 ldb=440 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000363569
  time (contract): 0.00200231
  gflops: 28.8025

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=442 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "442,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 442
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000517672
  gflops: 111.912
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->442];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->442
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->442
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf601000
[DEBUG] GEMM shape: m=256 n=256 k=442 lda=256 ldb=442 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327443
  time (contract): 0.000467456
  gflops: 123.934
-----------------------------------
max element torch :      129
max element jit :        129
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "442,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 442
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00093475
  gflops: 61.9779
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->442];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->442
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->442
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ec34000
[DEBUG] GEMM shape: m=256 n=256 k=442 lda=256 ldb=442 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000255062
  time (contract): 0.000760348
  gflops: 76.1938

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "442,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 442
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00126223
  gflops: 45.8981
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->442];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->442
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->442
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e3b6000
[DEBUG] GEMM shape: m=256 n=256 k=442 lda=256 ldb=442 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000367121
  time (contract): 0.00201
  gflops: 28.8228

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=444 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "444,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 444
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000524199
  gflops: 111.019
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->444];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->444
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->444
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91ec7000
[DEBUG] GEMM shape: m=256 n=256 k=444 lda=256 ldb=444 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000292021
  time (contract): 0.000260711
  gflops: 223.22
-----------------------------------
max element torch :      130
max element jit :        130
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "444,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 444
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000938332
  gflops: 62.0207
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->444];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->444
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->444
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9962c000
[DEBUG] GEMM shape: m=256 n=256 k=444 lda=256 ldb=444 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000240886
  time (contract): 0.000719723
  gflops: 80.8589

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "444,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 444
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00127599
  gflops: 45.6086
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->444];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->444
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->444
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8bbf6000
[DEBUG] GEMM shape: m=256 n=256 k=444 lda=256 ldb=444 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034389
  time (contract): 0.0020275
  gflops: 28.7033

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=446 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "446,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 446
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000511287
  gflops: 114.335
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->446];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->446
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->446
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff83a3c000
[DEBUG] GEMM shape: m=256 n=256 k=446 lda=256 ldb=446 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000284949
  time (contract): 0.000467872
  gflops: 124.945
-----------------------------------
max element torch :      130
max element jit :        130
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "446,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 446
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000931701
  gflops: 62.7434
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->446];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->446
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->446
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbeb56000
[DEBUG] GEMM shape: m=256 n=256 k=446 lda=256 ldb=446 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000234871
  time (contract): 0.000735274
  gflops: 79.5053

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "446,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 446
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00127023
  gflops: 46.0218
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->446];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->446
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->446
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87ea2000
[DEBUG] GEMM shape: m=256 n=256 k=446 lda=256 ldb=446 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000350418
  time (contract): 0.00201263
  gflops: 29.0457

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=448 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "448,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 448
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000498049
  gflops: 117.901
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->448];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->448
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->448
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffadf70000
[DEBUG] GEMM shape: m=256 n=256 k=448 lda=256 ldb=448 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000350002
  time (contract): 0.000279962
  gflops: 209.744
-----------------------------------
max element torch :      130
max element jit :        130
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "448,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 448
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000946112
  gflops: 62.0648
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->448];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->448
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->448
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8894000
[DEBUG] GEMM shape: m=256 n=256 k=448 lda=256 ldb=448 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000280277
  time (contract): 0.000804529
  gflops: 72.9872

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "448,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 448
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00127339
  gflops: 46.1134
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->448];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->448
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->448
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba4aa000
[DEBUG] GEMM shape: m=256 n=256 k=448 lda=256 ldb=448 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000364401
  time (contract): 0.00215233
  gflops: 27.2822

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=450 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "450,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 450
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000525067
  gflops: 112.333
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->450];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->450
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->450
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8ddcc000
[DEBUG] GEMM shape: m=256 n=256 k=450 lda=256 ldb=450 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335058
  time (contract): 0.000472271
  gflops: 124.891
-----------------------------------
max element torch :      132
max element jit :        132
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "450,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 450
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000954914
  gflops: 61.7672
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->450];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->450
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->450
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9aef1000
[DEBUG] GEMM shape: m=256 n=256 k=450 lda=256 ldb=450 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000295124
  time (contract): 0.000752375
  gflops: 78.395

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "450,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 450
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00128105
  gflops: 46.0421
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->450];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->450
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->450
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8bef1000
[DEBUG] GEMM shape: m=256 n=256 k=450 lda=256 ldb=450 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000346514
  time (contract): 0.00192498
  gflops: 30.6405

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=452 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "452,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 452
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00051443
  gflops: 115.165
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->452];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->452
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->452
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81cd5000
[DEBUG] GEMM shape: m=256 n=256 k=452 lda=256 ldb=452 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000313299
  time (contract): 0.000260014
  gflops: 227.851
-----------------------------------
max element torch :      133
max element jit :        133
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "452,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 452
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00093316
  gflops: 63.4881
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->452];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->452
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->452
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8f7a000
[DEBUG] GEMM shape: m=256 n=256 k=452 lda=256 ldb=452 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000289588
  time (contract): 0.000739127
  gflops: 80.1548

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "452,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 452
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00129202
  gflops: 45.854
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->452];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->452
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->452
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb10d8000
[DEBUG] GEMM shape: m=256 n=256 k=452 lda=256 ldb=452 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000370065
  time (contract): 0.00206121
  gflops: 28.7426

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=454 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "454,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 454
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000520597
  gflops: 114.305
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->454];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->454
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->454
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd081000
[DEBUG] GEMM shape: m=256 n=256 k=454 lda=256 ldb=454 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033077
  time (contract): 0.000503885
  gflops: 118.096
-----------------------------------
max element torch :      130
max element jit :        130
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "454,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 454
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000953124
  gflops: 62.4333
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->454];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->454
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->454
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffac649000
[DEBUG] GEMM shape: m=256 n=256 k=454 lda=256 ldb=454 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000307699
  time (contract): 0.000793969
  gflops: 74.9484

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "454,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 454
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00130342
  gflops: 45.6543
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->454];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->454
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->454
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9867000
[DEBUG] GEMM shape: m=256 n=256 k=454 lda=256 ldb=454 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000360049
  time (contract): 0.00200779
  gflops: 29.6379

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=456 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "456,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 456
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000529247
  gflops: 112.932
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->456];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->456
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->456
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff912d7000
[DEBUG] GEMM shape: m=256 n=256 k=456 lda=256 ldb=456 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328626
  time (contract): 0.000265021
  gflops: 225.525
-----------------------------------
max element torch :      131
max element jit :        131
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "456,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 456
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000958963
  gflops: 62.3265
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->456];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->456
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->456
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91c85000
[DEBUG] GEMM shape: m=256 n=256 k=456 lda=256 ldb=456 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000304852
  time (contract): 0.000783858
  gflops: 76.2495

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "456,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 456
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00129917
  gflops: 46.0054
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->456];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->456
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->456
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d217000
[DEBUG] GEMM shape: m=256 n=256 k=456 lda=256 ldb=456 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354321
  time (contract): 0.00202699
  gflops: 29.4865

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=458 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "458,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 458
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000533392
  gflops: 112.546
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->458];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->458
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->458
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaace3000
[DEBUG] GEMM shape: m=256 n=256 k=458 lda=256 ldb=458 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327442
  time (contract): 0.000483075
  gflops: 124.269
-----------------------------------
max element torch :      133
max element jit :        133
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "458,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 458
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000962666
  gflops: 62.3591
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->458];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->458
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->458
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9550000
[DEBUG] GEMM shape: m=256 n=256 k=458 lda=256 ldb=458 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000311187
  time (contract): 0.000746539
  gflops: 80.4124

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "458,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 458
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00130893
  gflops: 45.8625
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->458];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->458
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->458
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81ea5000
[DEBUG] GEMM shape: m=256 n=256 k=458 lda=256 ldb=458 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000372945
  time (contract): 0.00203995
  gflops: 29.4277

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=460 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "460,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 460
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000529246
  gflops: 113.923
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->460];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->460
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->460
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f34b000
[DEBUG] GEMM shape: m=256 n=256 k=460 lda=256 ldb=460 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000340882
  time (contract): 0.00026772
  gflops: 225.21
-----------------------------------
max element torch :      134
max element jit :        134
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "460,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 460
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000962598
  gflops: 62.6359
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->460];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->460
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->460
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff820a2000
[DEBUG] GEMM shape: m=256 n=256 k=460 lda=256 ldb=460 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000291636
  time (contract): 0.000813467
  gflops: 74.1187

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "460,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 460
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00131536
  gflops: 45.8378
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->460];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->460
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->460
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffae9c1000
[DEBUG] GEMM shape: m=256 n=256 k=460 lda=256 ldb=460 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000359953
  time (contract): 0.00206037
  gflops: 29.2633

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=462 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "462,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 462
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000526537
  gflops: 115.007
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->462];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->462
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->462
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8dcc8000
[DEBUG] GEMM shape: m=256 n=256 k=462 lda=256 ldb=462 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00031218
  time (contract): 0.000479478
  gflops: 126.294
-----------------------------------
max element torch :      133
max element jit :        133
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "462,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 462
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000960646
  gflops: 63.036
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->462];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->462
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->462
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff95ffc000
[DEBUG] GEMM shape: m=256 n=256 k=462 lda=256 ldb=462 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00030866
  time (contract): 0.000736911
  gflops: 82.1745

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "462,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 462
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00131145
  gflops: 46.1744
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->462];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->462
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->462
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89364000
[DEBUG] GEMM shape: m=256 n=256 k=462 lda=256 ldb=462 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000347313
  time (contract): 0.00201542
  gflops: 30.046

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=464 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "464,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 464
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000539961
  gflops: 112.633
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->464];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->464
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->464
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0131000
[DEBUG] GEMM shape: m=256 n=256 k=464 lda=256 ldb=464 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332915
  time (contract): 0.000271913
  gflops: 223.665
-----------------------------------
max element torch :      135
max element jit :        135
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "464,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 464
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000967161
  gflops: 62.8824
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->464];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->464
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->464
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa407e000
[DEBUG] GEMM shape: m=256 n=256 k=464 lda=256 ldb=464 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000316563
  time (contract): 0.000802184
  gflops: 75.8148

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "464,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 464
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00131809
  gflops: 46.1405
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->464];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->464
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->464
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff849cc000
[DEBUG] GEMM shape: m=256 n=256 k=464 lda=256 ldb=464 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331602
  time (contract): 0.0020915
  gflops: 29.0784

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=466 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "466,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 466
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000537238
  gflops: 113.692
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->466];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->466
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->466
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa6880000
[DEBUG] GEMM shape: m=256 n=256 k=466 lda=256 ldb=466 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000311892
  time (contract): 0.000485887
  gflops: 125.707
-----------------------------------
max element torch :      135
max element jit :        135
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "466,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 466
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00096868
  gflops: 63.0544
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->466];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->466
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->466
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffabe1d000
[DEBUG] GEMM shape: m=256 n=256 k=466 lda=256 ldb=466 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000314964
  time (contract): 0.000767934
  gflops: 79.5375

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "466,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 466
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00132868
  gflops: 45.9701
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->466];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->466
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->466
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8aeb000
[DEBUG] GEMM shape: m=256 n=256 k=466 lda=256 ldb=466 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000347121
  time (contract): 0.00202528
  gflops: 30.1586

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=468 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "468,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 468
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000529078
  gflops: 115.941
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->468];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->468
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->468
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf087000
[DEBUG] GEMM shape: m=256 n=256 k=468 lda=256 ldb=468 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000340114
  time (contract): 0.000274505
  gflops: 223.463
-----------------------------------
max element torch :      134
max element jit :        134
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "468,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 468
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000978271
  gflops: 62.7042
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->468];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->468
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->468
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d255000
[DEBUG] GEMM shape: m=256 n=256 k=468 lda=256 ldb=468 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306996
  time (contract): 0.000812759
  gflops: 75.4734

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "468,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 468
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00133511
  gflops: 45.9452
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->468];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->468
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->468
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91918000
[DEBUG] GEMM shape: m=256 n=256 k=468 lda=256 ldb=468 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000347666
  time (contract): 0.00215336
  gflops: 28.4866

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=470 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "470,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 470
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000536979
  gflops: 114.723
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->470];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->470
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->470
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9590000
[DEBUG] GEMM shape: m=256 n=256 k=470 lda=256 ldb=470 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000316691
  time (contract): 0.000572759
  gflops: 107.556
-----------------------------------
max element torch :      137
max element jit :        137
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "470,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 470
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000973993
  gflops: 63.2488
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->470];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->470
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->470
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99789000
[DEBUG] GEMM shape: m=256 n=256 k=470 lda=256 ldb=470 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000293012
  time (contract): 0.000765913
  gflops: 80.4319

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "470,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 470
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00133682
  gflops: 46.0822
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->470];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->470
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->470
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffadc01000
[DEBUG] GEMM shape: m=256 n=256 k=470 lda=256 ldb=470 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000315347
  time (contract): 0.00217118
  gflops: 28.3735

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=472 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "472,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 472
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000529868
  gflops: 116.757
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->472];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->472
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->472
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffafa03000
[DEBUG] GEMM shape: m=256 n=256 k=472 lda=256 ldb=472 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000297011
  time (contract): 0.000275472
  gflops: 224.582
-----------------------------------
max element torch :      135
max element jit :        135
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "472,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 472
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000988776
  gflops: 62.5683
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->472];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->472
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->472
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffadcd5000
[DEBUG] GEMM shape: m=256 n=256 k=472 lda=256 ldb=472 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000284532
  time (contract): 0.000822101
  gflops: 75.2535

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "472,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 472
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00133879
  gflops: 46.2104
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->472];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->472
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->472
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7f78000
[DEBUG] GEMM shape: m=256 n=256 k=472 lda=256 ldb=472 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000370352
  time (contract): 0.00223294
  gflops: 27.706

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=474 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "474,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 474
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00054454
  gflops: 114.093
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->474];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->474
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->474
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9193c000
[DEBUG] GEMM shape: m=256 n=256 k=474 lda=256 ldb=474 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000290676
  time (contract): 0.000494233
  gflops: 125.706
-----------------------------------
max element torch :      136
max element jit :        136
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "474,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 474
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000995866
  gflops: 62.386
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->474];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->474
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->474
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff927a9000
[DEBUG] GEMM shape: m=256 n=256 k=474 lda=256 ldb=474 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000287765
  time (contract): 0.000996565
  gflops: 62.3423

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "474,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 474
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00134924
  gflops: 46.0467
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->474];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->474
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->474
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0a36000
[DEBUG] GEMM shape: m=256 n=256 k=474 lda=256 ldb=474 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000379696
  time (contract): 0.00212548
  gflops: 29.2301

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=476 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "476,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 476
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000547931
  gflops: 113.865
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->476];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->476
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->476
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c7fe000
[DEBUG] GEMM shape: m=256 n=256 k=476 lda=256 ldb=476 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000309299
  time (contract): 0.000278349
  gflops: 224.144
-----------------------------------
max element torch :      140
max element jit :        140
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "476,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 476
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00099787
  gflops: 62.5234
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->476];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->476
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->476
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86f63000
[DEBUG] GEMM shape: m=256 n=256 k=476 lda=256 ldb=476 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000292052
  time (contract): 0.000764396
  gflops: 81.6203

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "476,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 476
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00135935
  gflops: 45.8971
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->476];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->476
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->476
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffac5dd000
[DEBUG] GEMM shape: m=256 n=256 k=476 lda=256 ldb=476 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000361649
  time (contract): 0.00221333
  gflops: 28.1884

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=478 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "478,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 478
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000516908
  gflops: 121.206
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->478];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->478
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->478
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7780000
[DEBUG] GEMM shape: m=256 n=256 k=478 lda=256 ldb=478 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000274645
  time (contract): 0.000500074
  gflops: 125.286
-----------------------------------
max element torch :      136
max element jit :        136
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "478,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 478
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00101717
  gflops: 61.5946
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->478];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->478
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->478
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9696c000
[DEBUG] GEMM shape: m=256 n=256 k=478 lda=256 ldb=478 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000254198
  time (contract): 0.000848128
  gflops: 73.8715

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "478,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 478
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00137638
  gflops: 45.5196
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->478];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->478
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->478
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97071000
[DEBUG] GEMM shape: m=256 n=256 k=478 lda=256 ldb=478 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000366033
  time (contract): 0.00224266
  gflops: 27.9367

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=480 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "480,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 480
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000484188
  gflops: 129.938
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->480];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->480
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->480
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a625000
[DEBUG] GEMM shape: m=256 n=256 k=480 lda=256 ldb=480 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000341106
  time (contract): 0.000284768
  gflops: 220.933
-----------------------------------
max element torch :      141
max element jit :        141
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "480,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 480
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.000969611
  gflops: 64.8864
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->480];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->480
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->480
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84b19000
[DEBUG] GEMM shape: m=256 n=256 k=480 lda=256 ldb=480 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000298836
  time (contract): 0.000918851
  gflops: 68.4709

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "480,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 480
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00137216
  gflops: 45.8506
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->480];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->480
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->480
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7864000
[DEBUG] GEMM shape: m=256 n=256 k=480 lda=256 ldb=480 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000322003
  time (contract): 0.00227849
  gflops: 27.6124

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=482 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "482,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 482
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000580758
  gflops: 108.783
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->482];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->482
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->482
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d960000
[DEBUG] GEMM shape: m=256 n=256 k=482 lda=256 ldb=482 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333522
  time (contract): 0.000506761
  gflops: 124.668
-----------------------------------
max element torch :      143
max element jit :        143
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "482,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 482
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00104723
  gflops: 60.3274
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->482];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->482
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->482
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaebf9000
[DEBUG] GEMM shape: m=256 n=256 k=482 lda=256 ldb=482 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000280277
  time (contract): 0.000796536
  gflops: 79.3143

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "482,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 482
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00138157
  gflops: 45.7282
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->482];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->482
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->482
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a715000
[DEBUG] GEMM shape: m=256 n=256 k=482 lda=256 ldb=482 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029314
  time (contract): 0.00212653
  gflops: 29.7088

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=484 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "484,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 484
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000551459
  gflops: 115.038
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->484];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->484
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->484
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c9ff000
[DEBUG] GEMM shape: m=256 n=256 k=484 lda=256 ldb=484 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335314
  time (contract): 0.000282708
  gflops: 224.397
-----------------------------------
max element torch :      141
max element jit :        141
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "484,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 484
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00100269
  gflops: 63.2684
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->484];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->484
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->484
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7022000
[DEBUG] GEMM shape: m=256 n=256 k=484 lda=256 ldb=484 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338738
  time (contract): 0.000806462
  gflops: 78.6631

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "484,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 484
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00137682
  gflops: 46.0765
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->484];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->484
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->484
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9000f000
[DEBUG] GEMM shape: m=256 n=256 k=484 lda=256 ldb=484 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000335122
  time (contract): 0.00225691
  gflops: 28.1087

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=486 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "486,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 486
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000562764
  gflops: 113.193
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->486];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->486
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->486
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7cb0000
[DEBUG] GEMM shape: m=256 n=256 k=486 lda=256 ldb=486 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337586
  time (contract): 0.000504045
  gflops: 126.38
-----------------------------------
max element torch :      140
max element jit :        140
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "486,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 486
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00101279
  gflops: 62.8964
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->486];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->486
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->486
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c677000
[DEBUG] GEMM shape: m=256 n=256 k=486 lda=256 ldb=486 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000316051
  time (contract): 0.000817917
  gflops: 77.882

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "486,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 486
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00138769
  gflops: 45.9045
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->486];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->486
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->486
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff940bd000
[DEBUG] GEMM shape: m=256 n=256 k=486 lda=256 ldb=486 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000321267
  time (contract): 0.00225084
  gflops: 28.301

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=488 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "488,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 488
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000551212
  gflops: 116.041
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->488];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->488
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->488
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87d6d000
[DEBUG] GEMM shape: m=256 n=256 k=488 lda=256 ldb=488 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00031442
  time (contract): 0.000285397
  gflops: 224.12
-----------------------------------
max element torch :      141
max element jit :        141
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "488,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 488
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00101741
  gflops: 62.8687
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->488];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->488
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->488
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc1db000
[DEBUG] GEMM shape: m=256 n=256 k=488 lda=256 ldb=488 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000222807
  time (contract): 0.0008019
  gflops: 79.7645

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "488,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 488
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00138295
  gflops: 46.2511
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->488];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->488
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->488
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1e5a000
[DEBUG] GEMM shape: m=256 n=256 k=488 lda=256 ldb=488 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000319795
  time (contract): 0.00225721
  gflops: 28.3373

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=490 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "490,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 490
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000569685
  gflops: 112.738
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->490];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->490
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->490
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c000000
[DEBUG] GEMM shape: m=256 n=256 k=490 lda=256 ldb=490 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000285332
  time (contract): 0.000511175
  gflops: 125.643
-----------------------------------
max element torch :      141
max element jit :        141
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "490,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 490
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00102129
  gflops: 62.8867
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->490];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->490
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->490
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbce08000
[DEBUG] GEMM shape: m=256 n=256 k=490 lda=256 ldb=490 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000339827
  time (contract): 0.000787364
  gflops: 81.57

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "490,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 490
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00140156
  gflops: 45.8241
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->490];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->490
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->490
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96fdd000
[DEBUG] GEMM shape: m=256 n=256 k=490 lda=256 ldb=490 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000304979
  time (contract): 0.00221583
  gflops: 28.9847

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=492 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "492,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 492
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000558638
  gflops: 115.437
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->492];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->492
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->492
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad455000
[DEBUG] GEMM shape: m=256 n=256 k=492 lda=256 ldb=492 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000334066
  time (contract): 0.0002856
  gflops: 225.796
-----------------------------------
max element torch :      143
max element jit :        143
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "492,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 492
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00102227
  gflops: 63.0827
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->492];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->492
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->492
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff801c8000
[DEBUG] GEMM shape: m=256 n=256 k=492 lda=256 ldb=492 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000256181
  time (contract): 0.000822902
  gflops: 78.3658

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "492,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 492
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00141159
  gflops: 45.6842
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->492];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->492
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->492
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86da6000
[DEBUG] GEMM shape: m=256 n=256 k=492 lda=256 ldb=492 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000341586
  time (contract): 0.00219681
  gflops: 29.355

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=494 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "494,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 494
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000526884
  gflops: 122.892
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->494];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->494
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->494
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffafea5000
[DEBUG] GEMM shape: m=256 n=256 k=494 lda=256 ldb=494 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000315251
  time (contract): 0.000514042
  gflops: 125.962
-----------------------------------
max element torch :      146
max element jit :        146
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "494,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 494
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00103853
  gflops: 62.3475
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->494];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->494
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->494
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf412000
[DEBUG] GEMM shape: m=256 n=256 k=494 lda=256 ldb=494 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338131
  time (contract): 0.000855804
  gflops: 75.6593

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "494,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 494
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00140134
  gflops: 46.2055
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->494];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->494
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->494
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b5ea000
[DEBUG] GEMM shape: m=256 n=256 k=494 lda=256 ldb=494 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000395504
  time (contract): 0.00235115
  gflops: 27.5396

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=496 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "496,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 496
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000503678
  gflops: 129.074
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->496];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->496
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->496
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffacb46000
[DEBUG] GEMM shape: m=256 n=256 k=496 lda=256 ldb=496 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306356
  time (contract): 0.00029592
  gflops: 219.694
-----------------------------------
max element torch :      143
max element jit :        143
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "496,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 496
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00100223
  gflops: 64.8672
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->496];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->496
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->496
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c3f4000
[DEBUG] GEMM shape: m=256 n=256 k=496 lda=256 ldb=496 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305396
  time (contract): 0.000874804
  gflops: 74.3157

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "496,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 496
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00140983
  gflops: 46.1133
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->496];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->496
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->496
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94d10000
[DEBUG] GEMM shape: m=256 n=256 k=496 lda=256 ldb=496 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000386928
  time (contract): 0.002295
  gflops: 28.3275

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=498 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "498,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 498
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000566624
  gflops: 115.198
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->498];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->498
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->498
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84ae0000
[DEBUG] GEMM shape: m=256 n=256 k=498 lda=256 ldb=498 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000286197
  time (contract): 0.000521344
  gflops: 125.203
-----------------------------------
max element torch :      143
max element jit :        143
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "498,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 498
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00104438
  gflops: 62.5
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->498];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->498
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->498
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffacf82000
[DEBUG] GEMM shape: m=256 n=256 k=498 lda=256 ldb=498 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000292084
  time (contract): 0.000810911
  gflops: 80.4945

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "498,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 498
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00141612
  gflops: 46.0936
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->498];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->498
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->498
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1675000
[DEBUG] GEMM shape: m=256 n=256 k=498 lda=256 ldb=498 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000344498
  time (contract): 0.00228528
  gflops: 28.5627

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=500 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "500,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 500
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000564564
  gflops: 116.083
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->500];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->500
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->500
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82b4a000
[DEBUG] GEMM shape: m=256 n=256 k=500 lda=256 ldb=500 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000309843
  time (contract): 0.000289962
  gflops: 226.016
-----------------------------------
max element torch :      143
max element jit :        143
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "500,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 500
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00103225
  gflops: 63.4887
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->500];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->500
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->500
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94b87000
[DEBUG] GEMM shape: m=256 n=256 k=500 lda=256 ldb=500 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000309684
  time (contract): 0.000838862
  gflops: 78.1249

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "500,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 500
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00142074
  gflops: 46.128
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->500];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->500
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->500
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7091000
[DEBUG] GEMM shape: m=256 n=256 k=500 lda=256 ldb=500 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000406736
  time (contract): 0.00226356
  gflops: 28.9526

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=502 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "502,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 502
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000537824
  gflops: 122.341
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->502];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->502
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->502
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87132000
[DEBUG] GEMM shape: m=256 n=256 k=502 lda=256 ldb=502 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000297716
  time (contract): 0.000523134
  gflops: 125.777
-----------------------------------
max element torch :      144
max element jit :        144
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "502,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 502
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00104357
  gflops: 63.0508
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->502];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->502
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->502
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84bbb000
[DEBUG] GEMM shape: m=256 n=256 k=502 lda=256 ldb=502 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000282036
  time (contract): 0.000908242
  gflops: 72.4456

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "502,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 502
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00142753
  gflops: 46.0924
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->502];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->502
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->502
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d968000
[DEBUG] GEMM shape: m=256 n=256 k=502 lda=256 ldb=502 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338195
  time (contract): 0.00228272
  gflops: 28.8245

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=504 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "504,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 504
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000519127
  gflops: 127.253
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->504];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->504
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->504
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb96d7000
[DEBUG] GEMM shape: m=256 n=256 k=504 lda=256 ldb=504 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331059
  time (contract): 0.000293171
  gflops: 225.33
-----------------------------------
max element torch :      143
max element jit :        143
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "504,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 504
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00101804
  gflops: 64.8895
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->504];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->504
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->504
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff942b9000
[DEBUG] GEMM shape: m=256 n=256 k=504 lda=256 ldb=504 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000289301
  time (contract): 0.00102192
  gflops: 64.6433

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "504,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 504
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00142919
  gflops: 46.2223
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->504];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->504
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->504
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89df9000
[DEBUG] GEMM shape: m=256 n=256 k=504 lda=256 ldb=504 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000368625
  time (contract): 0.00228991
  gflops: 28.8484

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=506 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "506,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 506
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000523126
  gflops: 126.781
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->506];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->506
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->506
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89c29000
[DEBUG] GEMM shape: m=256 n=256 k=506 lda=256 ldb=506 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000325202
  time (contract): 0.000534195
  gflops: 124.154
-----------------------------------
max element torch :      143
max element jit :        143
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "506,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 506
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.0010611
  gflops: 62.5035
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->506];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->506
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->506
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96509000
[DEBUG] GEMM shape: m=256 n=256 k=506 lda=256 ldb=506 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000291476
  time (contract): 0.000884222
  gflops: 75.0066

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "506,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 506
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00143954
  gflops: 46.0719
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->506];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->506
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->506
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff850d7000
[DEBUG] GEMM shape: m=256 n=256 k=506 lda=256 ldb=506 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348465
  time (contract): 0.00217141
  gflops: 30.5434

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=508 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "508,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 508
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000535062
  gflops: 124.443
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->508];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->508
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->508
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c4e7000
[DEBUG] GEMM shape: m=256 n=256 k=508 lda=256 ldb=508 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000355153
  time (contract): 0.000301299
  gflops: 220.992
-----------------------------------
max element torch :      146
max element jit :        146
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "508,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 508
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00102165
  gflops: 65.1735
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->508];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->508
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->508
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbdd89000
[DEBUG] GEMM shape: m=256 n=256 k=508 lda=256 ldb=508 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000268885
  time (contract): 0.000893806
  gflops: 74.4956

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "508,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 508
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00145003
  gflops: 45.9194
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->508];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->508
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->508
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb791f000
[DEBUG] GEMM shape: m=256 n=256 k=508 lda=256 ldb=508 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000366193
  time (contract): 0.00230052
  gflops: 28.9433

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=510 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "510,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 510
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.00051819
  gflops: 129.001
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->510];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->510
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->510
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7dda000
[DEBUG] GEMM shape: m=256 n=256 k=510 lda=256 ldb=510 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000340722
  time (contract): 0.000533552
  gflops: 125.286
-----------------------------------
max element torch :      146
max element jit :        146
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "510,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 510
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00103879
  gflops: 64.3508
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->510];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->510
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->510
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff815e8000
[DEBUG] GEMM shape: m=256 n=256 k=510 lda=256 ldb=510 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000285172
  time (contract): 0.000906568
  gflops: 73.7361

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "510,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 510
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00145894
  gflops: 45.8186
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->510];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->510
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->510
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0ab6000
[DEBUG] GEMM shape: m=256 n=256 k=510 lda=256 ldb=510 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000355697
  time (contract): 0.00225787
  gflops: 29.606

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing k=512 (M=256, N=256) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "512,256,256" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 512
  m: 256
  n: 256
dtype: BF16
at::einsum:
  time (contract): 0.000551747
  gflops: 121.63
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->512];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->512
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->512
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0517000
[DEBUG] GEMM shape: m=256 n=256 k=512 lda=256 ldb=512 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337043
  time (contract): 0.000316739
  gflops: 211.874
-----------------------------------
max element torch :      148
max element jit :        148
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "512,256,256" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 512
  m: 256
  n: 256
dtype: FP32
at::einsum:
  time (contract): 0.00109391
  gflops: 61.3475
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->512];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->512
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->512
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9310f000
[DEBUG] GEMM shape: m=256 n=256 k=512 lda=256 ldb=512 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000280405
  time (contract): 0.000910249
  gflops: 73.7258

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "km,nk->nm" "512,256,256" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  k,m
  n,k
  n,m
parsed dimension ids:
  k: 0
  m: 1
  n: 2
parsed dimension sizes:
  k: 512
  m: 256
  n: 256
dtype: FP64
at::einsum:
  time (contract): 0.00145651
  gflops: 46.075
einsum_ir:
3 
1 
--------
2 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
1 
--------
2 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 1
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          2
m_num_dims_right         2
m_num_dims_out           2
l_dim_ids_left_active    0
                         1
l_dim_ids_right_active   2
                         0
m_dim_ids_out            2
                         1
m_dim_sizes_inner        [0->512];[1->256];[2->256]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             1
l_dim_ids_nb             2
l_dim_ids_kb             0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->256
1                        ->1
l_strides_right          
0                        ->1
2                        ->512
l_strides_out            
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->512
1                        ->256
2                        ->256
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa35ec000
[DEBUG] GEMM shape: m=256 n=256 k=512 lda=256 ldb=512 ldc=256
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000352274
  time (contract): 0.00244965
  gflops: 27.3952

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


