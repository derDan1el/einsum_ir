=== GEMM l-Value Benchmark Log Started: Sat Jun 14 11:16:06 PM CEST 2025 ===
Testing einsum: lmk,nlk->nm with M=128, N=128, K=4, varying l from 1 to 128

=== Testing l=1 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,1,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 1
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 4.14622e-05
  gflops: 3.16124
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->1];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->0
2                        ->1
l_strides_right          
0                        ->1
1                        ->0
3                        ->4
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->1
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb69f6000
[DEBUG] GEMM shape: m=128 n=128 k=4 lda=128 ldb=4 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000442862
  time (contract): 4.0801e-06
  gflops: 32.1247
-----------------------------------
max element torch :      2.95312
max element jit :        2.95312
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=2 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,2,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 2
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 5.07953e-05
  gflops: 5.1608
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->2];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->8
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->2
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf1c9000
[DEBUG] GEMM shape: m=128 n=128 k=8 lda=128 ldb=8 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000369425
  time (contract): 4.58624e-06
  gflops: 57.1588
-----------------------------------
max element torch :      4.21875
max element jit :        4.21875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=3 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,3,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 3
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 5.39721e-05
  gflops: 7.28554
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->3];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->12
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->3
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7fb89000
[DEBUG] GEMM shape: m=128 n=128 k=12 lda=128 ldb=12 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000343602
  time (contract): 5.07875e-06
  gflops: 77.4238
-----------------------------------
max element torch :      6.1875
max element jit :        6.1875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=4 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,4,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 4
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 5.40361e-05
  gflops: 9.70256
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->4];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->16
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->4
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff910d4000
[DEBUG] GEMM shape: m=128 n=128 k=16 lda=128 ldb=16 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348338
  time (contract): 5.54078e-06
  gflops: 94.6234
-----------------------------------
max element torch :      7.25
max element jit :        7.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=5 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,5,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 5
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 5.20267e-05
  gflops: 12.5966
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->5];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->20
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->5
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87387000
[DEBUG] GEMM shape: m=128 n=128 k=20 lda=128 ldb=20 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034933
  time (contract): 6.04773e-06
  gflops: 108.365
-----------------------------------
max element torch :      9.8125
max element jit :        9.8125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=6 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,6,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 6
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 5.42708e-05
  gflops: 14.4909
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->6];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->24
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->6
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa89ce000
[DEBUG] GEMM shape: m=128 n=128 k=24 lda=128 ldb=24 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000360209
  time (contract): 6.59615e-06
  gflops: 119.226
-----------------------------------
max element torch :      11.0625
max element jit :        11.0625
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=7 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,7,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 7
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 5.51197e-05
  gflops: 16.6457
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->7];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->28
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->7
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9fb97000
[DEBUG] GEMM shape: m=128 n=128 k=28 lda=128 ldb=28 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000350513
  time (contract): 7.06943e-06
  gflops: 129.785
-----------------------------------
max element torch :      11
max element jit :        11
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=8 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,8,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 8
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 5.54984e-05
  gflops: 18.8938
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->8];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->32
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->8
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff98a66000
[DEBUG] GEMM shape: m=128 n=128 k=32 lda=128 ldb=32 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000302323
  time (contract): 7.58991e-06
  gflops: 138.154
-----------------------------------
max element torch :      12.5625
max element jit :        12.5625
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=9 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,9,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 9
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 5.67679e-05
  gflops: 20.7802
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->9];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->36
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->9
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b5ba000
[DEBUG] GEMM shape: m=128 n=128 k=36 lda=128 ldb=36 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337746
  time (contract): 8.00376e-06
  gflops: 147.387
-----------------------------------
max element torch :      15.625
max element jit :        15.625
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=10 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,10,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 10
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 5.91035e-05
  gflops: 22.1767
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->10];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->40
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->10
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9fe72000
[DEBUG] GEMM shape: m=128 n=128 k=40 lda=128 ldb=40 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000341234
  time (contract): 8.5438e-06
  gflops: 153.412
-----------------------------------
max element torch :      15.25
max element jit :        15.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=11 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,11,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 11
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 6.11912e-05
  gflops: 23.5621
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->11];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->44
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->11
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92bf7000
[DEBUG] GEMM shape: m=128 n=128 k=44 lda=128 ldb=44 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000330834
  time (contract): 9.00967e-06
  gflops: 160.027
-----------------------------------
max element torch :      16.25
max element jit :        16.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=12 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,12,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 12
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 5.91531e-05
  gflops: 26.5897
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->12];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->48
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->12
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c8c6000
[DEBUG] GEMM shape: m=128 n=128 k=48 lda=128 ldb=48 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000310707
  time (contract): 9.48015e-06
  gflops: 165.911
-----------------------------------
max element torch :      18.875
max element jit :        18.875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=13 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,13,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 13
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 6.10584e-05
  gflops: 27.9067
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->13];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->52
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->13
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1912000
[DEBUG] GEMM shape: m=128 n=128 k=52 lda=128 ldb=52 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324147
  time (contract): 9.97963e-06
  gflops: 170.741
-----------------------------------
max element torch :      19.5
max element jit :        19.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=14 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,14,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 14
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 6.12549e-05
  gflops: 29.9569
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->14];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->56
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->14
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff817c7000
[DEBUG] GEMM shape: m=128 n=128 k=56 lda=128 ldb=56 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000310835
  time (contract): 1.04679e-05
  gflops: 175.299
-----------------------------------
max element torch :      20.75
max element jit :        20.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=15 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,15,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 15
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 6.34347e-05
  gflops: 30.9937
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->15];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->60
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->15
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaea19000
[DEBUG] GEMM shape: m=128 n=128 k=60 lda=128 ldb=60 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000300628
  time (contract): 1.09568e-05
  gflops: 179.44
-----------------------------------
max element torch :      20.875
max element jit :        20.875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=16 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,16,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 16
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 6.5155e-05
  gflops: 32.1871
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->16];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->64
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->16
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2d41000
[DEBUG] GEMM shape: m=128 n=128 k=64 lda=128 ldb=64 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000384272
  time (contract): 1.13603e-05
  gflops: 184.604
-----------------------------------
max element torch :      22.375
max element jit :        22.375
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=17 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,17,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 17
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 6.67999e-05
  gflops: 33.3567
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->17];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->68
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->17
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf047000
[DEBUG] GEMM shape: m=128 n=128 k=68 lda=128 ldb=68 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348145
  time (contract): 1.18834e-05
  gflops: 187.507
-----------------------------------
max element torch :      23.25
max element jit :        23.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=18 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,18,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 18
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 6.85049e-05
  gflops: 34.4398
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->18];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->72
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->18
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb30f5000
[DEBUG] GEMM shape: m=128 n=128 k=72 lda=128 ldb=72 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329074
  time (contract): 1.24568e-05
  gflops: 189.398
-----------------------------------
max element torch :      24.375
max element jit :        24.375
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=19 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,19,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 19
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 6.8225e-05
  gflops: 36.5023
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->19];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->76
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->19
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc78e000
[DEBUG] GEMM shape: m=128 n=128 k=76 lda=128 ldb=76 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000353266
  time (contract): 1.29742e-05
  gflops: 191.947
-----------------------------------
max element torch :      26.125
max element jit :        26.125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=20 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,20,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 20
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 6.99379e-05
  gflops: 37.4824
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->20];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->80
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->20
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4916000
[DEBUG] GEMM shape: m=128 n=128 k=80 lda=128 ldb=80 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00035013
  time (contract): 1.3418e-05
  gflops: 195.367
-----------------------------------
max element torch :      27.5
max element jit :        27.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=21 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,21,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 21
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 7.02485e-05
  gflops: 39.1825
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->21];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->84
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->21
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb6ff1000
[DEBUG] GEMM shape: m=128 n=128 k=84 lda=128 ldb=84 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000339795
  time (contract): 1.39422e-05
  gflops: 197.423
-----------------------------------
max element torch :      30.125
max element jit :        30.125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=22 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,22,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 22
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 7.02853e-05
  gflops: 41.0269
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->22];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->88
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->22
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d994000
[DEBUG] GEMM shape: m=128 n=128 k=88 lda=128 ldb=88 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000347218
  time (contract): 1.44308e-05
  gflops: 199.821
-----------------------------------
max element torch :      29.5
max element jit :        29.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=23 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,23,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 23
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 7.24799e-05
  gflops: 41.593
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->23];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->92
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->23
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff954b0000
[DEBUG] GEMM shape: m=128 n=128 k=92 lda=128 ldb=92 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000391376
  time (contract): 1.47241e-05
  gflops: 204.744
-----------------------------------
max element torch :      30.75
max element jit :        30.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=24 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,24,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 24
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 7.36992e-05
  gflops: 42.6833
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->24];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->96
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->24
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb54ac000
[DEBUG] GEMM shape: m=128 n=128 k=96 lda=128 ldb=96 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000293236
  time (contract): 1.52773e-05
  gflops: 205.908
-----------------------------------
max element torch :      31.875
max element jit :        31.875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=25 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,25,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 25
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 7.30379e-05
  gflops: 44.8644
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->25];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->100
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->25
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa038c000
[DEBUG] GEMM shape: m=128 n=128 k=100 lda=128 ldb=100 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00032597
  time (contract): 1.58507e-05
  gflops: 206.729
-----------------------------------
max element torch :      34
max element jit :        34
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=26 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,26,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 26
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 7.82672e-05
  gflops: 43.5415
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->26];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->104
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->26
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbdcce000
[DEBUG] GEMM shape: m=128 n=128 k=104 lda=128 ldb=104 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034581
  time (contract): 1.63721e-05
  gflops: 208.152
-----------------------------------
max element torch :      34
max element jit :        34
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=27 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,27,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 27
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 7.71972e-05
  gflops: 45.8429
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->27];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->108
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->27
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff917af000
[DEBUG] GEMM shape: m=128 n=128 k=108 lda=128 ldb=108 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000296052
  time (contract): 1.68979e-05
  gflops: 209.43
-----------------------------------
max element torch :      35.5
max element jit :        35.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=28 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,28,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 28
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 7.79484e-05
  gflops: 47.0826
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->28];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->112
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->28
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5803000
[DEBUG] GEMM shape: m=128 n=128 k=112 lda=128 ldb=112 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000314451
  time (contract): 1.73668e-05
  gflops: 211.324
-----------------------------------
max element torch :      36.75
max element jit :        36.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=29 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,29,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 29
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 7.89031e-05
  gflops: 48.1741
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->29];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->116
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->29
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90001000
[DEBUG] GEMM shape: m=128 n=128 k=116 lda=128 ldb=116 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000336754
  time (contract): 1.78517e-05
  gflops: 212.926
-----------------------------------
max element torch :      36.75
max element jit :        36.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=30 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,30,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 30
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.15833e-05
  gflops: 48.1981
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->30];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->120
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->30
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab340000
[DEBUG] GEMM shape: m=128 n=128 k=120 lda=128 ldb=120 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000361521
  time (contract): 1.83245e-05
  gflops: 214.585
-----------------------------------
max element torch :      39.75
max element jit :        39.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=31 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,31,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 31
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.06833e-05
  gflops: 50.3602
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->31];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->124
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->31
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80f97000
[DEBUG] GEMM shape: m=128 n=128 k=124 lda=128 ldb=124 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332146
  time (contract): 1.89778e-05
  gflops: 214.105
-----------------------------------
max element torch :      40.5
max element jit :        40.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=32 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,32,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 32
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.08419e-05
  gflops: 51.8828
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->32];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->128
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->32
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf411000
[DEBUG] GEMM shape: m=128 n=128 k=128 lda=128 ldb=128 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348626
  time (contract): 1.95355e-05
  gflops: 214.701
-----------------------------------
max element torch :      42
max element jit :        42
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=33 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,33,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 33
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.21836e-05
  gflops: 52.6307
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->33];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->132
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->33
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84db3000
[DEBUG] GEMM shape: m=128 n=128 k=132 lda=128 ldb=132 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.0003133
  time (contract): 1.9796e-05
  gflops: 218.497
-----------------------------------
max element torch :      43
max element jit :        43
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=34 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,34,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 34
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.43214e-05
  gflops: 52.8507
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->34];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->136
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->34
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8da9a000
[DEBUG] GEMM shape: m=128 n=128 k=136 lda=128 ldb=136 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348242
  time (contract): 2.03219e-05
  gflops: 219.293
-----------------------------------
max element torch :      44.25
max element jit :        44.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=35 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,35,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 35
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.54783e-05
  gflops: 53.6688
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->35];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->140
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->35
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa64d7000
[DEBUG] GEMM shape: m=128 n=128 k=140 lda=128 ldb=140 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324979
  time (contract): 2.07689e-05
  gflops: 220.884
-----------------------------------
max element torch :      45.5
max element jit :        45.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=36 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,36,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 36
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.69409e-05
  gflops: 54.2736
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->36];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->144
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->36
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81576000
[DEBUG] GEMM shape: m=128 n=128 k=144 lda=128 ldb=144 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320819
  time (contract): 2.11941e-05
  gflops: 222.637
-----------------------------------
max element torch :      47
max element jit :        47
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=37 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,37,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 37
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.69264e-05
  gflops: 55.7905
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->37];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->148
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->37
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97dc8000
[DEBUG] GEMM shape: m=128 n=128 k=148 lda=128 ldb=148 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000347538
  time (contract): 2.17416e-05
  gflops: 223.059
-----------------------------------
max element torch :      48.5
max element jit :        48.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=38 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,38,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 38
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.84673e-05
  gflops: 56.3003
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->38];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->152
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->38
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96762000
[DEBUG] GEMM shape: m=128 n=128 k=152 lda=128 ldb=152 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000292116
  time (contract): 2.23806e-05
  gflops: 222.547
-----------------------------------
max element torch :      47.25
max element jit :        47.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=39 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,39,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 39
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 9.09582e-05
  gflops: 56.1995
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->39];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->156
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->39
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a257000
[DEBUG] GEMM shape: m=128 n=128 k=156 lda=128 ldb=156 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000322739
  time (contract): 2.29087e-05
  gflops: 223.139
-----------------------------------
max element torch :      49.75
max element jit :        49.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=40 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,40,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 40
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 8.9106e-05
  gflops: 58.8387
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->40];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->160
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->40
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa75af000
[DEBUG] GEMM shape: m=128 n=128 k=160 lda=128 ldb=160 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000378033
  time (contract): 2.34648e-05
  gflops: 223.436
-----------------------------------
max element torch :      51.25
max element jit :        51.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=41 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,41,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 41
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 9.09262e-05
  gflops: 59.1024
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->41];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->164
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->41
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94963000
[DEBUG] GEMM shape: m=128 n=128 k=164 lda=128 ldb=164 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000354097
  time (contract): 2.38035e-05
  gflops: 225.763
-----------------------------------
max element torch :      52.25
max element jit :        52.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=42 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,42,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 42
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 9.54643e-05
  gflops: 57.6658
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->42];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->168
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->42
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a2b2000
[DEBUG] GEMM shape: m=128 n=128 k=168 lda=128 ldb=168 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333139
  time (contract): 2.42087e-05
  gflops: 227.399
-----------------------------------
max element torch :      51
max element jit :        51
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=43 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,43,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 43
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 9.55479e-05
  gflops: 58.9871
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->43];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->172
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->43
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b132000
[DEBUG] GEMM shape: m=128 n=128 k=172 lda=128 ldb=172 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033605
  time (contract): 2.47562e-05
  gflops: 227.664
-----------------------------------
max element torch :      53.25
max element jit :        53.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=44 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,44,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 44
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 9.51401e-05
  gflops: 60.6176
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->44];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->176
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->44
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb85f8000
[DEBUG] GEMM shape: m=128 n=128 k=176 lda=128 ldb=176 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000317939
  time (contract): 2.52755e-05
  gflops: 228.172
-----------------------------------
max element torch :      55.25
max element jit :        55.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=45 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,45,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 45
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 9.75142e-05
  gflops: 60.486
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->45];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->180
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->45
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e7d9000
[DEBUG] GEMM shape: m=128 n=128 k=180 lda=128 ldb=180 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329138
  time (contract): 2.57709e-05
  gflops: 228.872
-----------------------------------
max element torch :      55.75
max element jit :        55.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=46 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,46,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 46
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000100728
  gflops: 59.8572
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->46];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->184
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->46
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1939000
[DEBUG] GEMM shape: m=128 n=128 k=184 lda=128 ldb=184 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328243
  time (contract): 2.64056e-05
  gflops: 228.334
-----------------------------------
max element torch :      56.5
max element jit :        56.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=47 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,47,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 47
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 9.952e-05
  gflops: 61.901
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->47];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->188
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->47
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9fea4000
[DEBUG] GEMM shape: m=128 n=128 k=188 lda=128 ldb=188 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000350994
  time (contract): 2.67335e-05
  gflops: 230.437
-----------------------------------
max element torch :      59.25
max element jit :        59.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=48 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,48,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 48
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00010131
  gflops: 62.1012
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->48];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->192
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->48
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7fa57000
[DEBUG] GEMM shape: m=128 n=128 k=192 lda=128 ldb=192 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327698
  time (contract): 2.74443e-05
  gflops: 229.244
-----------------------------------
max element torch :      61.25
max element jit :        61.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=49 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,49,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 49
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000103753
  gflops: 61.9018
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->49];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->196
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->49
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa84d5000
[DEBUG] GEMM shape: m=128 n=128 k=196 lda=128 ldb=196 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000317523
  time (contract): 2.77671e-05
  gflops: 231.3
-----------------------------------
max element torch :      61.25
max element jit :        61.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=50 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,50,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 50
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000105603
  gflops: 62.0591
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->50];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->200
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->50
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96313000
[DEBUG] GEMM shape: m=128 n=128 k=200 lda=128 ldb=200 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306899
  time (contract): 2.84223e-05
  gflops: 230.58
-----------------------------------
max element torch :      61.25
max element jit :        61.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=51 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,51,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 51
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000102502
  gflops: 65.2151
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->51];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->204
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->51
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8ffe7000
[DEBUG] GEMM shape: m=128 n=128 k=204 lda=128 ldb=204 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000305043
  time (contract): 2.87467e-05
  gflops: 232.537
-----------------------------------
max element torch :      61.5
max element jit :        61.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=52 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,52,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 52
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000108094
  gflops: 63.0541
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->52];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->208
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->52
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96b1d000
[DEBUG] GEMM shape: m=128 n=128 k=208 lda=128 ldb=208 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00027474
  time (contract): 2.92898e-05
  gflops: 232.7
-----------------------------------
max element torch :      64
max element jit :        64
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=53 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,53,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 53
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000107458
  gflops: 64.6465
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->53];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->212
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->53
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9abf1000
[DEBUG] GEMM shape: m=128 n=128 k=212 lda=128 ldb=212 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000298324
  time (contract): 2.97953e-05
  gflops: 233.151
-----------------------------------
max element torch :      65
max element jit :        65
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=54 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,54,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 54
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000108365
  gflops: 65.3152
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->54];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->216
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->54
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b11d000
[DEBUG] GEMM shape: m=128 n=128 k=216 lda=128 ldb=216 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033413
  time (contract): 3.02668e-05
  gflops: 233.85
-----------------------------------
max element torch :      65.5
max element jit :        65.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=55 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,55,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 55
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000108513
  gflops: 66.4341
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->55];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->220
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->55
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8be1000
[DEBUG] GEMM shape: m=128 n=128 k=220 lda=128 ldb=220 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000331475
  time (contract): 3.06868e-05
  gflops: 234.921
-----------------------------------
max element torch :      67.5
max element jit :        67.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=56 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,56,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 56
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000110769
  gflops: 66.264
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->56];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->224
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->56
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87def000
[DEBUG] GEMM shape: m=128 n=128 k=224 lda=128 ldb=224 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333523
  time (contract): 3.12929e-05
  gflops: 234.559
-----------------------------------
max element torch :      69.5
max element jit :        69.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=57 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,57,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 57
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000112047
  gflops: 66.6782
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->57];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->228
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->57
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9e974000
[DEBUG] GEMM shape: m=128 n=128 k=228 lda=128 ldb=228 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000308212
  time (contract): 3.17313e-05
  gflops: 235.449
-----------------------------------
max element torch :      69.5
max element jit :        69.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=58 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,58,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 58
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000113488
  gflops: 66.9869
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->58];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->232
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->58
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ba91000
[DEBUG] GEMM shape: m=128 n=128 k=232 lda=128 ldb=232 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000374865
  time (contract): 3.20967e-05
  gflops: 236.853
-----------------------------------
max element torch :      70
max element jit :        70
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=59 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,59,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 59
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000113819
  gflops: 67.9436
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->59];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->236
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->59
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb73be000
[DEBUG] GEMM shape: m=128 n=128 k=236 lda=128 ldb=236 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000365009
  time (contract): 3.25666e-05
  gflops: 237.459
-----------------------------------
max element torch :      72.5
max element jit :        72.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=60 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,60,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 60
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000116979
  gflops: 67.2287
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->60];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->240
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->60
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9fe9000
[DEBUG] GEMM shape: m=128 n=128 k=240 lda=128 ldb=240 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000339314
  time (contract): 3.3069e-05
  gflops: 237.815
-----------------------------------
max element torch :      74
max element jit :        74
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=61 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,61,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 61
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000117535
  gflops: 68.0256
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->61];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->244
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->61
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0c1c000
[DEBUG] GEMM shape: m=128 n=128 k=244 lda=128 ldb=244 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320819
  time (contract): 3.36674e-05
  gflops: 237.482
-----------------------------------
max element torch :      73.5
max element jit :        73.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=62 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,62,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 62
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000118498
  gflops: 68.5787
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->62];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->248
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->62
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc312000
[DEBUG] GEMM shape: m=128 n=128 k=248 lda=128 ldb=248 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000337715
  time (contract): 3.41701e-05
  gflops: 237.824
-----------------------------------
max element torch :      75
max element jit :        75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=63 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,63,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 63
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000121217
  gflops: 68.1221
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->63];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->252
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->63
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd8e5000
[DEBUG] GEMM shape: m=128 n=128 k=252 lda=128 ldb=252 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000353969
  time (contract): 3.47887e-05
  gflops: 237.363
-----------------------------------
max element torch :      77.5
max element jit :        77.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=64 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,64,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 64
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000122442
  gflops: 68.5109
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->64];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->256
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->64
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb36ac000
[DEBUG] GEMM shape: m=128 n=128 k=256 lda=128 ldb=256 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324243
  time (contract): 3.54519e-05
  gflops: 236.619
-----------------------------------
max element torch :      79
max element jit :        79
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=65 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,65,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 65
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000125564
  gflops: 67.8513
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->65];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->260
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->65
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb010d000
[DEBUG] GEMM shape: m=128 n=128 k=260 lda=128 ldb=260 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332178
  time (contract): 3.58265e-05
  gflops: 237.804
-----------------------------------
max element torch :      77
max element jit :        77
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=66 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,66,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 66
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000138706
  gflops: 62.3677
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->66];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->264
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->66
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa07cc000
[DEBUG] GEMM shape: m=128 n=128 k=264 lda=128 ldb=264 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000321619
  time (contract): 3.62543e-05
  gflops: 238.613
-----------------------------------
max element torch :      81
max element jit :        81
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=67 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,67,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 67
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000141491
  gflops: 62.0662
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->67];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->268
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->67
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0778000
[DEBUG] GEMM shape: m=128 n=128 k=268 lda=128 ldb=268 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328242
  time (contract): 3.68921e-05
  gflops: 238.041
-----------------------------------
max element torch :      80.5
max element jit :        80.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=68 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,68,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 68
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000141234
  gflops: 63.1071
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->68];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->272
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->68
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa200f000
[DEBUG] GEMM shape: m=128 n=128 k=272 lda=128 ldb=272 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000303668
  time (contract): 3.7284e-05
  gflops: 239.054
-----------------------------------
max element torch :      80.5
max element jit :        80.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=69 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,69,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 69
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00014314
  gflops: 63.1826
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->69];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->276
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->69
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb27f6000
[DEBUG] GEMM shape: m=128 n=128 k=276 lda=128 ldb=276 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324754
  time (contract): 3.77983e-05
  gflops: 239.269
-----------------------------------
max element torch :      81.5
max element jit :        81.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=70 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,70,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 70
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000148634
  gflops: 61.7291
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->70];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->280
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->70
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb40d6000
[DEBUG] GEMM shape: m=128 n=128 k=280 lda=128 ldb=280 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000324915
  time (contract): 3.84097e-05
  gflops: 238.873
-----------------------------------
max element torch :      82
max element jit :        82
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=71 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,71,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 71
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000143961
  gflops: 64.6433
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->71];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->284
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->71
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86b4a000
[DEBUG] GEMM shape: m=128 n=128 k=284 lda=128 ldb=284 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000317043
  time (contract): 3.87992e-05
  gflops: 239.853
-----------------------------------
max element torch :      86
max element jit :        86
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=72 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,72,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 72
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000148141
  gflops: 63.7039
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->72];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->288
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->72
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb6fee000
[DEBUG] GEMM shape: m=128 n=128 k=288 lda=128 ldb=288 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029346
  time (contract): 3.93179e-05
  gflops: 240.022
-----------------------------------
max element torch :      86.5
max element jit :        86.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=73 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,73,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 73
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000150003
  gflops: 63.7872
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->73];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->292
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->73
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff85e60000
[DEBUG] GEMM shape: m=128 n=128 k=292 lda=128 ldb=292 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333651
  time (contract): 3.98414e-05
  gflops: 240.159
-----------------------------------
max element torch :      87
max element jit :        87
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=74 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,74,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 74
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000154087
  gflops: 62.9471
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->74];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->296
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->74
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c489000
[DEBUG] GEMM shape: m=128 n=128 k=296 lda=128 ldb=296 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000294708
  time (contract): 4.04105e-05
  gflops: 240.02
-----------------------------------
max element torch :      88.5
max element jit :        88.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=75 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,75,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 75
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000153908
  gflops: 63.8721
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->75];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->300
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->75
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb93cb000
[DEBUG] GEMM shape: m=128 n=128 k=300 lda=128 ldb=300 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000315699
  time (contract): 4.05747e-05
  gflops: 242.279
-----------------------------------
max element torch :      90.5
max element jit :        90.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=76 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,76,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 76
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000161038
  gflops: 61.8577
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->76];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->304
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->76
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff85c7d000
[DEBUG] GEMM shape: m=128 n=128 k=304 lda=128 ldb=304 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000311731
  time (contract): 4.14801e-05
  gflops: 240.151
-----------------------------------
max element torch :      88
max element jit :        88
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=77 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,77,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 77
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000165508
  gflops: 60.9791
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->77];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->308
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->77
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa80d7000
[DEBUG] GEMM shape: m=128 n=128 k=308 lda=128 ldb=308 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000297268
  time (contract): 4.20051e-05
  gflops: 240.269
-----------------------------------
max element torch :      90
max element jit :        90
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=78 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,78,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 78
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000162567
  gflops: 62.8885
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->78];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->312
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->78
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5160000
[DEBUG] GEMM shape: m=128 n=128 k=312 lda=128 ldb=312 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000345746
  time (contract): 4.2488e-05
  gflops: 240.624
-----------------------------------
max element torch :      92.5
max element jit :        92.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=79 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,79,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 79
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000162387
  gflops: 63.7653
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->79];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->316
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->79
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1c1c000
[DEBUG] GEMM shape: m=128 n=128 k=316 lda=128 ldb=316 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000350961
  time (contract): 4.29629e-05
  gflops: 241.015
-----------------------------------
max element torch :      94
max element jit :        94
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=80 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,80,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 80
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000168888
  gflops: 62.0871
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->80];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->320
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->80
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8944b000
[DEBUG] GEMM shape: m=128 n=128 k=320 lda=128 ldb=320 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327763
  time (contract): 4.3983e-05
  gflops: 238.405
-----------------------------------
max element torch :      93.5
max element jit :        93.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=81 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,81,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 81
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000167493
  gflops: 63.3866
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->81];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->324
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->81
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9551000
[DEBUG] GEMM shape: m=128 n=128 k=324 lda=128 ldb=324 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000315732
  time (contract): 4.40369e-05
  gflops: 241.09
-----------------------------------
max element torch :      95.5
max element jit :        95.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=82 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,82,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 82
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000169046
  gflops: 63.5796
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->82];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->328
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->82
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97930000
[DEBUG] GEMM shape: m=128 n=128 k=328 lda=128 ldb=328 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00034245
  time (contract): 4.42195e-05
  gflops: 243.058
-----------------------------------
max element torch :      95
max element jit :        95
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=83 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,83,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 83
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000173357
  gflops: 62.7546
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->83];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->332
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->83
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbea1f000
[DEBUG] GEMM shape: m=128 n=128 k=332 lda=128 ldb=332 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000366065
  time (contract): 4.52456e-05
  gflops: 240.443
-----------------------------------
max element torch :      98
max element jit :        98
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=84 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,84,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 84
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000172078
  gflops: 63.9828
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->84];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->336
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->84
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9787000
[DEBUG] GEMM shape: m=128 n=128 k=336 lda=128 ldb=336 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320083
  time (contract): 4.55846e-05
  gflops: 241.53
-----------------------------------
max element torch :      98
max element jit :        98
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=85 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,85,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 85
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000175502
  gflops: 63.4814
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->85];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->340
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->85
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffafbe0000
[DEBUG] GEMM shape: m=128 n=128 k=340 lda=128 ldb=340 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000310451
  time (contract): 4.56065e-05
  gflops: 244.288
-----------------------------------
max element torch :      98.5
max element jit :        98.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=86 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,86,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 86
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000177358
  gflops: 63.5561
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->86];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->344
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->86
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa61cb000
[DEBUG] GEMM shape: m=128 n=128 k=344 lda=128 ldb=344 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000348818
  time (contract): 4.62812e-05
  gflops: 243.559
-----------------------------------
max element torch :      100
max element jit :        100
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=87 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,87,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 87
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000176398
  gflops: 64.6452
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->87];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->348
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->87
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff997b6000
[DEBUG] GEMM shape: m=128 n=128 k=348 lda=128 ldb=348 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000318643
  time (contract): 4.70252e-05
  gflops: 242.493
-----------------------------------
max element torch :      106.5
max element jit :        106.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=88 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,88,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 88
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000180199
  gflops: 64.009
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->88];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->352
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->88
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c641000
[DEBUG] GEMM shape: m=128 n=128 k=352 lda=128 ldb=352 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000287157
  time (contract): 4.742e-05
  gflops: 243.238
-----------------------------------
max element torch :      102.5
max element jit :        102.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=89 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,89,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 89
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000178762
  gflops: 65.2568
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->89];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->356
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->89
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa6328000
[DEBUG] GEMM shape: m=128 n=128 k=356 lda=128 ldb=356 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000295828
  time (contract): 4.817e-05
  gflops: 242.172
-----------------------------------
max element torch :      105
max element jit :        105
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=90 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,90,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 90
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000175719
  gflops: 67.1326
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->90];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->360
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->90
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb3ae1000
[DEBUG] GEMM shape: m=128 n=128 k=360 lda=128 ldb=360 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000320531
  time (contract): 4.85483e-05
  gflops: 242.984
-----------------------------------
max element torch :      105
max element jit :        105
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=91 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,91,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 91
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000184767
  gflops: 64.5547
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->91];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->364
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->91
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa4e25000
[DEBUG] GEMM shape: m=128 n=128 k=364 lda=128 ldb=364 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000318291
  time (contract): 4.90151e-05
  gflops: 243.344
-----------------------------------
max element torch :      106
max element jit :        106
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=92 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,92,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 92
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.0001861
  gflops: 64.7964
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->92];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->368
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->92
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb6b10000
[DEBUG] GEMM shape: m=128 n=128 k=368 lda=128 ldb=368 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000340402
  time (contract): 4.95779e-05
  gflops: 243.226
-----------------------------------
max element torch :      108.5
max element jit :        108.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=93 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,93,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 93
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000184758
  gflops: 65.9765
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->93];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->372
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->93
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa6d39000
[DEBUG] GEMM shape: m=128 n=128 k=372 lda=128 ldb=372 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000291444
  time (contract): 5.01846e-05
  gflops: 242.897
-----------------------------------
max element torch :      111.5
max element jit :        111.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=94 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,94,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 94
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000185368
  gflops: 66.4664
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->94];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->376
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->94
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7f30000
[DEBUG] GEMM shape: m=128 n=128 k=376 lda=128 ldb=376 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332243
  time (contract): 5.06321e-05
  gflops: 243.339
-----------------------------------
max element torch :      111
max element jit :        111
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=95 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,95,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 95
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000188064
  gflops: 66.2107
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->95];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->380
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->95
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff83752000
[DEBUG] GEMM shape: m=128 n=128 k=380 lda=128 ldb=380 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000285365
  time (contract): 5.12055e-05
  gflops: 243.174
-----------------------------------
max element torch :      112.5
max element jit :        112.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=96 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,96,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 96
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000189098
  gflops: 66.5418
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->96];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->384
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->96
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b637000
[DEBUG] GEMM shape: m=128 n=128 k=384 lda=128 ldb=384 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000295156
  time (contract): 5.23204e-05
  gflops: 240.497
-----------------------------------
max element torch :      111.5
max element jit :        111.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=97 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,97,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 97
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000183068
  gflops: 69.4493
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->97];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->388
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->97
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88b87000
[DEBUG] GEMM shape: m=128 n=128 k=388 lda=128 ldb=388 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000292948
  time (contract): 5.21391e-05
  gflops: 243.847
-----------------------------------
max element torch :      110.5
max element jit :        110.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=98 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,98,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 98
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.0001987
  gflops: 64.6454
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->98];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->392
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->98
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c13c000
[DEBUG] GEMM shape: m=128 n=128 k=392 lda=128 ldb=392 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000314292
  time (contract): 5.27068e-05
  gflops: 243.708
-----------------------------------
max element torch :      113.5
max element jit :        113.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=99 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,99,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 99
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000197769
  gflops: 65.6127
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->99];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->396
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->99
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8db9d000
[DEBUG] GEMM shape: m=128 n=128 k=396 lda=128 ldb=396 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333874
  time (contract): 5.40865e-05
  gflops: 239.914
-----------------------------------
max element torch :      113
max element jit :        113
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=100 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,100,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 100
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000215861
  gflops: 60.7204
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->100];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->400
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->100
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e19c000
[DEBUG] GEMM shape: m=128 n=128 k=400 lda=128 ldb=400 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00029426
  time (contract): 5.37708e-05
  gflops: 243.761
-----------------------------------
max element torch :      118
max element jit :        118
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=101 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,101,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 101
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000209908
  gflops: 63.0669
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->101];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->404
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->101
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff884e8000
[DEBUG] GEMM shape: m=128 n=128 k=404 lda=128 ldb=404 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000303476
  time (contract): 5.42063e-05
  gflops: 244.22
-----------------------------------
max element torch :      116.5
max element jit :        116.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=102 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,102,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 102
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000217006
  gflops: 61.6083
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->102];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->408
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->102
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ef25000
[DEBUG] GEMM shape: m=128 n=128 k=408 lda=128 ldb=408 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000327123
  time (contract): 5.47014e-05
  gflops: 244.406
-----------------------------------
max element torch :      117
max element jit :        117
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=103 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,103,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 103
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000212099
  gflops: 63.6515
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->103];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->412
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->103
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba9ba000
[DEBUG] GEMM shape: m=128 n=128 k=412 lda=128 ldb=412 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000317907
  time (contract): 5.51758e-05
  gflops: 244.68
-----------------------------------
max element torch :      121.5
max element jit :        121.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=104 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,104,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 104
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000221652
  gflops: 61.4995
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->104];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->416
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->104
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9890b000
[DEBUG] GEMM shape: m=128 n=128 k=416 lda=128 ldb=416 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000332691
  time (contract): 5.585e-05
  gflops: 244.073
-----------------------------------
max element torch :      122
max element jit :        122
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=105 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,105,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 105
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000221842
  gflops: 62.0378
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->105];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->420
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->105
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8dca3000
[DEBUG] GEMM shape: m=128 n=128 k=420 lda=128 ldb=420 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000338994
  time (contract): 5.6247e-05
  gflops: 244.681
-----------------------------------
max element torch :      122.5
max element jit :        122.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=106 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,106,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 106
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000214425
  gflops: 64.795
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->106];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->424
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->106
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b3f0000
[DEBUG] GEMM shape: m=128 n=128 k=424 lda=128 ldb=424 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333618
  time (contract): 5.67033e-05
  gflops: 245.024
-----------------------------------
max element torch :      122
max element jit :        122
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=107 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,107,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 107
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000220395
  gflops: 63.6345
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->107];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->428
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->107
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88063000
[DEBUG] GEMM shape: m=128 n=128 k=428 lda=128 ldb=428 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000329683
  time (contract): 5.71335e-05
  gflops: 245.473
-----------------------------------
max element torch :      127
max element jit :        127
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=108 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,108,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 108
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000224446
  gflops: 63.0699
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->108];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->432
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->108
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff966fd000
[DEBUG] GEMM shape: m=128 n=128 k=432 lda=128 ldb=432 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000316307
  time (contract): 5.79109e-05
  gflops: 244.441
-----------------------------------
max element torch :      126
max element jit :        126
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=109 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,109,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 109
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.00022173
  gflops: 64.4335
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->109];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->436
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->109
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff883eb000
[DEBUG] GEMM shape: m=128 n=128 k=436 lda=128 ldb=436 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00033669
  time (contract): 5.80516e-05
  gflops: 246.106
-----------------------------------
max element torch :      124.5
max element jit :        124.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=110 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,110,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 110
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000224719
  gflops: 64.1599
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->110];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->440
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->110
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff849d2000
[DEBUG] GEMM shape: m=128 n=128 k=440 lda=128 ldb=440 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323378
  time (contract): 5.87113e-05
  gflops: 245.573
-----------------------------------
max element torch :      123.5
max element jit :        123.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=111 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,111,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 111
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000228393
  gflops: 63.7015
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->111];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->444
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->111
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86fa9000
[DEBUG] GEMM shape: m=128 n=128 k=444 lda=128 ldb=444 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000311155
  time (contract): 5.92555e-05
  gflops: 245.53
-----------------------------------
max element torch :      129
max element jit :        129
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=112 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,112,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 112
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000230738
  gflops: 63.6223
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->112];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->448
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->112
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffac622000
[DEBUG] GEMM shape: m=128 n=128 k=448 lda=128 ldb=448 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000323731
  time (contract): 6.05649e-05
  gflops: 242.386
-----------------------------------
max element torch :      127
max element jit :        127
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=113 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,113,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 113
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000233585
  gflops: 63.4079
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->113];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->452
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->113
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad4a4000
[DEBUG] GEMM shape: m=128 n=128 k=452 lda=128 ldb=452 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000298163
  time (contract): 6.03002e-05
  gflops: 245.623
-----------------------------------
max element torch :      130
max element jit :        130
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=114 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,114,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 114
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000233504
  gflops: 63.9912
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->114];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->456
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->114
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7935000
[DEBUG] GEMM shape: m=128 n=128 k=456 lda=128 ldb=456 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000333363
  time (contract): 6.11801e-05
  gflops: 244.233
-----------------------------------
max element torch :      132
max element jit :        132
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=115 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,115,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 115
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000236773
  gflops: 63.6614
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->115];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->460
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->115
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffadfe4000
[DEBUG] GEMM shape: m=128 n=128 k=460 lda=128 ldb=460 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00032581
  time (contract): 6.15218e-05
  gflops: 245.007
-----------------------------------
max element torch :      134
max element jit :        134
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=116 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,116,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 116
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000235778
  gflops: 64.4858
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->116];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->464
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->116
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8f6dc000
[DEBUG] GEMM shape: m=128 n=128 k=464 lda=128 ldb=464 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000317428
  time (contract): 6.17054e-05
  gflops: 246.402
-----------------------------------
max element torch :      137
max element jit :        137
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=117 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,117,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 117
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000241985
  gflops: 63.3735
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->117];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->468
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->117
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb915c000
[DEBUG] GEMM shape: m=128 n=128 k=468 lda=128 ldb=468 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000270901
  time (contract): 6.22337e-05
  gflops: 246.417
-----------------------------------
max element torch :      134
max element jit :        134
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=118 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,118,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 118
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000238934
  gflops: 64.7314
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->118];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->472
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->118
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb38d4000
[DEBUG] GEMM shape: m=128 n=128 k=472 lda=128 ldb=472 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000334578
  time (contract): 6.2687e-05
  gflops: 246.726
-----------------------------------
max element torch :      138
max element jit :        138
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=119 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,119,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 119
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000248552
  gflops: 62.7538
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->119];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->476
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->119
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5cc6000
[DEBUG] GEMM shape: m=128 n=128 k=476 lda=128 ldb=476 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000296628
  time (contract): 6.35511e-05
  gflops: 245.434
-----------------------------------
max element torch :      136
max element jit :        136
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=120 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,120,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 120
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000255571
  gflops: 61.5431
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->120];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->480
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->120
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82e5b000
[DEBUG] GEMM shape: m=128 n=128 k=480 lda=128 ldb=480 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000346962
  time (contract): 6.33697e-05
  gflops: 248.204
-----------------------------------
max element torch :      135
max element jit :        135
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=121 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,121,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 121
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000245236
  gflops: 64.6713
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->121];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->484
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->121
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa2b91000
[DEBUG] GEMM shape: m=128 n=128 k=484 lda=128 ldb=484 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000359058
  time (contract): 6.42466e-05
  gflops: 246.857
-----------------------------------
max element torch :      140
max element jit :        140
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=122 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,122,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 122
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000244848
  gflops: 65.3091
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->122];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->488
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->122
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad6cc000
[DEBUG] GEMM shape: m=128 n=128 k=488 lda=128 ldb=488 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000328243
  time (contract): 6.48512e-05
  gflops: 246.577
-----------------------------------
max element torch :      143
max element jit :        143
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=123 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,123,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 123
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000249521
  gflops: 64.6111
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->123];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->492
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->123
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8dbe000
[DEBUG] GEMM shape: m=128 n=128 k=492 lda=128 ldb=492 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000306452
  time (contract): 6.54438e-05
  gflops: 246.346
-----------------------------------
max element torch :      143
max element jit :        143
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=124 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,124,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 124
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000251734
  gflops: 64.564
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->124];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->496
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->124
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa6c4d000
[DEBUG] GEMM shape: m=128 n=128 k=496 lda=128 ldb=496 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000341138
  time (contract): 6.62147e-05
  gflops: 245.458
-----------------------------------
max element torch :      142
max element jit :        142
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=125 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,125,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 125
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000253648
  gflops: 64.5936
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->125];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->500
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->125
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89058000
[DEBUG] GEMM shape: m=128 n=128 k=500 lda=128 ldb=500 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000289524
  time (contract): 6.6429e-05
  gflops: 246.639
-----------------------------------
max element torch :      142
max element jit :        142
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=126 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,126,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 126
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000259836
  gflops: 63.5596
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->126];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->504
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->126
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8f86000
[DEBUG] GEMM shape: m=128 n=128 k=504 lda=128 ldb=504 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000310483
  time (contract): 6.69622e-05
  gflops: 246.633
-----------------------------------
max element torch :      145
max element jit :        145
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=127 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,127,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 127
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000255008
  gflops: 65.277
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->127];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->508
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->127
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1514000
[DEBUG] GEMM shape: m=128 n=128 k=508 lda=128 ldb=508 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.00032149
  time (contract): 6.8195e-05
  gflops: 244.096
-----------------------------------
max element torch :      145
max element jit :        145
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing l=128 (M=128, N=128, K=4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "lmk,nlk->nm" "4,128,128,128" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  l,m,k
  n,l,k
  n,m
parsed dimension ids:
  k: 0
  l: 1
  m: 2
  n: 3
parsed dimension sizes:
  k: 4
  l: 128
  m: 128
  n: 128
dtype: BF16
BF16 VNNI test:
left Tensor has VNNI-A Layout
at::einsum:
  time (contract): 0.000269489
  gflops: 62.2558
einsum_ir:
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
3 
3 
--------
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 1
o_dim_ids_kb[1] = 0
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         3
m_num_dims_out           2
l_dim_ids_left_active    1
                         0
                         2
l_dim_ids_right_active   3
                         1
                         0
m_dim_ids_out            3
                         2
m_dim_sizes_inner        [0->4];[1->128];[2->128];[3->128]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             3
l_dim_ids_kb             1,0
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->128
1                        ->512
2                        ->1
l_strides_right          
0                        ->1
1                        ->4
3                        ->512
l_strides_out            
2                        ->1
3                        ->128
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->4
1                        ->128
2                        ->128
3                        ->128
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0115000
[DEBUG] GEMM shape: m=128 n=128 k=512 lda=128 ldb=512 ldc=128
[DEBUG] dim_types_out: 2 1 
m_num_loops: 0
JIT compile err: 0
  time (compile): 0.000286741
  time (contract): 6.90704e-05
  gflops: 242.9
-----------------------------------
max element torch :      147
max element jit :        147
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


