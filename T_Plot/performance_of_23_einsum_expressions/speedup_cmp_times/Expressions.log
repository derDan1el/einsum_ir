=== Benchmark Log Started: Mon Jun  9 11:02:49 PM CEST 2025 ===

=== Testing: abdfe,cf->abcde with dimensions: 48,36,24,36,48,36 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abdfe,cf->abcde" "48,36,24,36,48,36" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,d,f,e
  c,f
  a,b,c,d,e
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 48
  b: 36
  c: 24
  d: 36
  e: 48
  f: 36
dtype: BF16
at::einsum:
  time (contract): 0.0987639
  gflops: 52.2436
einsum_ir:
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          5
m_num_dims_right         2
m_num_dims_out           5
l_dim_ids_left_active    0
                         1
                         3
                         5
                         4
l_dim_ids_right_active   2
                         5
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->48];[1->36];[2->24];[3->36];[4->48];[5->36]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             2
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->2239488
1                        ->62208
3                        ->1728
4                        ->1
5                        ->48
l_strides_right          
2                        ->36
5                        ->1
l_strides_out            
0                        ->1492992
1                        ->41472
2                        ->1728
3                        ->48
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->48
1                        ->36
2                        ->24
3                        ->36
4                        ->48
5                        ->36
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97b05000
[DEBUG] GEMM shape: m=48 n=24 k=36 lda=48 ldb=36 ldc=1728
[DEBUG] dim_types_out: 1 1 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000421007
  time (contract): 0.0529424
  gflops: 97.4602
-----------------------------------
max element torch :      15.5
max element jit :        15.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abdfe,cf->abcde" "48,36,24,36,48,36" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,d,f,e
  c,f
  a,b,c,d,e
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 48
  b: 36
  c: 24
  d: 36
  e: 48
  f: 36
dtype: FP32
at::einsum:
  time (contract): 0.142412
  gflops: 36.2313
einsum_ir:
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          5
m_num_dims_right         2
m_num_dims_out           5
l_dim_ids_left_active    0
                         1
                         3
                         5
                         4
l_dim_ids_right_active   2
                         5
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->48];[1->36];[2->24];[3->36];[4->48];[5->36]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             2
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->2239488
1                        ->62208
3                        ->1728
4                        ->1
5                        ->48
l_strides_right          
2                        ->36
5                        ->1
l_strides_out            
0                        ->1492992
1                        ->41472
2                        ->1728
3                        ->48
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->48
1                        ->36
2                        ->24
3                        ->36
4                        ->48
5                        ->36
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8322e000
[DEBUG] GEMM shape: m=48 n=24 k=36 lda=48 ldb=36 ldc=1728
[DEBUG] dim_types_out: 1 1 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000454094
  time (contract): 0.0947504
  gflops: 54.4566

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abdfe,cf->abcde" "48,36,24,36,48,36" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,d,f,e
  c,f
  a,b,c,d,e
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 48
  b: 36
  c: 24
  d: 36
  e: 48
  f: 36
dtype: FP64
at::einsum:
  time (contract): 0.586696
  gflops: 8.79465
einsum_ir:
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          5
m_num_dims_right         2
m_num_dims_out           5
l_dim_ids_left_active    0
                         1
                         3
                         5
                         4
l_dim_ids_right_active   2
                         5
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->48];[1->36];[2->24];[3->36];[4->48];[5->36]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             2
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->2239488
1                        ->62208
3                        ->1728
4                        ->1
5                        ->48
l_strides_right          
2                        ->36
5                        ->1
l_strides_out            
0                        ->1492992
1                        ->41472
2                        ->1728
3                        ->48
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->48
1                        ->36
2                        ->24
3                        ->36
4                        ->48
5                        ->36
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa2c69000
[DEBUG] GEMM shape: m=48 n=24 k=36 lda=48 ldb=36 ldc=1728
[DEBUG] dim_types_out: 1 1 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000412559
  time (contract): 0.180925
  gflops: 28.5189

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: acdfe,bf->abcde with dimensions: 48,24,36,36,48,36 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "acdfe,bf->abcde" "48,24,36,36,48,36" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  a,c,d,f,e
  b,f
  a,b,c,d,e
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 48
  b: 24
  c: 36
  d: 36
  e: 48
  f: 36
dtype: BF16
at::einsum:
  time (contract): 0.0961092
  gflops: 53.6867
einsum_ir:
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          5
m_num_dims_right         2
m_num_dims_out           5
l_dim_ids_left_active    0
                         2
                         3
                         5
                         4
l_dim_ids_right_active   1
                         5
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->48];[1->24];[2->36];[3->36];[4->48];[5->36]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             1
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->2239488
2                        ->62208
3                        ->1728
4                        ->1
5                        ->48
l_strides_right          
1                        ->36
5                        ->1
l_strides_out            
0                        ->1492992
1                        ->62208
2                        ->1728
3                        ->48
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->48
1                        ->24
2                        ->36
3                        ->36
4                        ->48
5                        ->36
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90a37000
[DEBUG] GEMM shape: m=48 n=24 k=36 lda=48 ldb=36 ldc=62208
[DEBUG] dim_types_out: 1 2 1 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000450509
  time (contract): 0.0515281
  gflops: 100.135
-----------------------------------
max element torch :      15.1875
max element jit :        15.1875
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "acdfe,bf->abcde" "48,24,36,36,48,36" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  a,c,d,f,e
  b,f
  a,b,c,d,e
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 48
  b: 24
  c: 36
  d: 36
  e: 48
  f: 36
dtype: FP32
at::einsum:
  time (contract): 0.142257
  gflops: 36.2708
einsum_ir:
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          5
m_num_dims_right         2
m_num_dims_out           5
l_dim_ids_left_active    0
                         2
                         3
                         5
                         4
l_dim_ids_right_active   1
                         5
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->48];[1->24];[2->36];[3->36];[4->48];[5->36]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             1
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->2239488
2                        ->62208
3                        ->1728
4                        ->1
5                        ->48
l_strides_right          
1                        ->36
5                        ->1
l_strides_out            
0                        ->1492992
1                        ->62208
2                        ->1728
3                        ->48
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->48
1                        ->24
2                        ->36
3                        ->36
4                        ->48
5                        ->36
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb90ea000
[DEBUG] GEMM shape: m=48 n=24 k=36 lda=48 ldb=36 ldc=62208
[DEBUG] dim_types_out: 1 2 1 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000465389
  time (contract): 0.0939569
  gflops: 54.9165

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "acdfe,bf->abcde" "48,24,36,36,48,36" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  a,c,d,f,e
  b,f
  a,b,c,d,e
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 48
  b: 24
  c: 36
  d: 36
  e: 48
  f: 36
dtype: FP64
at::einsum:
  time (contract): 0.585899
  gflops: 8.8066
einsum_ir:
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          5
m_num_dims_right         2
m_num_dims_out           5
l_dim_ids_left_active    0
                         2
                         3
                         5
                         4
l_dim_ids_right_active   1
                         5
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->48];[1->24];[2->36];[3->36];[4->48];[5->36]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             1
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->2239488
2                        ->62208
3                        ->1728
4                        ->1
5                        ->48
l_strides_right          
1                        ->36
5                        ->1
l_strides_out            
0                        ->1492992
1                        ->62208
2                        ->1728
3                        ->48
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->48
1                        ->24
2                        ->36
3                        ->36
4                        ->48
5                        ->36
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7f7d2000
[DEBUG] GEMM shape: m=48 n=24 k=36 lda=48 ldb=36 ldc=62208
[DEBUG] dim_types_out: 1 2 1 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000453261
  time (contract): 0.180023
  gflops: 28.6618

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: abed,ce->abcd with dimensions: 96,84,24,96,96 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abed,ce->abcd" "96,84,24,96,96" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,e,d
  c,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 24
  d: 96
  e: 96
dtype: BF16
at::einsum:
  time (contract): 0.0608994
  gflops: 58.5762
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         1
                         4
                         3
l_dim_ids_right_active   2
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->24];[3->96];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->774144
1                        ->9216
3                        ->1
4                        ->96
l_strides_right          
2                        ->96
4                        ->1
l_strides_out            
0                        ->193536
1                        ->2304
2                        ->96
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->24
3                        ->96
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb204d000
[DEBUG] GEMM shape: m=96 n=24 k=96 lda=96 ldb=96 ldc=96
[DEBUG] dim_types_out: 1 1 2 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000428719
  time (contract): 0.0258371
  gflops: 138.067
-----------------------------------
max element torch :      34
max element jit :        34
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abed,ce->abcd" "96,84,24,96,96" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,e,d
  c,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 24
  d: 96
  e: 96
dtype: FP32
at::einsum:
  time (contract): 0.0957883
  gflops: 37.241
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         1
                         4
                         3
l_dim_ids_right_active   2
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->24];[3->96];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->774144
1                        ->9216
3                        ->1
4                        ->96
l_strides_right          
2                        ->96
4                        ->1
l_strides_out            
0                        ->193536
1                        ->2304
2                        ->96
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->24
3                        ->96
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91ee7000
[DEBUG] GEMM shape: m=96 n=24 k=96 lda=96 ldb=96 ldc=96
[DEBUG] dim_types_out: 1 1 2 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000325651
  time (contract): 0.0542955
  gflops: 65.7007

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abed,ce->abcd" "96,84,24,96,96" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,e,d
  c,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 24
  d: 96
  e: 96
dtype: FP64
at::einsum:
  time (contract): 0.321568
  gflops: 11.0933
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         1
                         4
                         3
l_dim_ids_right_active   2
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->24];[3->96];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->774144
1                        ->9216
3                        ->1
4                        ->96
l_strides_right          
2                        ->96
4                        ->1
l_strides_out            
0                        ->193536
1                        ->2304
2                        ->96
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->24
3                        ->96
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff870d5000
[DEBUG] GEMM shape: m=96 n=24 k=96 lda=96 ldb=96 ldc=96
[DEBUG] dim_types_out: 1 1 2 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000407408
  time (contract): 0.103527
  gflops: 34.4574

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: abcfe,df->abcde with dimensions: 48,36,36,24,48,48 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abcfe,df->abcde" "48,36,36,24,48,48" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,c,f,e
  d,f
  a,b,c,d,e
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 48
  b: 36
  c: 36
  d: 24
  e: 48
  f: 48
dtype: BF16
at::einsum:
  time (contract): 0.126012
  gflops: 54.5958
einsum_ir:
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
1 
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
1 
2 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          5
m_num_dims_right         2
m_num_dims_out           5
l_dim_ids_left_active    0
                         1
                         2
                         5
                         4
l_dim_ids_right_active   3
                         5
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->48];[1->36];[2->36];[3->24];[4->48];[5->48]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             3
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->2985984
1                        ->82944
2                        ->2304
4                        ->1
5                        ->48
l_strides_right          
3                        ->48
5                        ->1
l_strides_out            
0                        ->1492992
1                        ->41472
2                        ->1152
3                        ->48
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->48
1                        ->36
2                        ->36
3                        ->24
4                        ->48
5                        ->48
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8175f000
[DEBUG] GEMM shape: m=48 n=24 k=48 lda=48 ldb=48 ldc=48
[DEBUG] dim_types_out: 1 1 1 2 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000451822
  time (contract): 0.0641122
  gflops: 107.307
-----------------------------------
max element torch :      21.125
max element jit :        21.125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abcfe,df->abcde" "48,36,36,24,48,48" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,c,f,e
  d,f
  a,b,c,d,e
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 48
  b: 36
  c: 36
  d: 24
  e: 48
  f: 48
dtype: FP32
at::einsum:
  time (contract): 0.180468
  gflops: 38.1215
einsum_ir:
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
1 
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
1 
2 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          5
m_num_dims_right         2
m_num_dims_out           5
l_dim_ids_left_active    0
                         1
                         2
                         5
                         4
l_dim_ids_right_active   3
                         5
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->48];[1->36];[2->36];[3->24];[4->48];[5->48]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             3
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->2985984
1                        ->82944
2                        ->2304
4                        ->1
5                        ->48
l_strides_right          
3                        ->48
5                        ->1
l_strides_out            
0                        ->1492992
1                        ->41472
2                        ->1152
3                        ->48
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->48
1                        ->36
2                        ->36
3                        ->24
4                        ->48
5                        ->48
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa79d3000
[DEBUG] GEMM shape: m=48 n=24 k=48 lda=48 ldb=48 ldc=48
[DEBUG] dim_types_out: 1 1 1 2 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000379216
  time (contract): 0.114172
  gflops: 60.2575

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abcfe,df->abcde" "48,36,36,24,48,48" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,c,f,e
  d,f
  a,b,c,d,e
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 48
  b: 36
  c: 36
  d: 24
  e: 48
  f: 48
dtype: FP64
at::einsum:
  time (contract): 0.702195
  gflops: 9.79743
einsum_ir:
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
1 
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
1 
2 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          5
m_num_dims_right         2
m_num_dims_out           5
l_dim_ids_left_active    0
                         1
                         2
                         5
                         4
l_dim_ids_right_active   3
                         5
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->48];[1->36];[2->36];[3->24];[4->48];[5->48]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             3
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->2985984
1                        ->82944
2                        ->2304
4                        ->1
5                        ->48
l_strides_right          
3                        ->48
5                        ->1
l_strides_out            
0                        ->1492992
1                        ->41472
2                        ->1152
3                        ->48
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->48
1                        ->36
2                        ->36
3                        ->24
4                        ->48
5                        ->48
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffae72c000
[DEBUG] GEMM shape: m=48 n=24 k=48 lda=48 ldb=48 ldc=48
[DEBUG] dim_types_out: 1 1 1 2 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000583017
  time (contract): 0.251848
  gflops: 27.317

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: aced,be->abcd with dimensions: 96,24,84,96,84 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "aced,be->abcd" "96,24,84,96,84" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  a,c,e,d
  b,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 24
  c: 84
  d: 96
  e: 84
dtype: BF16
at::einsum:
  time (contract): 0.0541966
  gflops: 57.593
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         2
                         4
                         3
l_dim_ids_right_active   1
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->24];[2->84];[3->96];[4->84]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
2                        ->8064
3                        ->1
4                        ->96
l_strides_right          
1                        ->84
4                        ->1
l_strides_out            
0                        ->193536
1                        ->8064
2                        ->96
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->24
2                        ->84
3                        ->96
4                        ->84
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1f0f000
[DEBUG] GEMM shape: m=96 n=24 k=84 lda=96 ldb=84 ldc=8064
[DEBUG] dim_types_out: 1 2 1 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000492044
  time (contract): 0.0234478
  gflops: 133.119
-----------------------------------
max element torch :      31.125
max element jit :        31.125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "aced,be->abcd" "96,24,84,96,84" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  a,c,e,d
  b,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 24
  c: 84
  d: 96
  e: 84
dtype: FP32
at::einsum:
  time (contract): 0.0854106
  gflops: 36.5452
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         2
                         4
                         3
l_dim_ids_right_active   1
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->24];[2->84];[3->96];[4->84]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
2                        ->8064
3                        ->1
4                        ->96
l_strides_right          
1                        ->84
4                        ->1
l_strides_out            
0                        ->193536
1                        ->8064
2                        ->96
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->24
2                        ->84
3                        ->96
4                        ->84
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff848f8000
[DEBUG] GEMM shape: m=96 n=24 k=84 lda=96 ldb=84 ldc=8064
[DEBUG] dim_types_out: 1 2 1 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000414192
  time (contract): 0.0485652
  gflops: 64.2713

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "aced,be->abcd" "96,24,84,96,84" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  a,c,e,d
  b,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 24
  c: 84
  d: 96
  e: 84
dtype: FP64
at::einsum:
  time (contract): 0.291636
  gflops: 10.7029
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         2
                         4
                         3
l_dim_ids_right_active   1
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->24];[2->84];[3->96];[4->84]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
2                        ->8064
3                        ->1
4                        ->96
l_strides_right          
1                        ->84
4                        ->1
l_strides_out            
0                        ->193536
1                        ->8064
2                        ->96
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->24
2                        ->84
3                        ->96
4                        ->84
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8fc26000
[DEBUG] GEMM shape: m=96 n=24 k=84 lda=96 ldb=84 ldc=8064
[DEBUG] dim_types_out: 1 2 1 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.00044587
  time (contract): 0.0918095
  gflops: 33.9981

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: jki,efghjk->efghi with dimensions: 6,64,6,64,24,6,64 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "jki,efghjk->efghi" "6,64,6,64,24,6,64" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  j,k,i
  e,f,g,h,j,k
  e,f,g,h,i
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
parsed dimension sizes:
  e: 6
  f: 64
  g: 6
  h: 64
  i: 24
  j: 6
  k: 64
dtype: BF16
at::einsum:
  time (contract): 0.164946
  gflops: 16.4776
einsum_ir:
3 
3 
1 
--------
2 
2 
2 
2 
3 
3 
--------
2 
2 
2 
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
3 
1 
--------
2 
2 
2 
2 
3 
3 
--------
2 
2 
2 
2 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 5
o_dim_ids_kb[1] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         6
m_num_dims_out           5
l_dim_ids_left_active    5
                         6
                         4
l_dim_ids_right_active   0
                         1
                         2
                         3
                         5
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->6];[1->64];[2->6];[3->64];[4->24];[5->6];[6->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             3
l_dim_ids_kb             5,6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
4                        ->1
5                        ->1536
6                        ->24
l_strides_right          
0                        ->9437184
1                        ->147456
2                        ->24576
3                        ->384
5                        ->64
6                        ->1
l_strides_out            
0                        ->589824
1                        ->9216
2                        ->1536
3                        ->24
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->6
3                        ->64
4                        ->24
5                        ->6
6                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82631000
[DEBUG] GEMM shape: m=24 n=64 k=384 lda=24 ldb=384 ldc=24
[DEBUG] dim_types_out: 2 2 2 2 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000473132
  time (contract): 0.0164794
  gflops: 164.928
-----------------------------------
max element torch :      117.5
max element jit :        117.5
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "jki,efghjk->efghi" "6,64,6,64,24,6,64" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  j,k,i
  e,f,g,h,j,k
  e,f,g,h,i
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
parsed dimension sizes:
  e: 6
  f: 64
  g: 6
  h: 64
  i: 24
  j: 6
  k: 64
dtype: FP32
at::einsum:
  time (contract): 0.238182
  gflops: 11.4111
einsum_ir:
3 
3 
1 
--------
2 
2 
2 
2 
3 
3 
--------
2 
2 
2 
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
3 
3 
1 
--------
2 
2 
2 
2 
3 
3 
--------
2 
2 
2 
2 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 5
o_dim_ids_kb[1] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         6
m_num_dims_out           5
l_dim_ids_left_active    5
                         6
                         4
l_dim_ids_right_active   0
                         1
                         2
                         3
                         5
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->6];[1->64];[2->6];[3->64];[4->24];[5->6];[6->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             3
l_dim_ids_kb             5,6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
4                        ->1
5                        ->1536
6                        ->24
l_strides_right          
0                        ->9437184
1                        ->147456
2                        ->24576
3                        ->384
5                        ->64
6                        ->1
l_strides_out            
0                        ->589824
1                        ->9216
2                        ->1536
3                        ->24
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->6
3                        ->64
4                        ->24
5                        ->6
6                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff924e8000
[DEBUG] GEMM shape: m=24 n=64 k=384 lda=24 ldb=384 ldc=24
[DEBUG] dim_types_out: 2 2 2 2 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000445294
  time (contract): 0.0532657
  gflops: 51.0255

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "jki,efghjk->efghi" "6,64,6,64,24,6,64" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  j,k,i
  e,f,g,h,j,k
  e,f,g,h,i
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
parsed dimension sizes:
  e: 6
  f: 64
  g: 6
  h: 64
  i: 24
  j: 6
  k: 64
dtype: FP64
at::einsum:
  time (contract): 0.104389
  gflops: 26.0362
einsum_ir:
3 
3 
1 
--------
2 
2 
2 
2 
3 
3 
--------
2 
2 
2 
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
3 
3 
1 
--------
2 
2 
2 
2 
3 
3 
--------
2 
2 
2 
2 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          3
m_num_dims_right         6
m_num_dims_out           5
l_dim_ids_left_active    5
                         6
                         4
l_dim_ids_right_active   0
                         1
                         2
                         3
                         5
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->6];[1->64];[2->6];[3->64];[4->24];[5->6];[6->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             3
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
4                        ->1
5                        ->1536
6                        ->24
l_strides_right          
0                        ->9437184
1                        ->147456
2                        ->24576
3                        ->384
5                        ->64
6                        ->1
l_strides_out            
0                        ->589824
1                        ->9216
2                        ->1536
3                        ->24
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->6
3                        ->64
4                        ->24
5                        ->6
6                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92551000
[DEBUG] GEMM shape: m=24 n=64 k=64 lda=24 ldb=384 ldc=24
[DEBUG] dim_types_out: 2 2 2 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00069578
  time (contract): 0.104103
  gflops: 26.108

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: abed,ce->abcd with dimensions: 96,84,24,84,96 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abed,ce->abcd" "96,84,24,84,96" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,e,d
  c,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 24
  d: 84
  e: 96
dtype: BF16
at::einsum:
  time (contract): 0.0527766
  gflops: 59.1427
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         1
                         4
                         3
l_dim_ids_right_active   2
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->24];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
1                        ->8064
3                        ->1
4                        ->84
l_strides_right          
2                        ->96
4                        ->1
l_strides_out            
0                        ->169344
1                        ->2016
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->24
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94714000
[DEBUG] GEMM shape: m=84 n=24 k=96 lda=84 ldb=96 ldc=84
[DEBUG] dim_types_out: 1 1 2 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000429614
  time (contract): 0.0372718
  gflops: 83.7456
-----------------------------------
max element torch :      36.25
max element jit :        36.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abed,ce->abcd" "96,84,24,84,96" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,e,d
  c,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 24
  d: 84
  e: 96
dtype: FP32
at::einsum:
  time (contract): 0.0835659
  gflops: 37.352
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         1
                         4
                         3
l_dim_ids_right_active   2
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->24];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
1                        ->8064
3                        ->1
4                        ->84
l_strides_right          
2                        ->96
4                        ->1
l_strides_out            
0                        ->169344
1                        ->2016
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->24
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff848e3000
[DEBUG] GEMM shape: m=84 n=24 k=96 lda=84 ldb=96 ldc=84
[DEBUG] dim_types_out: 1 1 2 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000442862
  time (contract): 0.0559246
  gflops: 55.8135

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abed,ce->abcd" "96,84,24,84,96" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,e,d
  c,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 24
  d: 84
  e: 96
dtype: FP64
at::einsum:
  time (contract): 0.281892
  gflops: 11.0729
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         1
                         4
                         3
l_dim_ids_right_active   2
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->24];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
1                        ->8064
3                        ->1
4                        ->84
l_strides_right          
2                        ->96
4                        ->1
l_strides_out            
0                        ->169344
1                        ->2016
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->24
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5b88000
[DEBUG] GEMM shape: m=84 n=24 k=96 lda=84 ldb=96 ldc=84
[DEBUG] dim_types_out: 1 1 2 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000474412
  time (contract): 0.105937
  gflops: 29.4641

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: bcgf,adeg->abcdef with dimensions: 24,20,20,24,20,20,24 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "bcgf,adeg->abcdef" "24,20,20,24,20,20,24" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  b,c,g,f
  a,d,e,g
  a,b,c,d,e,f
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
  g: 6
parsed dimension sizes:
  a: 24
  b: 20
  c: 20
  d: 24
  e: 20
  f: 20
  g: 24
dtype: BF16
at::einsum:
  time (contract): 0.0367481
  gflops: 120.378
einsum_ir:
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
2 
1 
1 
2 
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
2 
1 
1 
2 
2 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 4
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    1
                         2
                         6
                         5
l_dim_ids_right_active   0
                         3
                         4
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->24];[1->20];[2->20];[3->24];[4->20];[5->20];[6->24]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             4
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
1                        ->9600
2                        ->480
5                        ->1
6                        ->20
l_strides_right          
0                        ->11520
3                        ->480
4                        ->24
6                        ->1
l_strides_out            
0                        ->3840000
1                        ->192000
2                        ->9600
3                        ->400
4                        ->20
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->20
2                        ->20
3                        ->24
4                        ->20
5                        ->20
6                        ->24
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92a3c000
[DEBUG] GEMM shape: m=20 n=20 k=24 lda=20 ldb=24 ldc=20
[DEBUG] dim_types_out: 2 1 1 2 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000441134
  time (contract): 0.0844594
  gflops: 52.3764
-----------------------------------
max element torch :      12.625
max element jit :        12.625
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "bcgf,adeg->abcdef" "24,20,20,24,20,20,24" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  b,c,g,f
  a,d,e,g
  a,b,c,d,e,f
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
  g: 6
parsed dimension sizes:
  a: 24
  b: 20
  c: 20
  d: 24
  e: 20
  f: 20
  g: 24
dtype: FP32
at::einsum:
  time (contract): 0.0583792
  gflops: 75.775
einsum_ir:
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
2 
1 
1 
2 
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
2 
1 
1 
2 
2 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 4
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    1
                         2
                         6
                         5
l_dim_ids_right_active   0
                         3
                         4
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->24];[1->20];[2->20];[3->24];[4->20];[5->20];[6->24]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             4
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
1                        ->9600
2                        ->480
5                        ->1
6                        ->20
l_strides_right          
0                        ->11520
3                        ->480
4                        ->24
6                        ->1
l_strides_out            
0                        ->3840000
1                        ->192000
2                        ->9600
3                        ->400
4                        ->20
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->20
2                        ->20
3                        ->24
4                        ->20
5                        ->20
6                        ->24
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1386000
[DEBUG] GEMM shape: m=20 n=20 k=24 lda=20 ldb=24 ldc=20
[DEBUG] dim_types_out: 2 1 1 2 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000438638
  time (contract): 0.0868687
  gflops: 50.9237

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "bcgf,adeg->abcdef" "24,20,20,24,20,20,24" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  b,c,g,f
  a,d,e,g
  a,b,c,d,e,f
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
  g: 6
parsed dimension sizes:
  a: 24
  b: 20
  c: 20
  d: 24
  e: 20
  f: 20
  g: 24
dtype: FP64
at::einsum:
  time (contract): 0.552429
  gflops: 8.00769
einsum_ir:
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
2 
1 
1 
2 
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
2 
1 
1 
2 
2 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 4
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    1
                         2
                         6
                         5
l_dim_ids_right_active   0
                         3
                         4
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->24];[1->20];[2->20];[3->24];[4->20];[5->20];[6->24]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             4
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
1                        ->9600
2                        ->480
5                        ->1
6                        ->20
l_strides_right          
0                        ->11520
3                        ->480
4                        ->24
6                        ->1
l_strides_out            
0                        ->3840000
1                        ->192000
2                        ->9600
3                        ->400
4                        ->20
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->20
2                        ->20
3                        ->24
4                        ->20
5                        ->20
6                        ->24
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab3cb000
[DEBUG] GEMM shape: m=20 n=20 k=24 lda=20 ldb=24 ldc=20
[DEBUG] dim_types_out: 2 1 1 2 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00058084
  time (contract): 0.17525
  gflops: 25.2421

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: bdgf,aceg->abcdef with dimensions: 24,20,20,24,20,20,24 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "bdgf,aceg->abcdef" "24,20,20,24,20,20,24" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  b,d,g,f
  a,c,e,g
  a,b,c,d,e,f
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
  g: 6
parsed dimension sizes:
  a: 24
  b: 20
  c: 20
  d: 24
  e: 20
  f: 20
  g: 24
dtype: BF16
at::einsum:
  time (contract): 0.0369498
  gflops: 119.721
einsum_ir:
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
2 
1 
2 
1 
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
2 
1 
2 
1 
2 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 4
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    1
                         3
                         6
                         5
l_dim_ids_right_active   0
                         2
                         4
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->24];[1->20];[2->20];[3->24];[4->20];[5->20];[6->24]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             4
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
1                        ->11520
3                        ->480
5                        ->1
6                        ->20
l_strides_right          
0                        ->9600
2                        ->480
4                        ->24
6                        ->1
l_strides_out            
0                        ->3840000
1                        ->192000
2                        ->9600
3                        ->400
4                        ->20
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->20
2                        ->20
3                        ->24
4                        ->20
5                        ->20
6                        ->24
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb3923000
[DEBUG] GEMM shape: m=20 n=20 k=24 lda=20 ldb=24 ldc=20
[DEBUG] dim_types_out: 2 1 2 1 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000484204
  time (contract): 0.0827556
  gflops: 53.4547
-----------------------------------
max element torch :      13.5625
max element jit :        13.5625
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "bdgf,aceg->abcdef" "24,20,20,24,20,20,24" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  b,d,g,f
  a,c,e,g
  a,b,c,d,e,f
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
  g: 6
parsed dimension sizes:
  a: 24
  b: 20
  c: 20
  d: 24
  e: 20
  f: 20
  g: 24
dtype: FP32
at::einsum:
  time (contract): 0.0592158
  gflops: 74.7044
einsum_ir:
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
2 
1 
2 
1 
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
2 
1 
2 
1 
2 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 4
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    1
                         3
                         6
                         5
l_dim_ids_right_active   0
                         2
                         4
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->24];[1->20];[2->20];[3->24];[4->20];[5->20];[6->24]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             4
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
1                        ->11520
3                        ->480
5                        ->1
6                        ->20
l_strides_right          
0                        ->9600
2                        ->480
4                        ->24
6                        ->1
l_strides_out            
0                        ->3840000
1                        ->192000
2                        ->9600
3                        ->400
4                        ->20
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->20
2                        ->20
3                        ->24
4                        ->20
5                        ->20
6                        ->24
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8f9ea000
[DEBUG] GEMM shape: m=20 n=20 k=24 lda=20 ldb=24 ldc=20
[DEBUG] dim_types_out: 2 1 2 1 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000478861
  time (contract): 0.0872243
  gflops: 50.7161

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "bdgf,aceg->abcdef" "24,20,20,24,20,20,24" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  b,d,g,f
  a,c,e,g
  a,b,c,d,e,f
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
  g: 6
parsed dimension sizes:
  a: 24
  b: 20
  c: 20
  d: 24
  e: 20
  f: 20
  g: 24
dtype: FP64
at::einsum:
  time (contract): 0.537354
  gflops: 8.23234
einsum_ir:
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
2 
1 
2 
1 
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
2 
1 
2 
1 
2 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 4
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    1
                         3
                         6
                         5
l_dim_ids_right_active   0
                         2
                         4
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->24];[1->20];[2->20];[3->24];[4->20];[5->20];[6->24]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             4
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
1                        ->11520
3                        ->480
5                        ->1
6                        ->20
l_strides_right          
0                        ->9600
2                        ->480
4                        ->24
6                        ->1
l_strides_out            
0                        ->3840000
1                        ->192000
2                        ->9600
3                        ->400
4                        ->20
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->20
2                        ->20
3                        ->24
4                        ->20
5                        ->20
6                        ->24
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9848a000
[DEBUG] GEMM shape: m=20 n=20 k=24 lda=20 ldb=24 ldc=20
[DEBUG] dim_types_out: 2 1 2 1 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000429454
  time (contract): 0.166142
  gflops: 26.626

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: acgf,bdeg->abcdef with dimensions: 24,20,20,24,20,20,24 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "acgf,bdeg->abcdef" "24,20,20,24,20,20,24" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  a,c,g,f
  b,d,e,g
  a,b,c,d,e,f
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
  g: 6
parsed dimension sizes:
  a: 24
  b: 20
  c: 20
  d: 24
  e: 20
  f: 20
  g: 24
dtype: BF16
at::einsum:
  time (contract): 0.0368206
  gflops: 120.142
einsum_ir:
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
1 
2 
1 
2 
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
1 
2 
1 
2 
2 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 4
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    0
                         2
                         6
                         5
l_dim_ids_right_active   1
                         3
                         4
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->24];[1->20];[2->20];[3->24];[4->20];[5->20];[6->24]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             4
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9600
2                        ->480
5                        ->1
6                        ->20
l_strides_right          
1                        ->11520
3                        ->480
4                        ->24
6                        ->1
l_strides_out            
0                        ->3840000
1                        ->192000
2                        ->9600
3                        ->400
4                        ->20
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->20
2                        ->20
3                        ->24
4                        ->20
5                        ->20
6                        ->24
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86e64000
[DEBUG] GEMM shape: m=20 n=20 k=24 lda=20 ldb=24 ldc=20
[DEBUG] dim_types_out: 1 2 1 2 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000450958
  time (contract): 0.0853221
  gflops: 51.8468
-----------------------------------
max element torch :      12.25
max element jit :        12.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "acgf,bdeg->abcdef" "24,20,20,24,20,20,24" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  a,c,g,f
  b,d,e,g
  a,b,c,d,e,f
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
  g: 6
parsed dimension sizes:
  a: 24
  b: 20
  c: 20
  d: 24
  e: 20
  f: 20
  g: 24
dtype: FP32
at::einsum:
  time (contract): 0.0590778
  gflops: 74.8789
einsum_ir:
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
1 
2 
1 
2 
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
1 
2 
1 
2 
2 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 4
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    0
                         2
                         6
                         5
l_dim_ids_right_active   1
                         3
                         4
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->24];[1->20];[2->20];[3->24];[4->20];[5->20];[6->24]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             4
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9600
2                        ->480
5                        ->1
6                        ->20
l_strides_right          
1                        ->11520
3                        ->480
4                        ->24
6                        ->1
l_strides_out            
0                        ->3840000
1                        ->192000
2                        ->9600
3                        ->400
4                        ->20
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->20
2                        ->20
3                        ->24
4                        ->20
5                        ->20
6                        ->24
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa267f000
[DEBUG] GEMM shape: m=20 n=20 k=24 lda=20 ldb=24 ldc=20
[DEBUG] dim_types_out: 1 2 1 2 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00044379
  time (contract): 0.0873172
  gflops: 50.6622

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "acgf,bdeg->abcdef" "24,20,20,24,20,20,24" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  a,c,g,f
  b,d,e,g
  a,b,c,d,e,f
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
  g: 6
parsed dimension sizes:
  a: 24
  b: 20
  c: 20
  d: 24
  e: 20
  f: 20
  g: 24
dtype: FP64
at::einsum:
  time (contract): 0.530435
  gflops: 8.33972
einsum_ir:
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
1 
2 
1 
2 
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
1 
2 
1 
2 
2 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 4
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    0
                         2
                         6
                         5
l_dim_ids_right_active   1
                         3
                         4
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->24];[1->20];[2->20];[3->24];[4->20];[5->20];[6->24]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             4
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9600
2                        ->480
5                        ->1
6                        ->20
l_strides_right          
1                        ->11520
3                        ->480
4                        ->24
6                        ->1
l_strides_out            
0                        ->3840000
1                        ->192000
2                        ->9600
3                        ->400
4                        ->20
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->20
2                        ->20
3                        ->24
4                        ->20
5                        ->20
6                        ->24
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e8c3000
[DEBUG] GEMM shape: m=20 n=20 k=24 lda=20 ldb=24 ldc=20
[DEBUG] dim_types_out: 1 2 1 2 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000435054
  time (contract): 0.156091
  gflops: 28.3404

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: abgf,cdeg->abcdef with dimensions: 24,20,20,24,20,20,24 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abgf,cdeg->abcdef" "24,20,20,24,20,20,24" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,g,f
  c,d,e,g
  a,b,c,d,e,f
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
  g: 6
parsed dimension sizes:
  a: 24
  b: 20
  c: 20
  d: 24
  e: 20
  f: 20
  g: 24
dtype: BF16
at::einsum:
  time (contract): 0.0369308
  gflops: 119.783
einsum_ir:
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
1 
1 
2 
2 
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
1 
1 
2 
2 
2 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 4
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    0
                         1
                         6
                         5
l_dim_ids_right_active   2
                         3
                         4
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->24];[1->20];[2->20];[3->24];[4->20];[5->20];[6->24]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             4
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9600
1                        ->480
5                        ->1
6                        ->20
l_strides_right          
2                        ->11520
3                        ->480
4                        ->24
6                        ->1
l_strides_out            
0                        ->3840000
1                        ->192000
2                        ->9600
3                        ->400
4                        ->20
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->20
2                        ->20
3                        ->24
4                        ->20
5                        ->20
6                        ->24
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3be8000
[DEBUG] GEMM shape: m=20 n=20 k=24 lda=20 ldb=24 ldc=20
[DEBUG] dim_types_out: 1 1 2 2 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000430606
  time (contract): 0.0833681
  gflops: 53.062
-----------------------------------
max element torch :      12.8125
max element jit :        12.8125
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abgf,cdeg->abcdef" "24,20,20,24,20,20,24" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,g,f
  c,d,e,g
  a,b,c,d,e,f
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
  g: 6
parsed dimension sizes:
  a: 24
  b: 20
  c: 20
  d: 24
  e: 20
  f: 20
  g: 24
dtype: FP32
at::einsum:
  time (contract): 0.0588031
  gflops: 75.2287
einsum_ir:
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
1 
1 
2 
2 
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
1 
1 
2 
2 
2 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 4
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    0
                         1
                         6
                         5
l_dim_ids_right_active   2
                         3
                         4
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->24];[1->20];[2->20];[3->24];[4->20];[5->20];[6->24]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             4
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9600
1                        ->480
5                        ->1
6                        ->20
l_strides_right          
2                        ->11520
3                        ->480
4                        ->24
6                        ->1
l_strides_out            
0                        ->3840000
1                        ->192000
2                        ->9600
3                        ->400
4                        ->20
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->20
2                        ->20
3                        ->24
4                        ->20
5                        ->20
6                        ->24
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb04dc000
[DEBUG] GEMM shape: m=20 n=20 k=24 lda=20 ldb=24 ldc=20
[DEBUG] dim_types_out: 1 1 2 2 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000453102
  time (contract): 0.0874769
  gflops: 50.5697

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abgf,cdeg->abcdef" "24,20,20,24,20,20,24" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,g,f
  c,d,e,g
  a,b,c,d,e,f
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
  g: 6
parsed dimension sizes:
  a: 24
  b: 20
  c: 20
  d: 24
  e: 20
  f: 20
  g: 24
dtype: FP64
at::einsum:
  time (contract): 0.534419
  gflops: 8.27756
einsum_ir:
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
1 
1 
2 
2 
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
3 
1 
--------
2 
2 
2 
3 
--------
1 
1 
2 
2 
2 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 4
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    0
                         1
                         6
                         5
l_dim_ids_right_active   2
                         3
                         4
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->24];[1->20];[2->20];[3->24];[4->20];[5->20];[6->24]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             4
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9600
1                        ->480
5                        ->1
6                        ->20
l_strides_right          
2                        ->11520
3                        ->480
4                        ->24
6                        ->1
l_strides_out            
0                        ->3840000
1                        ->192000
2                        ->9600
3                        ->400
4                        ->20
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->24
1                        ->20
2                        ->20
3                        ->24
4                        ->20
5                        ->20
6                        ->24
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9b87000
[DEBUG] GEMM shape: m=20 n=20 k=24 lda=20 ldb=24 ldc=20
[DEBUG] dim_types_out: 1 1 2 2 2 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000414767
  time (contract): 0.158142
  gflops: 27.9728

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: efhjki,gjk->efghi with dimensions: 6,64,24,4,94,6,64 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "efhjki,gjk->efghi" "6,64,24,4,94,6,64" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  e,f,h,j,k,i
  g,j,k
  e,f,g,h,i
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
parsed dimension sizes:
  e: 6
  f: 64
  g: 24
  h: 4
  i: 94
  j: 6
  k: 64
dtype: BF16
at::einsum:
  time (contract): 0.0483379
  gflops: 55.0559
einsum_ir:
1 
1 
1 
3 
3 
1 
--------
2 
3 
3 
--------
1 
1 
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
1 
3 
3 
1 
--------
2 
3 
3 
--------
1 
1 
2 
1 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 5
o_dim_ids_kb[1] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         3
m_num_dims_out           5
l_dim_ids_left_active    0
                         1
                         3
                         5
                         6
                         4
l_dim_ids_right_active   2
                         5
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->6];[1->64];[2->24];[3->4];[4->94];[5->6];[6->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             2
l_dim_ids_kb             5,6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9240576
1                        ->144384
3                        ->36096
4                        ->1
5                        ->6016
6                        ->94
l_strides_right          
2                        ->384
5                        ->64
6                        ->1
l_strides_out            
0                        ->577536
1                        ->9024
2                        ->376
3                        ->94
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->24
3                        ->4
4                        ->94
5                        ->6
6                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2575000
[DEBUG] GEMM shape: m=94 n=24 k=384 lda=94 ldb=384 ldc=376
[DEBUG] dim_types_out: 1 1 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000456462
  time (contract): 0.0289458
  gflops: 91.9402
-----------------------------------
max element torch :      115
max element jit :        115
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "efhjki,gjk->efghi" "6,64,24,4,94,6,64" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  e,f,h,j,k,i
  g,j,k
  e,f,g,h,i
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
parsed dimension sizes:
  e: 6
  f: 64
  g: 24
  h: 4
  i: 94
  j: 6
  k: 64
dtype: FP32
at::einsum:
  time (contract): 0.0812398
  gflops: 32.7584
einsum_ir:
1 
1 
1 
3 
3 
1 
--------
2 
3 
3 
--------
1 
1 
2 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
1 
3 
3 
1 
--------
2 
3 
3 
--------
1 
1 
2 
1 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 5
o_dim_ids_kb[1] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         3
m_num_dims_out           5
l_dim_ids_left_active    0
                         1
                         3
                         5
                         6
                         4
l_dim_ids_right_active   2
                         5
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->6];[1->64];[2->24];[3->4];[4->94];[5->6];[6->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             2
l_dim_ids_kb             5,6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9240576
1                        ->144384
3                        ->36096
4                        ->1
5                        ->6016
6                        ->94
l_strides_right          
2                        ->384
5                        ->64
6                        ->1
l_strides_out            
0                        ->577536
1                        ->9024
2                        ->376
3                        ->94
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->24
3                        ->4
4                        ->94
5                        ->6
6                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1033000
[DEBUG] GEMM shape: m=94 n=24 k=384 lda=94 ldb=384 ldc=376
[DEBUG] dim_types_out: 1 1 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.00043451
  time (contract): 0.0503772
  gflops: 52.8272

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "efhjki,gjk->efghi" "6,64,24,4,94,6,64" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  e,f,h,j,k,i
  g,j,k
  e,f,g,h,i
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
parsed dimension sizes:
  e: 6
  f: 64
  g: 24
  h: 4
  i: 94
  j: 6
  k: 64
dtype: FP64
at::einsum:
  time (contract): 0.16939
  gflops: 15.711
einsum_ir:
1 
1 
1 
3 
3 
1 
--------
2 
3 
3 
--------
1 
1 
2 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
1 
3 
3 
1 
--------
2 
3 
3 
--------
1 
1 
2 
1 
1 
--------
o_dim_ids_mb[0] = 4
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 6
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         3
m_num_dims_out           5
l_dim_ids_left_active    0
                         1
                         3
                         5
                         6
                         4
l_dim_ids_right_active   2
                         5
                         6
m_dim_ids_out            0
                         1
                         2
                         3
                         4
m_dim_sizes_inner        [0->6];[1->64];[2->24];[3->4];[4->94];[5->6];[6->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             4
l_dim_ids_nb             2
l_dim_ids_kb             6
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9240576
1                        ->144384
3                        ->36096
4                        ->1
5                        ->6016
6                        ->94
l_strides_right          
2                        ->384
5                        ->64
6                        ->1
l_strides_out            
0                        ->577536
1                        ->9024
2                        ->376
3                        ->94
4                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->24
3                        ->4
4                        ->94
5                        ->6
6                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89efb000
[DEBUG] GEMM shape: m=94 n=24 k=64 lda=94 ldb=384 ldc=376
[DEBUG] dim_types_out: 1 1 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000399216
  time (contract): 0.0823357
  gflops: 32.3224

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: bced,ae->abcd with dimensions: 96,84,84,84,96 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "bced,ae->abcd" "96,84,84,84,96" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  b,c,e,d
  a,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
dtype: BF16
at::einsum:
  time (contract): 0.0828163
  gflops: 131.915
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
2 
1 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
2 
1 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 0
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    1
                         2
                         4
                         3
l_dim_ids_right_active   0
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             0
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
1                        ->677376
2                        ->8064
3                        ->1
4                        ->84
l_strides_right          
0                        ->96
4                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7ff2e000
[DEBUG] GEMM shape: m=84 n=96 k=96 lda=84 ldb=96 ldc=592704
[DEBUG] dim_types_out: 2 1 1 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000495948
  time (contract): 0.0762349
  gflops: 143.303
-----------------------------------
max element torch :      35.75
max element jit :        35.75
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "bced,ae->abcd" "96,84,84,84,96" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  b,c,e,d
  a,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
dtype: FP32
at::einsum:
  time (contract): 0.167634
  gflops: 65.1699
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
2 
1 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
2 
1 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 0
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    1
                         2
                         4
                         3
l_dim_ids_right_active   0
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             0
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
1                        ->677376
2                        ->8064
3                        ->1
4                        ->84
l_strides_right          
0                        ->96
4                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbcc4f000
[DEBUG] GEMM shape: m=84 n=96 k=96 lda=84 ldb=96 ldc=592704
[DEBUG] dim_types_out: 2 1 1 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000489068
  time (contract): 0.168182
  gflops: 64.9579

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "bced,ae->abcd" "96,84,84,84,96" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  b,c,e,d
  a,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
dtype: FP64
at::einsum:
  time (contract): 0.617827
  gflops: 17.6825
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
2 
1 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
2 
1 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 0
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    1
                         2
                         4
                         3
l_dim_ids_right_active   0
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             0
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
1                        ->677376
2                        ->8064
3                        ->1
4                        ->84
l_strides_right          
0                        ->96
4                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b543000
[DEBUG] GEMM shape: m=84 n=96 k=96 lda=84 ldb=96 ldc=592704
[DEBUG] dim_types_out: 2 1 1 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000397456
  time (contract): 0.331091
  gflops: 32.9961

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: aced,be->abcd with dimensions: 96,84,84,84,96 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "aced,be->abcd" "96,84,84,84,96" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  a,c,e,d
  b,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
dtype: BF16
at::einsum:
  time (contract): 0.0899946
  gflops: 121.393
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         2
                         4
                         3
l_dim_ids_right_active   1
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
2                        ->8064
3                        ->1
4                        ->84
l_strides_right          
1                        ->96
4                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3fc4000
[DEBUG] GEMM shape: m=84 n=84 k=96 lda=84 ldb=96 ldc=7056
[DEBUG] dim_types_out: 1 2 1 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000430927
  time (contract): 0.078656
  gflops: 138.892
-----------------------------------
max element torch :      36
max element jit :        36
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "aced,be->abcd" "96,84,84,84,96" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  a,c,e,d
  b,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
dtype: FP32
at::einsum:
  time (contract): 0.183463
  gflops: 59.5472
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         2
                         4
                         3
l_dim_ids_right_active   1
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
2                        ->8064
3                        ->1
4                        ->84
l_strides_right          
1                        ->96
4                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4b0b000
[DEBUG] GEMM shape: m=84 n=84 k=96 lda=84 ldb=96 ldc=7056
[DEBUG] dim_types_out: 1 2 1 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000435022
  time (contract): 0.169371
  gflops: 64.5016

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "aced,be->abcd" "96,84,84,84,96" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  a,c,e,d
  b,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
dtype: FP64
at::einsum:
  time (contract): 0.667226
  gflops: 16.3733
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         2
                         4
                         3
l_dim_ids_right_active   1
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
2                        ->8064
3                        ->1
4                        ->84
l_strides_right          
1                        ->96
4                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb69f0000
[DEBUG] GEMM shape: m=84 n=84 k=96 lda=84 ldb=96 ldc=7056
[DEBUG] dim_types_out: 1 2 1 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.00038872
  time (contract): 0.333004
  gflops: 32.8066

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: abed,ce->abcd with dimensions: 96,84,84,84,96 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abed,ce->abcd" "96,84,84,84,96" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,e,d
  c,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
dtype: BF16
at::einsum:
  time (contract): 0.0895311
  gflops: 122.021
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         1
                         4
                         3
l_dim_ids_right_active   2
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
1                        ->8064
3                        ->1
4                        ->84
l_strides_right          
2                        ->96
4                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8dbab000
[DEBUG] GEMM shape: m=84 n=84 k=96 lda=84 ldb=96 ldc=84
[DEBUG] dim_types_out: 1 1 2 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000431694
  time (contract): 0.0793808
  gflops: 137.624
-----------------------------------
max element torch :      36.25
max element jit :        36.25
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abed,ce->abcd" "96,84,84,84,96" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,e,d
  c,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
dtype: FP32
at::einsum:
  time (contract): 0.183256
  gflops: 59.6145
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         1
                         4
                         3
l_dim_ids_right_active   2
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
1                        ->8064
3                        ->1
4                        ->84
l_strides_right          
2                        ->96
4                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffae743000
[DEBUG] GEMM shape: m=84 n=84 k=96 lda=84 ldb=96 ldc=84
[DEBUG] dim_types_out: 1 1 2 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.000380752
  time (contract): 0.184637
  gflops: 59.1685

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "abed,ce->abcd" "96,84,84,84,96" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  a,b,e,d
  c,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
dtype: FP64
at::einsum:
  time (contract): 0.677259
  gflops: 16.1308
einsum_ir:
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
3 
1 
--------
2 
3 
--------
1 
1 
2 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         2
m_num_dims_out           4
l_dim_ids_left_active    0
                         1
                         4
                         3
l_dim_ids_right_active   2
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
1                        ->8064
3                        ->1
4                        ->84
l_strides_right          
2                        ->96
4                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86ba7000
[DEBUG] GEMM shape: m=84 n=84 k=96 lda=84 ldb=96 ldc=84
[DEBUG] dim_types_out: 1 1 2 1 
m_num_loops: 2
JIT compile err: 0
  time (compile): 0.00038936
  time (contract): 0.297186
  gflops: 36.7605

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: aedc,ebd->abc with dimensions: 96,84,84,84,96 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "aedc,ebd->abc" "96,84,84,84,96" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  a,e,d,c
  e,b,d
  a,b,c
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
dtype: BF16
at::einsum:
  time (contract): 0.109692
  gflops: 99.5949
einsum_ir:
1 
3 
3 
1 
--------
3 
2 
3 
--------
1 
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
3 
3 
1 
--------
3 
2 
3 
--------
1 
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 3
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    0
                         4
                         3
                         2
l_dim_ids_right_active   4
                         1
                         3
m_dim_ids_out            0
                         1
                         2
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             1
l_dim_ids_kb             3
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
2                        ->1
3                        ->84
4                        ->7056
l_strides_right          
1                        ->84
3                        ->1
4                        ->7056
l_strides_out            
0                        ->7056
1                        ->84
2                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff98936000
[DEBUG] GEMM shape: m=84 n=84 k=84 lda=84 ldb=84 ldc=84
[DEBUG] dim_types_out: 1 2 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000422735
  time (contract): 0.0802302
  gflops: 136.167
-----------------------------------
max element torch :      2096
max element jit :        2144
max difference :          112
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0530303
Torch value at max error:2000
Kernel value at max error:2112

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "aedc,ebd->abc" "96,84,84,84,96" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  a,e,d,c
  e,b,d
  a,b,c
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
dtype: FP32
at::einsum:
  time (contract): 0.203025
  gflops: 53.8098
einsum_ir:
1 
3 
3 
1 
--------
3 
2 
3 
--------
1 
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
3 
3 
1 
--------
3 
2 
3 
--------
1 
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 3
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    0
                         4
                         3
                         2
l_dim_ids_right_active   4
                         1
                         3
m_dim_ids_out            0
                         1
                         2
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             1
l_dim_ids_kb             3
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
2                        ->1
3                        ->84
4                        ->7056
l_strides_right          
1                        ->84
3                        ->1
4                        ->7056
l_strides_out            
0                        ->7056
1                        ->84
2                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8bfc9000
[DEBUG] GEMM shape: m=84 n=84 k=84 lda=84 ldb=84 ldc=84
[DEBUG] dim_types_out: 1 2 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000421358
  time (contract): 0.159234
  gflops: 68.6079

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "aedc,ebd->abc" "96,84,84,84,96" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  a,e,d,c
  e,b,d
  a,b,c
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
dtype: FP64
at::einsum:
  time (contract): 0.379337
  gflops: 28.7995
einsum_ir:
1 
3 
3 
1 
--------
3 
2 
3 
--------
1 
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
3 
3 
1 
--------
3 
2 
3 
--------
1 
2 
1 
--------
o_dim_ids_mb[0] = 2
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 3
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    0
                         4
                         3
                         2
l_dim_ids_right_active   4
                         1
                         3
m_dim_ids_out            0
                         1
                         2
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             2
l_dim_ids_nb             1
l_dim_ids_kb             3
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->677376
2                        ->1
3                        ->84
4                        ->7056
l_strides_right          
1                        ->84
3                        ->1
4                        ->7056
l_strides_out            
0                        ->7056
1                        ->84
2                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8b439000
[DEBUG] GEMM shape: m=84 n=84 k=84 lda=84 ldb=84 ldc=84
[DEBUG] dim_types_out: 1 2 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000396976
  time (contract): 0.300683
  gflops: 36.3331

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: gkiljh,ekilfj->efgh with dimensions: 6,64,4,94,6,64,6,64 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "gkiljh,ekilfj->efgh" "6,64,4,94,6,64,6,64" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  g,k,i,l,j,h
  e,k,i,l,f,j
  e,f,g,h
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
  l: 7
parsed dimension sizes:
  e: 6
  f: 64
  g: 4
  h: 94
  i: 6
  j: 64
  k: 6
  l: 64
dtype: BF16
at::einsum:
  time (contract): 0.389479
  gflops: 109.327
einsum_ir:
1 
3 
3 
3 
3 
1 
--------
2 
3 
3 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
3 
3 
3 
3 
1 
--------
2 
3 
3 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         6
m_num_dims_out           4
l_dim_ids_left_active    2
                         6
                         4
                         7
                         5
                         3
l_dim_ids_right_active   0
                         6
                         4
                         7
                         1
                         5
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->6];[1->64];[2->4];[3->94];[4->6];[5->64];[6->6];[7->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->13860864
3                        ->1
4                        ->385024
5                        ->94
6                        ->2310144
7                        ->6016
l_strides_right          
0                        ->9437184
1                        ->64
4                        ->262144
5                        ->1
6                        ->1572864
7                        ->4096
l_strides_out            
0                        ->24064
1                        ->376
2                        ->94
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->4
3                        ->94
4                        ->6
5                        ->64
6                        ->6
7                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff85e90000
[DEBUG] GEMM shape: m=94 n=64 k=64 lda=94 ldb=64 ldc=376
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000430286
  time (contract): 0.333445
  gflops: 127.699
-----------------------------------
max element torch :      32640
max element jit :        8192
max difference :          24448
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.74902
Torch value at max error:32640
Kernel value at max error:8192

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "gkiljh,ekilfj->efgh" "6,64,4,94,6,64,6,64" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  g,k,i,l,j,h
  e,k,i,l,f,j
  e,f,g,h
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
  l: 7
parsed dimension sizes:
  e: 6
  f: 64
  g: 4
  h: 94
  i: 6
  j: 64
  k: 6
  l: 64
dtype: FP32
at::einsum:
  time (contract): 0.777332
  gflops: 54.7779
einsum_ir:
1 
3 
3 
3 
3 
1 
--------
2 
3 
3 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
3 
3 
3 
3 
1 
--------
2 
3 
3 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         6
m_num_dims_out           4
l_dim_ids_left_active    2
                         6
                         4
                         7
                         5
                         3
l_dim_ids_right_active   0
                         6
                         4
                         7
                         1
                         5
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->6];[1->64];[2->4];[3->94];[4->6];[5->64];[6->6];[7->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->13860864
3                        ->1
4                        ->385024
5                        ->94
6                        ->2310144
7                        ->6016
l_strides_right          
0                        ->9437184
1                        ->64
4                        ->262144
5                        ->1
6                        ->1572864
7                        ->4096
l_strides_out            
0                        ->24064
1                        ->376
2                        ->94
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->4
3                        ->94
4                        ->6
5                        ->64
6                        ->6
7                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1bdb000
[DEBUG] GEMM shape: m=94 n=64 k=64 lda=94 ldb=64 ldc=376
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000478156
  time (contract): 0.609422
  gflops: 69.8705

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "gkiljh,ekilfj->efgh" "6,64,4,94,6,64,6,64" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  g,k,i,l,j,h
  e,k,i,l,f,j
  e,f,g,h
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
  l: 7
parsed dimension sizes:
  e: 6
  f: 64
  g: 4
  h: 94
  i: 6
  j: 64
  k: 6
  l: 64
dtype: FP64
at::einsum:
  time (contract): 1.20727
  gflops: 35.27
einsum_ir:
1 
3 
3 
3 
3 
1 
--------
2 
3 
3 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
3 
3 
3 
3 
1 
--------
2 
3 
3 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         6
m_num_dims_out           4
l_dim_ids_left_active    2
                         6
                         4
                         7
                         5
                         3
l_dim_ids_right_active   0
                         6
                         4
                         7
                         1
                         5
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->6];[1->64];[2->4];[3->94];[4->6];[5->64];[6->6];[7->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->13860864
3                        ->1
4                        ->385024
5                        ->94
6                        ->2310144
7                        ->6016
l_strides_right          
0                        ->9437184
1                        ->64
4                        ->262144
5                        ->1
6                        ->1572864
7                        ->4096
l_strides_out            
0                        ->24064
1                        ->376
2                        ->94
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->4
3                        ->94
4                        ->6
5                        ->64
6                        ->6
7                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f382000
[DEBUG] GEMM shape: m=94 n=64 k=64 lda=94 ldb=64 ldc=376
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000476365
  time (contract): 1.22388
  gflops: 34.7915

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: gikljh,eiklfj->efgh with dimensions: 6,64,4,94,4,94,6,64 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "gikljh,eiklfj->efgh" "6,64,4,94,4,94,6,64" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  g,i,k,l,j,h
  e,i,k,l,f,j
  e,f,g,h
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
  l: 7
parsed dimension sizes:
  e: 6
  f: 64
  g: 4
  h: 94
  i: 4
  j: 94
  k: 6
  l: 64
dtype: BF16
at::einsum:
  time (contract): 0.394015
  gflops: 105.817
einsum_ir:
1 
3 
3 
3 
3 
1 
--------
2 
3 
3 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
3 
3 
3 
3 
1 
--------
2 
3 
3 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         6
m_num_dims_out           4
l_dim_ids_left_active    2
                         4
                         6
                         7
                         5
                         3
l_dim_ids_right_active   0
                         4
                         6
                         7
                         1
                         5
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->6];[1->64];[2->4];[3->94];[4->4];[5->94];[6->6];[7->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->13572096
3                        ->1
4                        ->3393024
5                        ->94
6                        ->565504
7                        ->8836
l_strides_right          
0                        ->9240576
1                        ->94
4                        ->2310144
5                        ->1
6                        ->385024
7                        ->6016
l_strides_out            
0                        ->24064
1                        ->376
2                        ->94
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->4
3                        ->94
4                        ->4
5                        ->94
6                        ->6
7                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad481000
[DEBUG] GEMM shape: m=94 n=64 k=94 lda=94 ldb=94 ldc=376
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000383248
  time (contract): 0.361508
  gflops: 115.332
-----------------------------------
max element torch :      32000
max element jit :        8448
max difference :          23808
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.744
Torch value at max error:32000
Kernel value at max error:8192

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "gikljh,eiklfj->efgh" "6,64,4,94,4,94,6,64" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  g,i,k,l,j,h
  e,i,k,l,f,j
  e,f,g,h
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
  l: 7
parsed dimension sizes:
  e: 6
  f: 64
  g: 4
  h: 94
  i: 4
  j: 94
  k: 6
  l: 64
dtype: FP32
at::einsum:
  time (contract): 0.743568
  gflops: 56.0722
einsum_ir:
1 
3 
3 
3 
3 
1 
--------
2 
3 
3 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
3 
3 
3 
3 
1 
--------
2 
3 
3 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         6
m_num_dims_out           4
l_dim_ids_left_active    2
                         4
                         6
                         7
                         5
                         3
l_dim_ids_right_active   0
                         4
                         6
                         7
                         1
                         5
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->6];[1->64];[2->4];[3->94];[4->4];[5->94];[6->6];[7->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->13572096
3                        ->1
4                        ->3393024
5                        ->94
6                        ->565504
7                        ->8836
l_strides_right          
0                        ->9240576
1                        ->94
4                        ->2310144
5                        ->1
6                        ->385024
7                        ->6016
l_strides_out            
0                        ->24064
1                        ->376
2                        ->94
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->4
3                        ->94
4                        ->4
5                        ->94
6                        ->6
7                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff85893000
[DEBUG] GEMM shape: m=94 n=64 k=94 lda=94 ldb=94 ldc=376
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000484492
  time (contract): 0.584205
  gflops: 71.3678

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "gikljh,eiklfj->efgh" "6,64,4,94,4,94,6,64" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  g,i,k,l,j,h
  e,i,k,l,f,j
  e,f,g,h
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
  l: 7
parsed dimension sizes:
  e: 6
  f: 64
  g: 4
  h: 94
  i: 4
  j: 94
  k: 6
  l: 64
dtype: FP64
at::einsum:
  time (contract): 1.16111
  gflops: 35.9084
einsum_ir:
1 
3 
3 
3 
3 
1 
--------
2 
3 
3 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
3 
3 
3 
3 
1 
--------
2 
3 
3 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         6
m_num_dims_out           4
l_dim_ids_left_active    2
                         4
                         6
                         7
                         5
                         3
l_dim_ids_right_active   0
                         4
                         6
                         7
                         1
                         5
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->6];[1->64];[2->4];[3->94];[4->4];[5->94];[6->6];[7->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->13572096
3                        ->1
4                        ->3393024
5                        ->94
6                        ->565504
7                        ->8836
l_strides_right          
0                        ->9240576
1                        ->94
4                        ->2310144
5                        ->1
6                        ->385024
7                        ->6016
l_strides_out            
0                        ->24064
1                        ->376
2                        ->94
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->4
3                        ->94
4                        ->4
5                        ->94
6                        ->6
7                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89dc5000
[DEBUG] GEMM shape: m=94 n=64 k=94 lda=94 ldb=94 ldc=376
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.00049134
  time (contract): 1.17571
  gflops: 35.4624

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: efiklj,ghkl->efghij with dimensions: 6,64,4,94,4,94,6,64 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "efiklj,ghkl->efghij" "6,64,4,94,4,94,6,64" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  e,f,i,k,l,j
  g,h,k,l
  e,f,g,h,i,j
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
  l: 7
parsed dimension sizes:
  e: 6
  f: 64
  g: 4
  h: 94
  i: 4
  j: 94
  k: 6
  l: 64
dtype: BF16
at::einsum:
  time (contract): 0.184926
  gflops: 225.46
einsum_ir:
1 
1 
1 
3 
3 
1 
--------
2 
2 
3 
3 
--------
1 
1 
2 
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
1 
3 
3 
1 
--------
2 
2 
3 
3 
--------
1 
1 
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 6
o_dim_ids_kb[1] = 7
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    0
                         1
                         4
                         6
                         7
                         5
l_dim_ids_right_active   2
                         3
                         6
                         7
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->6];[1->64];[2->4];[3->94];[4->4];[5->94];[6->6];[7->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             3
l_dim_ids_kb             6,7
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9240576
1                        ->144384
4                        ->36096
5                        ->1
6                        ->6016
7                        ->94
l_strides_right          
2                        ->36096
3                        ->384
6                        ->64
7                        ->1
l_strides_out            
0                        ->9048064
1                        ->141376
2                        ->35344
3                        ->376
4                        ->94
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->4
3                        ->94
4                        ->4
5                        ->94
6                        ->6
7                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9046d000
[DEBUG] GEMM shape: m=94 n=94 k=384 lda=94 ldb=384 ldc=376
[DEBUG] dim_types_out: 1 1 2 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00043435
  time (contract): 0.257409
  gflops: 161.974
-----------------------------------
max element torch :      120
max element jit :        120
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "efiklj,ghkl->efghij" "6,64,4,94,4,94,6,64" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  e,f,i,k,l,j
  g,h,k,l
  e,f,g,h,i,j
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
  l: 7
parsed dimension sizes:
  e: 6
  f: 64
  g: 4
  h: 94
  i: 4
  j: 94
  k: 6
  l: 64
dtype: FP32
at::einsum:
  time (contract): 0.488931
  gflops: 85.2749
einsum_ir:
1 
1 
1 
3 
3 
1 
--------
2 
2 
3 
3 
--------
1 
1 
2 
2 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
1 
3 
3 
1 
--------
2 
2 
3 
3 
--------
1 
1 
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 6
o_dim_ids_kb[1] = 7
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    0
                         1
                         4
                         6
                         7
                         5
l_dim_ids_right_active   2
                         3
                         6
                         7
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->6];[1->64];[2->4];[3->94];[4->4];[5->94];[6->6];[7->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             3
l_dim_ids_kb             6,7
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9240576
1                        ->144384
4                        ->36096
5                        ->1
6                        ->6016
7                        ->94
l_strides_right          
2                        ->36096
3                        ->384
6                        ->64
7                        ->1
l_strides_out            
0                        ->9048064
1                        ->141376
2                        ->35344
3                        ->376
4                        ->94
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->4
3                        ->94
4                        ->4
5                        ->94
6                        ->6
7                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5b1f000
[DEBUG] GEMM shape: m=94 n=94 k=384 lda=94 ldb=384 ldc=376
[DEBUG] dim_types_out: 1 1 2 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000482061
  time (contract): 0.59985
  gflops: 69.5066

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "efiklj,ghkl->efghij" "6,64,4,94,4,94,6,64" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  e,f,i,k,l,j
  g,h,k,l
  e,f,g,h,i,j
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
  l: 7
parsed dimension sizes:
  e: 6
  f: 64
  g: 4
  h: 94
  i: 4
  j: 94
  k: 6
  l: 64
dtype: FP64
at::einsum:
  time (contract): 1.20606
  gflops: 34.5701
einsum_ir:
1 
1 
1 
3 
3 
1 
--------
2 
2 
3 
3 
--------
1 
1 
2 
2 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
1 
3 
3 
1 
--------
2 
2 
3 
3 
--------
1 
1 
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 7
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    0
                         1
                         4
                         6
                         7
                         5
l_dim_ids_right_active   2
                         3
                         6
                         7
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->6];[1->64];[2->4];[3->94];[4->4];[5->94];[6->6];[7->64]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             3
l_dim_ids_kb             7
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9240576
1                        ->144384
4                        ->36096
5                        ->1
6                        ->6016
7                        ->94
l_strides_right          
2                        ->36096
3                        ->384
6                        ->64
7                        ->1
l_strides_out            
0                        ->9048064
1                        ->141376
2                        ->35344
3                        ->376
4                        ->94
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->4
3                        ->94
4                        ->4
5                        ->94
6                        ->6
7                        ->64
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa2bcb000
[DEBUG] GEMM shape: m=94 n=94 k=64 lda=94 ldb=384 ldc=376
[DEBUG] dim_types_out: 1 1 2 2 1 1 
m_num_loops: 5
JIT compile err: 0
  time (compile): 0.000462381
  time (contract): 1.16521
  gflops: 35.7819

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: efiklj,ghkl->efghij with dimensions: 6,64,6,64,4,94,4,94 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "efiklj,ghkl->efghij" "6,64,6,64,4,94,4,94" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  e,f,i,k,l,j
  g,h,k,l
  e,f,g,h,i,j
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
  l: 7
parsed dimension sizes:
  e: 6
  f: 64
  g: 6
  h: 64
  i: 4
  j: 94
  k: 4
  l: 94
dtype: BF16
at::einsum:
  time (contract): 0.179226
  gflops: 232.63
einsum_ir:
1 
1 
1 
3 
3 
1 
--------
2 
2 
3 
3 
--------
1 
1 
2 
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
1 
1 
3 
3 
1 
--------
2 
2 
3 
3 
--------
1 
1 
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 6
o_dim_ids_kb[1] = 7
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    0
                         1
                         4
                         6
                         7
                         5
l_dim_ids_right_active   2
                         3
                         6
                         7
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->6];[1->64];[2->6];[3->64];[4->4];[5->94];[6->4];[7->94]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             3
l_dim_ids_kb             6,7
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9048064
1                        ->141376
4                        ->35344
5                        ->1
6                        ->8836
7                        ->94
l_strides_right          
2                        ->24064
3                        ->376
6                        ->94
7                        ->1
l_strides_out            
0                        ->9240576
1                        ->144384
2                        ->24064
3                        ->376
4                        ->94
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->6
3                        ->64
4                        ->4
5                        ->94
6                        ->4
7                        ->94
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff85efd000
[DEBUG] GEMM shape: m=94 n=64 k=376 lda=94 ldb=376 ldc=376
[DEBUG] dim_types_out: 1 1 2 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000395632
  time (contract): 0.287949
  gflops: 144.795
-----------------------------------
max element torch :      118
max element jit :        118
max difference :          0
-----------------------------------
Element-wise relative errors
Biggest relative error:  0
Torch value at max error:0
Kernel value at max error:0

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "efiklj,ghkl->efghij" "6,64,6,64,4,94,4,94" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  e,f,i,k,l,j
  g,h,k,l
  e,f,g,h,i,j
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
  l: 7
parsed dimension sizes:
  e: 6
  f: 64
  g: 6
  h: 64
  i: 4
  j: 94
  k: 4
  l: 94
dtype: FP32
at::einsum:
  time (contract): 0.47164
  gflops: 88.4011
einsum_ir:
1 
1 
1 
3 
3 
1 
--------
2 
2 
3 
3 
--------
1 
1 
2 
2 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
1 
1 
3 
3 
1 
--------
2 
2 
3 
3 
--------
1 
1 
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 6
o_dim_ids_kb[1] = 7
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    0
                         1
                         4
                         6
                         7
                         5
l_dim_ids_right_active   2
                         3
                         6
                         7
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->6];[1->64];[2->6];[3->64];[4->4];[5->94];[6->4];[7->94]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             3
l_dim_ids_kb             6,7
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9048064
1                        ->141376
4                        ->35344
5                        ->1
6                        ->8836
7                        ->94
l_strides_right          
2                        ->24064
3                        ->376
6                        ->94
7                        ->1
l_strides_out            
0                        ->9240576
1                        ->144384
2                        ->24064
3                        ->376
4                        ->94
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->6
3                        ->64
4                        ->4
5                        ->94
6                        ->4
7                        ->94
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c846000
[DEBUG] GEMM shape: m=94 n=64 k=376 lda=94 ldb=376 ldc=376
[DEBUG] dim_types_out: 1 1 2 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.0004835
  time (contract): 0.581546
  gflops: 71.6942

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "efiklj,ghkl->efghij" "6,64,6,64,4,94,4,94" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  e,f,i,k,l,j
  g,h,k,l
  e,f,g,h,i,j
parsed dimension ids:
  e: 0
  f: 1
  g: 2
  h: 3
  i: 4
  j: 5
  k: 6
  l: 7
parsed dimension sizes:
  e: 6
  f: 64
  g: 6
  h: 64
  i: 4
  j: 94
  k: 4
  l: 94
dtype: FP64
at::einsum:
  time (contract): 1.2044
  gflops: 34.6176
einsum_ir:
1 
1 
1 
3 
3 
1 
--------
2 
2 
3 
3 
--------
1 
1 
2 
2 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
1 
1 
3 
3 
1 
--------
2 
2 
3 
3 
--------
1 
1 
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 5
o_dim_ids_nb[0] = 3
o_dim_ids_kb[0] = 7
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          6
m_num_dims_right         4
m_num_dims_out           6
l_dim_ids_left_active    0
                         1
                         4
                         6
                         7
                         5
l_dim_ids_right_active   2
                         3
                         6
                         7
m_dim_ids_out            0
                         1
                         2
                         3
                         4
                         5
m_dim_sizes_inner        [0->6];[1->64];[2->6];[3->64];[4->4];[5->94];[6->4];[7->94]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             5
l_dim_ids_nb             3
l_dim_ids_kb             7
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->9048064
1                        ->141376
4                        ->35344
5                        ->1
6                        ->8836
7                        ->94
l_strides_right          
2                        ->24064
3                        ->376
6                        ->94
7                        ->1
l_strides_out            
0                        ->9240576
1                        ->144384
2                        ->24064
3                        ->376
4                        ->94
5                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->6
1                        ->64
2                        ->6
3                        ->64
4                        ->4
5                        ->94
6                        ->4
7                        ->94
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8bfe6000
[DEBUG] GEMM shape: m=94 n=64 k=94 lda=94 ldb=376 ldc=376
[DEBUG] dim_types_out: 1 1 2 2 1 1 
m_num_loops: 5
JIT compile err: 0
  time (compile): 0.000435599
  time (contract): 1.16503
  gflops: 35.7876

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: fihg,dieh->defg with dimensions: 151,48,181,40,151,48 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "fihg,dieh->defg" "151,48,181,40,151,48" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  f,i,h,g
  d,i,e,h
  d,e,f,g
parsed dimension ids:
  d: 0
  e: 1
  f: 2
  g: 3
  h: 4
  i: 5
parsed dimension sizes:
  d: 151
  e: 48
  f: 181
  g: 40
  h: 151
  i: 48
dtype: BF16
at::einsum:
  time (contract): 2.56126
  gflops: 296.997
einsum_ir:
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           4
l_dim_ids_left_active    2
                         5
                         4
                         3
l_dim_ids_right_active   0
                         5
                         1
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->151];[1->48];[2->181];[3->40];[4->151];[5->48]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->289920
3                        ->1
4                        ->40
5                        ->6040
l_strides_right          
0                        ->347904
1                        ->151
4                        ->1
5                        ->7248
l_strides_out            
0                        ->347520
1                        ->7240
2                        ->40
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->151
1                        ->48
2                        ->181
3                        ->40
4                        ->151
5                        ->48
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8f7d2000
[DEBUG] GEMM shape: m=40 n=48 k=151 lda=40 ldb=151 ldc=7240
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000438062
  time (contract): 8.51865
  gflops: 89.2964
-----------------------------------
max element torch :      1904
max element jit :        1.59694e+29
max difference :          1.59694e+29
-----------------------------------
Element-wise relative errors
Biggest relative error:  1
Torch value at max error:1800
Kernel value at max error:9.40834e+28

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "fihg,dieh->defg" "151,48,181,40,151,48" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  f,i,h,g
  d,i,e,h
  d,e,f,g
parsed dimension ids:
  d: 0
  e: 1
  f: 2
  g: 3
  h: 4
  i: 5
parsed dimension sizes:
  d: 151
  e: 48
  f: 181
  g: 40
  h: 151
  i: 48
dtype: FP32
at::einsum:
  time (contract): 7.9692
  gflops: 95.4531
einsum_ir:
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           4
l_dim_ids_left_active    2
                         5
                         4
                         3
l_dim_ids_right_active   0
                         5
                         1
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->151];[1->48];[2->181];[3->40];[4->151];[5->48]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->289920
3                        ->1
4                        ->40
5                        ->6040
l_strides_right          
0                        ->347904
1                        ->151
4                        ->1
5                        ->7248
l_strides_out            
0                        ->347520
1                        ->7240
2                        ->40
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->151
1                        ->48
2                        ->181
3                        ->40
4                        ->151
5                        ->48
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffae9e3000
[DEBUG] GEMM shape: m=40 n=48 k=151 lda=40 ldb=151 ldc=7240
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000469901
  time (contract): 11.8766
  gflops: 64.049

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "fihg,dieh->defg" "151,48,181,40,151,48" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  f,i,h,g
  d,i,e,h
  d,e,f,g
parsed dimension ids:
  d: 0
  e: 1
  f: 2
  g: 3
  h: 4
  i: 5
parsed dimension sizes:
  d: 151
  e: 48
  f: 181
  g: 40
  h: 151
  i: 48
dtype: FP64
at::einsum:
  time (contract): 15.9133
  gflops: 47.802
einsum_ir:
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           4
l_dim_ids_left_active    2
                         5
                         4
                         3
l_dim_ids_right_active   0
                         5
                         1
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->151];[1->48];[2->181];[3->40];[4->151];[5->48]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->289920
3                        ->1
4                        ->40
5                        ->6040
l_strides_right          
0                        ->347904
1                        ->151
4                        ->1
5                        ->7248
l_strides_out            
0                        ->347520
1                        ->7240
2                        ->40
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->151
1                        ->48
2                        ->181
3                        ->40
4                        ->151
5                        ->48
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3bf5000
[DEBUG] GEMM shape: m=40 n=48 k=151 lda=40 ldb=151 ldc=7240
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000462413
  time (contract): 20.9982
  gflops: 36.2262

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: cefd,aebf->abcd with dimensions: 96,84,84,84,84,96 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "cefd,aebf->abcd" "96,84,84,84,84,96" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  c,e,f,d
  a,e,b,f
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 84
  f: 96
dtype: BF16
at::einsum:
  time (contract): 3.15332
  gflops: 291.019
einsum_ir:
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           4
l_dim_ids_left_active    2
                         4
                         5
                         3
l_dim_ids_right_active   0
                         4
                         1
                         5
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->84];[5->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->677376
3                        ->1
4                        ->8064
5                        ->84
l_strides_right          
0                        ->677376
1                        ->96
4                        ->8064
5                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->84
5                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d7fa000
[DEBUG] GEMM shape: m=84 n=84 k=96 lda=84 ldb=96 ldc=7056
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000437998
  time (contract): 6.28837
  gflops: 145.932
-----------------------------------
max element torch :      2112
max element jit :        2128
max difference :          88
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0436508
Torch value at max error:1928
Kernel value at max error:2016

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "cefd,aebf->abcd" "96,84,84,84,84,96" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  c,e,f,d
  a,e,b,f
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 84
  f: 96
dtype: FP32
at::einsum:
  time (contract): 9.67287
  gflops: 94.8712
einsum_ir:
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           4
l_dim_ids_left_active    2
                         4
                         5
                         3
l_dim_ids_right_active   0
                         4
                         1
                         5
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->84];[5->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->677376
3                        ->1
4                        ->8064
5                        ->84
l_strides_right          
0                        ->677376
1                        ->96
4                        ->8064
5                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->84
5                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82cfa000
[DEBUG] GEMM shape: m=84 n=84 k=96 lda=84 ldb=96 ldc=7056
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000446542
  time (contract): 12.958
  gflops: 70.8193

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "cefd,aebf->abcd" "96,84,84,84,84,96" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  c,e,f,d
  a,e,b,f
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 84
  f: 96
dtype: FP64
at::einsum:
  time (contract): 19.139
  gflops: 47.948
einsum_ir:
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           4
l_dim_ids_left_active    2
                         4
                         5
                         3
l_dim_ids_right_active   0
                         4
                         1
                         5
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->84];[5->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->677376
3                        ->1
4                        ->8064
5                        ->84
l_strides_right          
0                        ->677376
1                        ->96
4                        ->8064
5                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->84
5                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86a07000
[DEBUG] GEMM shape: m=84 n=84 k=96 lda=84 ldb=96 ldc=7056
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000514315
  time (contract): 24.5565
  gflops: 37.37

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: aefd,becf->abcd with dimensions: 96,84,84,84,96,96 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "aefd,becf->abcd" "96,84,84,84,96,96" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  a,e,f,d
  b,e,c,f
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
  f: 96
dtype: BF16
at::einsum:
  time (contract): 3.51272
  gflops: 298.564
einsum_ir:
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
1 
2 
2 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
1 
2 
2 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           4
l_dim_ids_left_active    0
                         4
                         5
                         3
l_dim_ids_right_active   1
                         4
                         2
                         5
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96];[5->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             2
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->774144
3                        ->1
4                        ->8064
5                        ->84
l_strides_right          
1                        ->774144
2                        ->96
4                        ->8064
5                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
5                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8ed5000
[DEBUG] GEMM shape: m=84 n=84 k=96 lda=84 ldb=96 ldc=84
[DEBUG] dim_types_out: 1 2 2 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000438286
  time (contract): 7.17213
  gflops: 146.229
-----------------------------------
max element torch :      2400
max element jit :        2480
max difference :          144
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0596026
Torch value at max error:2272
Kernel value at max error:2416

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "aefd,becf->abcd" "96,84,84,84,96,96" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  a,e,f,d
  b,e,c,f
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
  f: 96
dtype: FP32
at::einsum:
  time (contract): 11.9618
  gflops: 87.6769
einsum_ir:
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
1 
2 
2 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
1 
2 
2 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           4
l_dim_ids_left_active    0
                         4
                         5
                         3
l_dim_ids_right_active   1
                         4
                         2
                         5
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96];[5->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             2
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->774144
3                        ->1
4                        ->8064
5                        ->84
l_strides_right          
1                        ->774144
2                        ->96
4                        ->8064
5                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
5                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5038000
[DEBUG] GEMM shape: m=84 n=84 k=96 lda=84 ldb=96 ldc=84
[DEBUG] dim_types_out: 1 2 2 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000402992
  time (contract): 14.7022
  gflops: 71.3345

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "aefd,becf->abcd" "96,84,84,84,96,96" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  a,e,f,d
  b,e,c,f
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 84
  e: 96
  f: 96
dtype: FP64
at::einsum:
  time (contract): 21.8417
  gflops: 48.0169
einsum_ir:
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
1 
2 
2 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
1 
2 
2 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 5
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           4
l_dim_ids_left_active    0
                         4
                         5
                         3
l_dim_ids_right_active   1
                         4
                         2
                         5
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->84];[4->96];[5->96]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             2
l_dim_ids_kb             5
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->774144
3                        ->1
4                        ->8064
5                        ->84
l_strides_right          
1                        ->774144
2                        ->96
4                        ->8064
5                        ->1
l_strides_out            
0                        ->592704
1                        ->7056
2                        ->84
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->84
4                        ->96
5                        ->96
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f5ce000
[DEBUG] GEMM shape: m=84 n=84 k=96 lda=84 ldb=96 ldc=84
[DEBUG] dim_types_out: 1 2 2 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000454606
  time (contract): 28.0649
  gflops: 37.3695

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== Testing: cfed,afbe->abcd with dimensions: 96,84,84,96,84,84 ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "cfed,afbe->abcd" "96,84,84,96,84,84" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  c,f,e,d
  a,f,b,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 96
  e: 84
  f: 84
dtype: BF16
at::einsum:
  time (contract): 3.14165
  gflops: 292.1
einsum_ir:
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           4
l_dim_ids_left_active    2
                         5
                         4
                         3
l_dim_ids_right_active   0
                         5
                         1
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->96];[4->84];[5->84]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->677376
3                        ->1
4                        ->96
5                        ->8064
l_strides_right          
0                        ->592704
1                        ->84
4                        ->1
5                        ->7056
l_strides_out            
0                        ->677376
1                        ->8064
2                        ->96
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->96
4                        ->84
5                        ->84
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb6218000
[DEBUG] GEMM shape: m=96 n=84 k=84 lda=96 ldb=84 ldc=8064
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000439598
  time (contract): 4.84343
  gflops: 189.468
-----------------------------------
max element torch :      1856
max element jit :        1904
max difference :          104
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0565217
Torch value at max error:1736
Kernel value at max error:1840

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "cfed,afbe->abcd" "96,84,84,96,84,84" FP32
----------------------------------------
running bench_binary!
parsed tensors:
  c,f,e,d
  a,f,b,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 96
  e: 84
  f: 84
dtype: FP32
at::einsum:
  time (contract): 9.54932
  gflops: 96.0986
einsum_ir:
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 0, backend = 2
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           4
l_dim_ids_left_active    2
                         5
                         4
                         3
l_dim_ids_right_active   0
                         5
                         1
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->96];[4->84];[5->84]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->677376
3                        ->1
4                        ->96
5                        ->8064
l_strides_right          
0                        ->592704
1                        ->84
4                        ->1
5                        ->7056
l_strides_out            
0                        ->677376
1                        ->8064
2                        ->96
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->96
4                        ->84
5                        ->84
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad9b8000
[DEBUG] GEMM shape: m=96 n=84 k=84 lda=96 ldb=84 ldc=8064
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000459405
  time (contract): 11.8877
  gflops: 77.1955

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================

Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "cfed,afbe->abcd" "96,84,84,96,84,84" FP64
----------------------------------------
running bench_binary!
parsed tensors:
  c,f,e,d
  a,f,b,e
  a,b,c,d
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  d: 3
  e: 4
  f: 5
parsed dimension sizes:
  a: 96
  b: 84
  c: 84
  d: 96
  e: 84
  f: 84
dtype: FP64
at::einsum:
  time (contract): 19.2426
  gflops: 47.6899
einsum_ir:
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
[BP::init] i_data_type = 1, backend = 2
1 
3 
3 
1 
--------
2 
3 
2 
3 
--------
2 
2 
1 
1 
--------
o_dim_ids_mb[0] = 3
o_dim_ids_nb[0] = 1
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         4
m_num_dims_out           4
l_dim_ids_left_active    2
                         5
                         4
                         3
l_dim_ids_right_active   0
                         5
                         1
                         4
m_dim_ids_out            0
                         1
                         2
                         3
m_dim_sizes_inner        [0->96];[1->84];[2->84];[3->96];[4->84];[5->84]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             3
l_dim_ids_nb             1
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
2                        ->677376
3                        ->1
4                        ->96
5                        ->8064
l_strides_right          
0                        ->592704
1                        ->84
4                        ->1
5                        ->7056
l_strides_out            
0                        ->677376
1                        ->8064
2                        ->96
3                        ->1
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->96
1                        ->84
2                        ->84
3                        ->96
4                        ->84
5                        ->84
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86402000
[DEBUG] GEMM shape: m=96 n=84 k=84 lda=96 ldb=84 ldc=8064
[DEBUG] dim_types_out: 2 2 1 1 
m_num_loops: 6
JIT compile err: 0
  time (compile): 0.000506507
  time (contract): 23.6691
  gflops: 38.7711

results are close

acceptable relative error:                    0.001
finished running bench_binary!

Exit code: 0
========================================


