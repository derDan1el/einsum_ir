=== xaby,cxy->cab k-value benchmark log started: Sat Jun 14 09:32:09 PM CEST 2025 ===

=== testing k=2 (dimensions: 16,16,96,2,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,2,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 2
  y: 4
dtype: BF16
at::einsum:
  time (contract): 5.63187e-05
  gflops: 6.98197
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->2];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->8
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->2
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4fba000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=8 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000452782
  time (contract): 7.33339e-05
  gflops: 5.362
-----------------------------------
max element torch :      5.09375
max element jit :        5.09375
max difference :          0.03125
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:1.00781
Kernel value at max error:1

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=4 (dimensions: 16,16,96,4,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,4,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 4
  y: 4
dtype: BF16
at::einsum:
  time (contract): 6.10422e-05
  gflops: 12.8834
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->4];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->16
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->4
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbdb36000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=16 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000393008
  time (contract): 0.000130585
  gflops: 6.02239
-----------------------------------
max element torch :      7.40625
max element jit :        7.40625
max difference :          0.03125
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.00775194
Torch value at max error:4.03125
Kernel value at max error:4

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=6 (dimensions: 16,16,96,6,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,6,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 6
  y: 4
dtype: BF16
at::einsum:
  time (contract): 6.32542e-05
  gflops: 18.6493
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->6];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->24
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->6
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5674000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=24 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000337234
  time (contract): 0.000191022
  gflops: 6.17546
-----------------------------------
max element torch :      10
max element jit :        10
max difference :          0.0625
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0111111
Torch value at max error:5.5625
Kernel value at max error:5.625

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=8 (dimensions: 16,16,96,8,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,8,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 8
  y: 4
dtype: BF16
at::einsum:
  time (contract): 6.74364e-05
  gflops: 23.3237
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->8];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->32
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->8
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb871c000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=32 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000331154
  time (contract): 0.000249626
  gflops: 6.30089
-----------------------------------
max element torch :      12.8125
max element jit :        12.8125
max difference :          0.125
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0135135
Torch value at max error:9.25
Kernel value at max error:9.125

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=10 (dimensions: 16,16,96,10,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,10,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 10
  y: 4
dtype: BF16
at::einsum:
  time (contract): 7.14397e-05
  gflops: 27.5208
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->10];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->40
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->10
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba655000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=40 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000359762
  time (contract): 0.000300621
  gflops: 6.54007
-----------------------------------
max element torch :      14.8125
max element jit :        14.8125
max difference :          0.125
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0148148
Torch value at max error:8.4375
Kernel value at max error:8.3125

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=12 (dimensions: 16,16,96,12,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,12,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 12
  y: 4
dtype: BF16
at::einsum:
  time (contract): 7.39989e-05
  gflops: 31.8828
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->12];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->48
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->12
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1cbb000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=48 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000383313
  time (contract): 0.00036269
  gflops: 6.50499
-----------------------------------
max element torch :      17.875
max element jit :        17.875
max difference :          0.1875
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0153061
Torch value at max error:12.0625
Kernel value at max error:12.25

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=14 (dimensions: 16,16,96,14,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,14,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 14
  y: 4
dtype: BF16
at::einsum:
  time (contract): 7.63957e-05
  gflops: 36.0297
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->14];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->56
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->14
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb35a8000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=56 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000290196
  time (contract): 0.000422836
  gflops: 6.50964
-----------------------------------
max element torch :      20.625
max element jit :        20.75
max difference :          0.25
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.015
Torch value at max error:12.5
Kernel value at max error:12.3125

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=16 (dimensions: 16,16,96,16,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,16,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 16
  y: 4
dtype: BF16
at::einsum:
  time (contract): 8.03633e-05
  gflops: 39.1438
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->16];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->64
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->16
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8022f000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=64 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000306739
  time (contract): 0.000488784
  gflops: 6.43583
-----------------------------------
max element torch :      23.25
max element jit :        23.375
max difference :          0.25
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0153846
Torch value at max error:16
Kernel value at max error:16.25

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=18 (dimensions: 16,16,96,18,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,18,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 18
  y: 4
dtype: BF16
at::einsum:
  time (contract): 8.65317e-05
  gflops: 40.8977
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->18];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->72
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->18
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2ac8000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=72 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.00033589
  time (contract): 0.000543939
  gflops: 6.50614
-----------------------------------
max element torch :      24.125
max element jit :        24.125
max difference :          0.375
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0165289
Torch value at max error:15.125
Kernel value at max error:14.875

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=20 (dimensions: 16,16,96,20,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,20,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 20
  y: 4
dtype: BF16
at::einsum:
  time (contract): 8.89484e-05
  gflops: 44.2072
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->20];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->80
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->20
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaff4c000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=80 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000340562
  time (contract): 0.000601104
  gflops: 6.54157
-----------------------------------
max element torch :      27.5
max element jit :        27.375
max difference :          0.375
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0196078
Torch value at max error:18.75
Kernel value at max error:19.125

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=22 (dimensions: 16,16,96,22,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,22,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 22
  y: 4
dtype: BF16
at::einsum:
  time (contract): 8.97157e-05
  gflops: 48.212
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->22];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->88
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->22
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff96814000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=88 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.0002949
  time (contract): 0.000663249
  gflops: 6.5215
-----------------------------------
max element torch :      28.875
max element jit :        29
max difference :          0.375
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0202703
Torch value at max error:18.5
Kernel value at max error:18.125

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=24 (dimensions: 16,16,96,24,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,24,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 24
  y: 4
dtype: BF16
at::einsum:
  time (contract): 9.44419e-05
  gflops: 49.9629
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->24];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->96
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->24
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf081000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=96 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000348658
  time (contract): 0.000724142
  gflops: 6.51612
-----------------------------------
max element torch :      33
max element jit :        32.75
max difference :          0.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0204082
Torch value at max error:24.5
Kernel value at max error:24

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=26 (dimensions: 16,16,96,26,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,26,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 26
  y: 4
dtype: BF16
at::einsum:
  time (contract): 9.82897e-05
  gflops: 52.0076
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->26];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->104
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->26
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86846000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=104 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000336722
  time (contract): 0.00078903
  gflops: 6.4786
-----------------------------------
max element torch :      35.25
max element jit :        35.25
max difference :          0.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0216216
Torch value at max error:22.625
Kernel value at max error:23.125

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=28 (dimensions: 16,16,96,28,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,28,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 28
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000101367
  gflops: 54.3079
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->28];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->112
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->28
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80e8a000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=112 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000347858
  time (contract): 0.000851417
  gflops: 6.46572
-----------------------------------
max element torch :      38.25
max element jit :        38
max difference :          0.625
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0230415
Torch value at max error:26.5
Kernel value at max error:27.125

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=30 (dimensions: 16,16,96,30,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,30,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 30
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00010487
  gflops: 56.2432
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->30];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->120
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->30
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5b2c000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=120 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000367601
  time (contract): 0.000897445
  gflops: 6.57226
-----------------------------------
max element torch :      41.25
max element jit :        41.25
max difference :          0.75
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0222222
Torch value at max error:33
Kernel value at max error:33.75

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=32 (dimensions: 16,16,96,32,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,32,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 32
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000109236
  gflops: 57.5949
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->32];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->128
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->32
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2f85000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=128 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.00034789
  time (contract): 0.000995059
  gflops: 6.3227
-----------------------------------
max element torch :      42.5
max element jit :        42.75
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0277778
Torch value at max error:35
Kernel value at max error:36

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=34 (dimensions: 16,16,96,34,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,34,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 34
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000112033
  gflops: 59.6672
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->34];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->136
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->34
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9cd7e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=136 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000343058
  time (contract): 0.00101172
  gflops: 6.60723
-----------------------------------
max element torch :      44
max element jit :        44
max difference :          0.75
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0222222
Torch value at max error:33.75
Kernel value at max error:33

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=36 (dimensions: 16,16,96,36,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,36,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 36
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000115939
  gflops: 61.0481
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->36];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->144
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->36
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f741000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=144 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000390608
  time (contract): 0.00108891
  gflops: 6.49996
-----------------------------------
max element torch :      46.5
max element jit :        47
max difference :          0.75
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0229008
Torch value at max error:32.75
Kernel value at max error:32

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=38 (dimensions: 16,16,96,38,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,38,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 38
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000122801
  gflops: 60.8389
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->38];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->152
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->38
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff979f6000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=152 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000347858
  time (contract): 0.00115925
  gflops: 6.44477
-----------------------------------
max element torch :      47.25
max element jit :        47.25
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.027027
Torch value at max error:37
Kernel value at max error:36

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=40 (dimensions: 16,16,96,40,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,40,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 40
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000124846
  gflops: 62.9921
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->40];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->160
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->40
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa6351000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=160 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000314548
  time (contract): 0.0011947
  gflops: 6.58268
-----------------------------------
max element torch :      51.5
max element jit :        51.75
max difference :          1
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.025974
Torch value at max error:37.5
Kernel value at max error:38.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=42 (dimensions: 16,16,96,42,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,42,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 42
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000127834
  gflops: 64.5959
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->42];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->168
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->42
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff919a6000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=168 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000342546
  time (contract): 0.0012653
  gflops: 6.52613
-----------------------------------
max element torch :      51.75
max element jit :        51.5
max difference :          1.25
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0282486
Torch value at max error:43
Kernel value at max error:44.25

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=44 (dimensions: 16,16,96,44,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,44,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 44
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000134346
  gflops: 64.3918
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->44];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->176
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->44
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbac83000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=176 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000377488
  time (contract): 0.00131533
  gflops: 6.57689
-----------------------------------
max element torch :      56.5
max element jit :        56.75
max difference :          1.25
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0282486
Torch value at max error:44.25
Kernel value at max error:43

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=46 (dimensions: 16,16,96,46,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,46,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 46
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000134896
  gflops: 67.0442
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->46];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->184
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->46
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9878d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=184 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000305747
  time (contract): 0.00138149
  gflops: 6.54651
-----------------------------------
max element torch :      57
max element jit :        57.25
max difference :          1.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.03125
Torch value at max error:48
Kernel value at max error:46.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=48 (dimensions: 16,16,96,48,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,48,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 48
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000137421
  gflops: 68.6737
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->48];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->192
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->48
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99caa000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=192 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000324467
  time (contract): 0.00146256
  gflops: 6.45251
-----------------------------------
max element torch :      62
max element jit :        62
max difference :          1.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0301508
Torch value at max error:49.75
Kernel value at max error:48.25

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=50 (dimensions: 16,16,96,50,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,50,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 50
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000143943
  gflops: 68.2935
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->50];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->200
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->50
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8f72000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=200 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000361778
  time (contract): 0.00153083
  gflops: 6.42161
-----------------------------------
max element torch :      61.25
max element jit :        61
max difference :          1.25
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0260417
Torch value at max error:48
Kernel value at max error:46.75

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=52 (dimensions: 16,16,96,52,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,52,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 52
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000144994
  gflops: 70.5105
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->52];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->208
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->52
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7657000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=208 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000364721
  time (contract): 0.00155656
  gflops: 6.56807
-----------------------------------
max element torch :      64.5
max element jit :        65
max difference :          1.25
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0274725
Torch value at max error:45.5
Kernel value at max error:44.25

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=54 (dimensions: 16,16,96,54,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,54,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 54
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000152229
  gflops: 69.7427
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->54];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->216
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->54
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b144000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=216 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000338322
  time (contract): 0.0016369
  gflops: 6.48595
-----------------------------------
max element torch :      66
max element jit :        67
max difference :          1.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0283019
Torch value at max error:53
Kernel value at max error:51.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=56 (dimensions: 16,16,96,56,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,56,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 56
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000154233
  gflops: 71.3859
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->56];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->224
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->56
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8adb0000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=224 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00044075
  time (contract): 0.00168137
  gflops: 6.54824
-----------------------------------
max element torch :      67
max element jit :        67
max difference :          1.75
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0285714
Torch value at max error:59.5
Kernel value at max error:61.25

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=58 (dimensions: 16,16,96,58,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,58,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 58
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000157608
  gflops: 72.352
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->58];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->232
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->58
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbaf56000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=232 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000318643
  time (contract): 0.00173599
  gflops: 6.56873
-----------------------------------
max element torch :      73
max element jit :        74
max difference :          1.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0276498
Torch value at max error:54.25
Kernel value at max error:52.75

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=60 (dimensions: 16,16,96,60,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,60,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 60
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000158848
  gflops: 74.2627
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->60];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->240
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->60
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81111000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=240 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000353969
  time (contract): 0.001785
  gflops: 6.60868
-----------------------------------
max element torch :      73
max element jit :        74
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0323887
Torch value at max error:59.75
Kernel value at max error:61.75

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=62 (dimensions: 16,16,96,62,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,62,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 62
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000163816
  gflops: 74.411
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->62];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->248
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->62
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff95ada000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=248 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000356433
  time (contract): 0.00190995
  gflops: 6.38222
-----------------------------------
max element torch :      81.5
max element jit :        82
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0301724
Torch value at max error:56.25
Kernel value at max error:58

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=64 (dimensions: 16,16,96,64,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,64,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 64
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000166965
  gflops: 75.3627
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->64];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->256
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->64
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb87a8000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=256 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000331282
  time (contract): 0.00201261
  gflops: 6.25204
-----------------------------------
max element torch :      78
max element jit :        78.5
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0294118
Torch value at max error:66
Kernel value at max error:68

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=66 (dimensions: 16,16,96,66,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,66,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 66
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000176526
  gflops: 73.5084
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->66];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->264
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->66
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa4a2e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=264 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000312051
  time (contract): 0.00202543
  gflops: 6.40661
-----------------------------------
max element torch :      80
max element jit :        80.5
max difference :          2.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0357143
Torch value at max error:70
Kernel value at max error:67.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=68 (dimensions: 16,16,96,68,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,68,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 68
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000177606
  gflops: 75.2755
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->68];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->272
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->68
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5b31000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=272 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000407183
  time (contract): 0.00202322
  gflops: 6.60794
-----------------------------------
max element torch :      82
max element jit :        82
max difference :          2
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.030303
Torch value at max error:66
Kernel value at max error:64

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=70 (dimensions: 16,16,96,70,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,70,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 70
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000183662
  gflops: 74.934
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->70];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->280
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->70
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9a51000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=280 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000323539
  time (contract): 0.00207207
  gflops: 6.64194
-----------------------------------
max element torch :      81.5
max element jit :        81.5
max difference :          2.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0326797
Torch value at max error:74
Kernel value at max error:76.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=72 (dimensions: 16,16,96,72,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,72,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 72
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000186436
  gflops: 75.9285
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->72];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->288
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->72
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81427000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=288 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000298292
  time (contract): 0.00214987
  gflops: 6.58448
-----------------------------------
max element torch :      84
max element jit :        84.5
max difference :          3
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0397351
Torch value at max error:75.5
Kernel value at max error:72.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=74 (dimensions: 16,16,96,74,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,74,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 74
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000185278
  gflops: 78.5253
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->74];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->296
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->74
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa88c0000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=296 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000349266
  time (contract): 0.00223472
  gflops: 6.51044
-----------------------------------
max element torch :      87.5
max element jit :        88
max difference :          2.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0340136
Torch value at max error:71
Kernel value at max error:73.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=76 (dimensions: 16,16,96,76,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,76,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 76
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000194633
  gflops: 76.7712
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->76];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->304
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->76
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad63b000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=304 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000294836
  time (contract): 0.00229236
  gflops: 6.51826
-----------------------------------
max element torch :      91.5
max element jit :        91
max difference :          2.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.033557
Torch value at max error:74.5
Kernel value at max error:72

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=78 (dimensions: 16,16,96,78,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,78,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 78
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.0001958
  gflops: 78.3217
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->78];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->312
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->78
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb0687000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=312 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00035861
  time (contract): 0.00238142
  gflops: 6.4396
-----------------------------------
max element torch :      91.5
max element jit :        92
max difference :          3
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0348837
Torch value at max error:83
Kernel value at max error:86

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=80 (dimensions: 16,16,96,80,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,80,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 80
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000203258
  gflops: 77.3826
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->80];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->320
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->80
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbe5bd000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=320 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000367633
  time (contract): 0.00238833
  gflops: 6.58561
-----------------------------------
max element torch :      97.5
max element jit :        97.5
max difference :          3
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0377358
Torch value at max error:76.5
Kernel value at max error:79.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=82 (dimensions: 16,16,96,82,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,82,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 82
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000199417
  gflops: 80.8449
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->82];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->328
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->82
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86a2c000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=328 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000337746
  time (contract): 0.00250246
  gflops: 6.44241
-----------------------------------
max element torch :      95.5
max element jit :        97
max difference :          3
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0375
Torch value at max error:80
Kernel value at max error:77

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=84 (dimensions: 16,16,96,84,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,84,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 84
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000220951
  gflops: 74.7455
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->84];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->336
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->84
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1884000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=336 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00032357
  time (contract): 0.00251664
  gflops: 6.56236
-----------------------------------
max element torch :      101.5
max element jit :        101
max difference :          3
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0377358
Torch value at max error:79.5
Kernel value at max error:76.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=86 (dimensions: 16,16,96,86,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,86,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 86
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000214004
  gflops: 79.0094
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->86];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->344
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->86
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7149000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=344 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000349554
  time (contract): 0.00255952
  gflops: 6.60604
-----------------------------------
max element torch :      100
max element jit :        100
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0427807
Torch value at max error:89.5
Kernel value at max error:93.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=88 (dimensions: 16,16,96,88,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,88,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 88
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000237389
  gflops: 72.8824
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->88];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->352
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->88
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8edfc000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=352 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000318867
  time (contract): 0.00263212
  gflops: 6.57322
-----------------------------------
max element torch :      103.5
max element jit :        104
max difference :          3.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0393258
Torch value at max error:85.5
Kernel value at max error:89

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=90 (dimensions: 16,16,96,90,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,90,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 90
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000252885
  gflops: 69.9715
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->90];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->360
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->90
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa592f000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=360 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000329266
  time (contract): 0.00267511
  gflops: 6.61457
-----------------------------------
max element torch :      104
max element jit :        105
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0434783
Torch value at max error:88
Kernel value at max error:92

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=92 (dimensions: 16,16,96,92,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,92,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 92
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000273923
  gflops: 66.0329
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->92];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->368
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->92
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbb09d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=368 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000348753
  time (contract): 0.00272672
  gflops: 6.63359
-----------------------------------
max element torch :      110
max element jit :        111
max difference :          3.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0378378
Torch value at max error:89
Kernel value at max error:92.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=94 (dimensions: 16,16,96,94,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,94,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 94
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000260557
  gflops: 70.9294
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->94];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->376
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->94
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b215000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=376 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000326962
  time (contract): 0.00278742
  gflops: 6.63021
-----------------------------------
max element torch :      110.5
max element jit :        112
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0416667
Torch value at max error:96
Kernel value at max error:92

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=96 (dimensions: 16,16,96,96,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,96,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 96
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000273998
  gflops: 68.8851
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->96];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->384
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->96
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8a25b000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=384 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000352242
  time (contract): 0.00297739
  gflops: 6.33924
-----------------------------------
max element torch :      111.5
max element jit :        112
max difference :          3.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0376344
Torch value at max error:93
Kernel value at max error:89.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=98 (dimensions: 16,16,96,98,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,98,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 98
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00027812
  gflops: 69.2779
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->98];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->392
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->98
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88db0000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=392 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000321491
  time (contract): 0.00288963
  gflops: 6.66784
-----------------------------------
max element torch :      117
max element jit :        117
max difference :          4.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0456853
Torch value at max error:98.5
Kernel value at max error:94

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=100 (dimensions: 16,16,96,100,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,100,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 100
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000270162
  gflops: 72.7742
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->100];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->400
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->100
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82e19000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=400 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000319571
  time (contract): 0.00303472
  gflops: 6.47863
-----------------------------------
max element torch :      115.5
max element jit :        114.5
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.040404
Torch value at max error:95
Kernel value at max error:99

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=102 (dimensions: 16,16,96,102,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,102,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 102
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000273509
  gflops: 73.3213
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->102];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->408
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->102
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94435000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=408 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000362193
  time (contract): 0.00305146
  gflops: 6.57195
-----------------------------------
max element torch :      122
max element jit :        121
max difference :          3.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0364583
Torch value at max error:92.5
Kernel value at max error:96

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=104 (dimensions: 16,16,96,104,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,104,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 104
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000283422
  gflops: 72.1441
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->104];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->416
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->104
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c68e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=416 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000330291
  time (contract): 0.0030933
  gflops: 6.61018
-----------------------------------
max element torch :      121.5
max element jit :        122
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0372093
Torch value at max error:103.5
Kernel value at max error:107.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=106 (dimensions: 16,16,96,106,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,106,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 106
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000244205
  gflops: 85.34
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->106];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->424
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->106
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f732000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=424 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000305459
  time (contract): 0.00320897
  gflops: 6.49443
-----------------------------------
max element torch :      126.5
max element jit :        126
max difference :          4.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.039801
Torch value at max error:100.5
Kernel value at max error:96.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=108 (dimensions: 16,16,96,108,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,108,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 108
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000253154
  gflops: 83.8765
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->108];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->432
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->108
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff908b2000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=432 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000367793
  time (contract): 0.00326871
  gflops: 6.49603
-----------------------------------
max element torch :      124.5
max element jit :        126
max difference :          4
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.04
Torch value at max error:96
Kernel value at max error:100

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=110 (dimensions: 16,16,96,110,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,110,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 110
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000298719
  gflops: 72.3988
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->110];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->440
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->110
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaa1a9000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=440 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000333522
  time (contract): 0.00325589
  gflops: 6.64239
-----------------------------------
max element torch :      129
max element jit :        130
max difference :          4.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0379147
Torch value at max error:105.5
Kernel value at max error:101.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=112 (dimensions: 16,16,96,112,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,112,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 112
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000303957
  gflops: 72.4449
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->112];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->448
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->112
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa3a6f000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=448 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000384528
  time (contract): 0.00337481
  gflops: 6.52485
-----------------------------------
max element torch :      129
max element jit :        130
max difference :          5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0442478
Torch value at max error:113
Kernel value at max error:108

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=114 (dimensions: 16,16,96,114,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,114,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 114
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000307125
  gflops: 72.9778
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->114];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->456
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->114
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87e5a000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=456 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00028754
  time (contract): 0.00349463
  gflops: 6.41365
-----------------------------------
max element torch :      134
max element jit :        135
max difference :          4.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.040724
Torch value at max error:110.5
Kernel value at max error:106

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=116 (dimensions: 16,16,96,116,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,116,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 116
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000306256
  gflops: 74.4689
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->116];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->464
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->116
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff863ce000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=464 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00028962
  time (contract): 0.00350655
  gflops: 6.50399
-----------------------------------
max element torch :      134
max element jit :        134
max difference :          4.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0396476
Torch value at max error:109
Kernel value at max error:113.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=118 (dimensions: 16,16,96,118,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,118,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 118
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000314469
  gflops: 73.7744
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->118];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->472
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->118
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9942e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=472 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000370321
  time (contract): 0.00349592
  gflops: 6.63624
-----------------------------------
max element torch :      136
max element jit :        135
max difference :          4.5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0422535
Torch value at max error:106.5
Kernel value at max error:102

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=120 (dimensions: 16,16,96,120,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,120,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 120
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000310903
  gflops: 75.8852
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->120];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->480
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->120
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa59ac000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=480 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000323602
  time (contract): 0.00363066
  gflops: 6.49825
-----------------------------------
max element torch :      139
max element jit :        140
max difference :          5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0420168
Torch value at max error:114
Kernel value at max error:119

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=122 (dimensions: 16,16,96,122,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,122,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 122
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000327841
  gflops: 73.164
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->122];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->488
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->122
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d4b6000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=488 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000332659
  time (contract): 0.00361029
  gflops: 6.64383
-----------------------------------
max element torch :      142
max element jit :        144
max difference :          5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.039823
Torch value at max error:113
Kernel value at max error:108.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=124 (dimensions: 16,16,96,124,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,124,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 124
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000331795
  gflops: 73.4772
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->124];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->496
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->124
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbda0f000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=496 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000362642
  time (contract): 0.00373791
  gflops: 6.5222
-----------------------------------
max element torch :      143
max element jit :        144
max difference :          5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0392157
Torch value at max error:122.5
Kernel value at max error:127.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=126 (dimensions: 16,16,96,126,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,126,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 126
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000339033
  gflops: 73.0684
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->126];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->504
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->126
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9be26000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=504 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000334643
  time (contract): 0.00380689
  gflops: 6.50731
-----------------------------------
max element torch :      142
max element jit :        144
max difference :          5
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0381356
Torch value at max error:118
Kernel value at max error:113.5

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=128 (dimensions: 16,16,96,128,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,128,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 128
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000352131
  gflops: 71.4672
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->128];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->512
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->128
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb3542000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=512 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000379057
  time (contract): 0.0045212
  gflops: 5.56619
-----------------------------------
max element torch :      147
max element jit :        147
max difference :          6
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0437956
Torch value at max error:131
Kernel value at max error:137

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=130 (dimensions: 16,16,96,130,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,130,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 130
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000362552
  gflops: 70.4976
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->130];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->520
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->130
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff98eb6000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=520 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000356529
  time (contract): 0.00397131
  gflops: 6.43592
-----------------------------------
max element torch :      147
max element jit :        147
max difference :          6
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0431655
Torch value at max error:133
Kernel value at max error:139

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=132 (dimensions: 16,16,96,132,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,132,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 132
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000349464
  gflops: 74.263
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->132];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->528
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->132
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb1f05000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=528 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000291605
  time (contract): 0.00398073
  gflops: 6.51947
-----------------------------------
max element torch :      148
max element jit :        150
max difference :          6
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0434783
Torch value at max error:132
Kernel value at max error:138

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=134 (dimensions: 16,16,96,134,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,134,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 134
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000360912
  gflops: 72.9969
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->134];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->536
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->134
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84f1f000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=536 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000378353
  time (contract): 0.00397827
  gflops: 6.62235
-----------------------------------
max element torch :      153
max element jit :        155
max difference :          6
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0434783
Torch value at max error:132
Kernel value at max error:138

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=136 (dimensions: 16,16,96,136,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,136,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 136
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000371786
  gflops: 71.9196
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->136];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->544
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->136
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8ff9e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=544 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000366513
  time (contract): 0.004138
  gflops: 6.46174
-----------------------------------
max element torch :      155
max element jit :        156
max difference :          6
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0447761
Torch value at max error:134
Kernel value at max error:128

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=138 (dimensions: 16,16,96,138,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,138,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 138
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000363751
  gflops: 74.5893
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->138];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->552
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->138
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaa729000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=552 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000295412
  time (contract): 0.00410978
  gflops: 6.60179
-----------------------------------
max element torch :      159
max element jit :        160
max difference :          7
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0482759
Torch value at max error:138
Kernel value at max error:145

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=140 (dimensions: 16,16,96,140,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,140,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 140
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000373244
  gflops: 73.7457
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->140];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->560
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->140
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4bd1000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=560 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000354258
  time (contract): 0.00416359
  gflops: 6.6109
-----------------------------------
max element torch :      157
max element jit :        158
max difference :          7
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0466667
Torch value at max error:143
Kernel value at max error:150

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=142 (dimensions: 16,16,96,142,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,142,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 142
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000375704
  gflops: 74.3094
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->142];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->568
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->142
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa4205000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=568 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000319858
  time (contract): 0.00422769
  gflops: 6.60368
-----------------------------------
max element torch :      163
max element jit :        166
max difference :          7
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0479452
Torch value at max error:139
Kernel value at max error:146

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=144 (dimensions: 16,16,96,144,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,144,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 144
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000385401
  gflops: 73.46
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->144];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->576
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->144
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbe242000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=576 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000381201
  time (contract): 0.00440311
  gflops: 6.4299
-----------------------------------
max element torch :      166
max element jit :        167
max difference :          8
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0516129
Torch value at max error:147
Kernel value at max error:155

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=146 (dimensions: 16,16,96,146,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,146,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 146
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000395319
  gflops: 72.6117
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->146];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->584
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->146
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4def000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=584 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000297331
  time (contract): 0.00455703
  gflops: 6.29901
-----------------------------------
max element torch :      167
max element jit :        168
max difference :          7
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.05
Torch value at max error:140
Kernel value at max error:133

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=148 (dimensions: 16,16,96,148,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,148,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 148
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000396859
  gflops: 73.3206
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->148];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->592
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->148
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8927000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=592 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000340946
  time (contract): 0.00445301
  gflops: 6.53445
-----------------------------------
max element torch :      168
max element jit :        168
max difference :          7
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0472973
Torch value at max error:148
Kernel value at max error:141

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=150 (dimensions: 16,16,96,150,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,150,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 150
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000398601
  gflops: 73.9867
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->150];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->600
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->150
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90d67000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=600 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000352849
  time (contract): 0.00452167
  gflops: 6.52219
-----------------------------------
max element torch :      172
max element jit :        171
max difference :          8
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0496894
Torch value at max error:153
Kernel value at max error:161

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=152 (dimensions: 16,16,96,152,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,152,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 152
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000402026
  gflops: 74.3345
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->152];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->608
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->152
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc034000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=608 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000327122
  time (contract): 0.0046025
  gflops: 6.49309
-----------------------------------
max element torch :      172
max element jit :        175
max difference :          8
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0467836
Torch value at max error:163
Kernel value at max error:171

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=154 (dimensions: 16,16,96,154,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,154,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 154
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000405236
  gflops: 74.7161
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->154];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->616
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->154
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7f9ae000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=616 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000325618
  time (contract): 0.00464607
  gflops: 6.51683
-----------------------------------
max element torch :      173
max element jit :        176
max difference :          8
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0487805
Torch value at max error:156
Kernel value at max error:164

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=156 (dimensions: 16,16,96,156,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,156,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 156
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000421431
  gflops: 72.7778
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->156];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->624
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->156
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbcd6a000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=624 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000311635
  time (contract): 0.00474221
  gflops: 6.46763
-----------------------------------
max element torch :      176
max element jit :        182
max difference :          9
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.054878
Torch value at max error:155
Kernel value at max error:164

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=158 (dimensions: 16,16,96,158,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,158,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 158
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000422208
  gflops: 73.5752
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->158];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->632
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->158
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffab57d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=632 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000323603
  time (contract): 0.00491948
  gflops: 6.3145
-----------------------------------
max element torch :      178
max element jit :        183
max difference :          8
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0509554
Torch value at max error:149
Kernel value at max error:157

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=160 (dimensions: 16,16,96,160,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,160,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 160
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000417613
  gflops: 75.3265
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->160];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->640
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->160
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80697000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=640 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000383664
  time (contract): 0.00501504
  gflops: 6.27259
-----------------------------------
max element torch :      179
max element jit :        180
max difference :          9
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0559006
Torch value at max error:152
Kernel value at max error:161

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=162 (dimensions: 16,16,96,162,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,162,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 162
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000426425
  gflops: 74.6919
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->162];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->648
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->162
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8bbfa000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=648 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000304404
  time (contract): 0.00486845
  gflops: 6.54222
-----------------------------------
max element torch :      181
max element jit :        182
max difference :          9
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0542169
Torch value at max error:166
Kernel value at max error:157

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=164 (dimensions: 16,16,96,164,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,164,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 164
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000411512
  gflops: 78.3543
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->164];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->656
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->164
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa51a7000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=656 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000298964
  time (contract): 0.00504252
  gflops: 6.39437
-----------------------------------
max element torch :      184
max element jit :        187
max difference :          8
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0522876
Torch value at max error:153
Kernel value at max error:145

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=166 (dimensions: 16,16,96,166,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,166,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 166
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000430104
  gflops: 75.8815
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->166];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->664
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->166
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99c21000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=664 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000347377
  time (contract): 0.00517686
  gflops: 6.30438
-----------------------------------
max element torch :      185
max element jit :        187
max difference :          10
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0588235
Torch value at max error:170
Kernel value at max error:160

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=168 (dimensions: 16,16,96,168,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,168,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 168
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000424133
  gflops: 77.8768
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->168];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->672
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->168
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffabfe7000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=672 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000321235
  time (contract): 0.00510609
  gflops: 6.46878
-----------------------------------
max element torch :      190
max element jit :        189
max difference :          10
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0595238
Torch value at max error:158
Kernel value at max error:168

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=170 (dimensions: 16,16,96,170,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,170,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 170
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000429079
  gflops: 77.8956
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->170];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->680
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->170
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1eb1000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=680 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000391153
  time (contract): 0.00515001
  gflops: 6.48997
-----------------------------------
max element torch :      194
max element jit :        196
max difference :          9
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0502793
Torch value at max error:170
Kernel value at max error:179

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=172 (dimensions: 16,16,96,172,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,172,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 172
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000385678
  gflops: 87.6807
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->172];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->688
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->172
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9cee7000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=688 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000323731
  time (contract): 0.00521943
  gflops: 6.47898
-----------------------------------
max element torch :      192
max element jit :        195
max difference :          10
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0588235
Torch value at max error:170
Kernel value at max error:160

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=174 (dimensions: 16,16,96,174,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,174,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 174
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000455298
  gflops: 75.1372
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->174];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->696
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->174
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb3cf5000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=696 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000332114
  time (contract): 0.00521667
  gflops: 6.55778
-----------------------------------
max element torch :      199
max element jit :        202
max difference :          12
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0621762
Torch value at max error:181
Kernel value at max error:193

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=176 (dimensions: 16,16,96,176,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,176,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 176
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000473157
  gflops: 73.1322
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->176];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->704
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->176
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa150f000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=704 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000356562
  time (contract): 0.00535795
  gflops: 6.45825
-----------------------------------
max element torch :      196
max element jit :        199
max difference :          10
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0571429
Torch value at max error:165
Kernel value at max error:175

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=178 (dimensions: 16,16,96,178,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,178,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 178
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000434809
  gflops: 80.4864
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->178];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->712
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->178
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89c8c000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=712 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000347346
  time (contract): 0.0055618
  gflops: 6.29225
-----------------------------------
max element torch :      199
max element jit :        202
max difference :          10
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0529412
Torch value at max error:170
Kernel value at max error:161

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=180 (dimensions: 16,16,96,180,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,180,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 180
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000459653
  gflops: 76.9917
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->180];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->720
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->180
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8f88c000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=720 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000356754
  time (contract): 0.00540339
  gflops: 6.54949
-----------------------------------
max element torch :      201
max element jit :        203
max difference :          10
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0558659
Torch value at max error:179
Kernel value at max error:169

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=182 (dimensions: 16,16,96,182,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,182,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 182
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000427012
  gflops: 83.7978
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->182];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->728
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->182
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb74e5000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=728 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000362641
  time (contract): 0.00562858
  gflops: 6.35732
-----------------------------------
max element torch :      203
max element jit :        207
max difference :          10
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0574713
Torch value at max error:174
Kernel value at max error:164

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=184 (dimensions: 16,16,96,184,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,184,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 184
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000475122
  gflops: 76.1401
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->184];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->736
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->184
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84550000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=736 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000328978
  time (contract): 0.00554958
  gflops: 6.51867
-----------------------------------
max element torch :      204
max element jit :        208
max difference :          15
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0773196
Torch value at max error:179
Kernel value at max error:194

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=186 (dimensions: 16,16,96,186,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,186,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 186
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000491372
  gflops: 74.4225
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->186];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->744
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->186
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaeca0000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=744 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000332403
  time (contract): 0.00609751
  gflops: 5.99738
-----------------------------------
max element torch :      206
max element jit :        209
max difference :          11
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0569948
Torch value at max error:182
Kernel value at max error:193

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=188 (dimensions: 16,16,96,188,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,188,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 188
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000482324
  gflops: 76.6337
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->188];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->752
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->188
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a077000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=752 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000333394
  time (contract): 0.00562909
  gflops: 6.56631
-----------------------------------
max element torch :      212
max element jit :        213
max difference :          10
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0515464
Torch value at max error:184
Kernel value at max error:194

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=190 (dimensions: 16,16,96,190,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,190,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 190
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000490505
  gflops: 76.1573
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->190];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->760
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->190
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4fc2000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=760 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000360849
  time (contract): 0.00577939
  gflops: 6.46357
-----------------------------------
max element torch :      212
max element jit :        217
max difference :          11
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.055
Torch value at max error:189
Kernel value at max error:200

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=192 (dimensions: 16,16,96,192,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,192,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 192
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000493665
  gflops: 76.4663
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->192];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->768
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->192
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a932000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=768 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000349042
  time (contract): 0.00605261
  gflops: 6.23677
-----------------------------------
max element torch :      213
max element jit :        220
max difference :          11
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0552764
Torch value at max error:188
Kernel value at max error:199

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=194 (dimensions: 16,16,96,194,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,194,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 194
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000498858
  gflops: 76.4585
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->194];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->776
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->194
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5f44000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=776 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000288468
  time (contract): 0.00586184
  gflops: 6.50682
-----------------------------------
max element torch :      218
max element jit :        222
max difference :          12
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0631579
Torch value at max error:190
Kernel value at max error:178

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=196 (dimensions: 16,16,96,196,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,196,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 196
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000504691
  gflops: 76.354
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->196];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->784
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->196
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa76b8000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=784 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000382673
  time (contract): 0.00595242
  gflops: 6.47387
-----------------------------------
max element torch :      216
max element jit :        219
max difference :          13
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0616114
Torch value at max error:198
Kernel value at max error:211

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=198 (dimensions: 16,16,96,198,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,198,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 198
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000514007
  gflops: 75.7351
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->198];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->792
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->198
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9da3000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=792 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000309139
  time (contract): 0.00602994
  gflops: 6.45585
-----------------------------------
max element torch :      222
max element jit :        226
max difference :          13
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.059633
Torch value at max error:205
Kernel value at max error:218

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=200 (dimensions: 16,16,96,200,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,200,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 200
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000515652
  gflops: 76.256
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->200];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->800
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->200
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90d65000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=800 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00031074
  time (contract): 0.00607229
  gflops: 6.47558
-----------------------------------
max element torch :      221
max element jit :        224
max difference :          12
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0576923
Torch value at max error:196
Kernel value at max error:208

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=202 (dimensions: 16,16,96,202,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,202,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 202
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000511516
  gflops: 77.6414
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->202];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->808
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->202
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff858ab000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=808 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000357842
  time (contract): 0.00610726
  gflops: 6.50288
-----------------------------------
max element torch :      222
max element jit :        226
max difference :          12
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0552995
Torch value at max error:205
Kernel value at max error:217

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=204 (dimensions: 16,16,96,204,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,204,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 204
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000520834
  gflops: 77.0074
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->204];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->816
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->204
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaff06000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=816 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000335442
  time (contract): 0.00620986
  gflops: 6.45876
-----------------------------------
max element torch :      224
max element jit :        231
max difference :          11
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0526316
Torch value at max error:209
Kernel value at max error:198

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=206 (dimensions: 16,16,96,206,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,206,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 206
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000533378
  gflops: 75.9334
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->206];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->824
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->206
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5a3c000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=824 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000357681
  time (contract): 0.00624817
  gflops: 6.4821
-----------------------------------
max element torch :      231
max element jit :        232
max difference :          12
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0561224
Torch value at max error:196
Kernel value at max error:185

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=208 (dimensions: 16,16,96,208,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,208,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 208
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000533475
  gflops: 76.6567
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->208];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->832
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->208
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb834e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=832 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000306611
  time (contract): 0.0064128
  gflops: 6.37701
-----------------------------------
max element torch :      233
max element jit :        236
max difference :          14
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0619469
Torch value at max error:212
Kernel value at max error:226

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=210 (dimensions: 16,16,96,210,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,210,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 210
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000544986
  gflops: 75.7591
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->210];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->840
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->210
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb28b0000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=840 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000354514
  time (contract): 0.00642287
  gflops: 6.42823
-----------------------------------
max element torch :      235
max element jit :        238
max difference :          12
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0574163
Torch value at max error:197
Kernel value at max error:209

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=212 (dimensions: 16,16,96,212,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,212,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 212
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000546787
  gflops: 76.2288
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->212];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->848
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->212
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92d71000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=848 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000339699
  time (contract): 0.00646728
  gflops: 6.44489
-----------------------------------
max element torch :      233
max element jit :        238
max difference :          13
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0616114
Torch value at max error:211
Kernel value at max error:198

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=214 (dimensions: 16,16,96,214,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,214,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 214
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000555111
  gflops: 75.7941
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->214];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->856
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->214
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81cef000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=856 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000333138
  time (contract): 0.00665291
  gflops: 6.32417
-----------------------------------
max element torch :      236
max element jit :        243
max difference :          12
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0545455
Torch value at max error:208
Kernel value at max error:220

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=216 (dimensions: 16,16,96,216,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,216,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 216
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00055333
  gflops: 76.7487
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->216];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->864
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->216
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5b56000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=864 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000364081
  time (contract): 0.00652029
  gflops: 6.51311
-----------------------------------
max element torch :      244
max element jit :        247
max difference :          15
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0643777
Torch value at max error:218
Kernel value at max error:233

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=218 (dimensions: 16,16,96,218,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,218,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 218
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000558574
  gflops: 76.7321
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->218];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->872
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->218
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7b08000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=872 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00034725
  time (contract): 0.00664477
  gflops: 6.45027
-----------------------------------
max element torch :      244
max element jit :        248
max difference :          13
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0588235
Torch value at max error:208
Kernel value at max error:221

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=220 (dimensions: 16,16,96,220,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,220,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 220
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000431237
  gflops: 100.302
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->220];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->880
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->220
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaeee7000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=880 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000387344
  time (contract): 0.00668578
  gflops: 6.46952
-----------------------------------
max element torch :      246
max element jit :        248
max difference :          13
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0560345
Torch value at max error:219
Kernel value at max error:232

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=222 (dimensions: 16,16,96,222,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,222,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 222
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000435679
  gflops: 100.182
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->222];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->888
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->222
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba7a6000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=888 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000327859
  time (contract): 0.00671484
  gflops: 6.50008
-----------------------------------
max element torch :      248
max element jit :        249
max difference :          13
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0575221
Torch value at max error:213
Kernel value at max error:226

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=224 (dimensions: 16,16,96,224,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,224,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 224
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000435281
  gflops: 101.176
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->224];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->896
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->224
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81ff7000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=896 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000313619
  time (contract): 0.00709878
  gflops: 6.20391
-----------------------------------
max element torch :      247
max element jit :        251
max difference :          14
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0600858
Torch value at max error:219
Kernel value at max error:233

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=226 (dimensions: 16,16,96,226,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,226,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 226
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000445883
  gflops: 99.6525
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->226];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->904
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->226
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbaac7000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=904 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000403407
  time (contract): 0.00683251
  gflops: 6.50323
-----------------------------------
max element torch :      249
max element jit :        252
max difference :          15
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0694444
Torch value at max error:216
Kernel value at max error:201

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=228 (dimensions: 16,16,96,228,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,228,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 228
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000441187
  gflops: 101.605
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->228];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->912
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->228
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbae59000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=912 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000352946
  time (contract): 0.00729096
  gflops: 6.14825
-----------------------------------
max element torch :      252
max element jit :        256
max difference :          13
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0560345
Torch value at max error:219
Kernel value at max error:232

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=230 (dimensions: 16,16,96,230,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,230,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 230
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000454193
  gflops: 99.5609
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->230];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->920
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->230
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9105000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=920 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000329938
  time (contract): 0.00684184
  gflops: 6.60931
-----------------------------------
max element torch :      253
max element jit :        258
max difference :          14
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0608696
Torch value at max error:216
Kernel value at max error:230

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=232 (dimensions: 16,16,96,232,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,232,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 232
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000448534
  gflops: 101.694
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->232];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->928
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->232
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbda2d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=928 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00037512
  time (contract): 0.0070448
  gflops: 6.47471
-----------------------------------
max element torch :      256
max element jit :        264
max difference :          15
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0609756
Torch value at max error:231
Kernel value at max error:246

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=234 (dimensions: 16,16,96,234,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,234,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 234
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000454389
  gflops: 101.249
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->234];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->936
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->234
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff81f0e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=936 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00033893
  time (contract): 0.00717154
  gflops: 6.41512
-----------------------------------
max element torch :      256
max element jit :        262
max difference :          14
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0565217
Torch value at max error:217
Kernel value at max error:230

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=236 (dimensions: 16,16,96,236,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,236,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 236
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000454463
  gflops: 102.097
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->236];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->944
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->236
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8437000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=944 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000391856
  time (contract): 0.00713176
  gflops: 6.50604
-----------------------------------
max element torch :      256
max element jit :        266
max difference :          14
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0571429
Torch value at max error:231
Kernel value at max error:245

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=238 (dimensions: 16,16,96,238,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,238,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 238
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000466013
  gflops: 100.411
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->238];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->952
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->238
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8dce1000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=952 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000321491
  time (contract): 0.00720892
  gflops: 6.49095
-----------------------------------
max element torch :      264
max element jit :        272
max difference :          15
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0588235
Torch value at max error:240
Kernel value at max error:255

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=240 (dimensions: 16,16,96,240,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,240,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 240
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000460703
  gflops: 102.422
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->240];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->960
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->240
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82dd7000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=960 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000508107
  time (contract): 0.00745691
  gflops: 6.32781
-----------------------------------
max element torch :      264
max element jit :        268
max difference :          15
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.059761
Torch value at max error:236
Kernel value at max error:251

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=242 (dimensions: 16,16,96,242,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,242,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 242
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000466557
  gflops: 101.979
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->242];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->968
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->242
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff95fbe000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=968 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000376753
  time (contract): 0.00730311
  gflops: 6.51492
-----------------------------------
max element torch :      272
max element jit :        274
max difference :          16
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0615385
Torch value at max error:244
Kernel value at max error:260

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=244 (dimensions: 16,16,96,244,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,244,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 244
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000467884
  gflops: 102.531
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->244];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->976
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->244
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad2c7000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=976 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000340626
  time (contract): 0.00738887
  gflops: 6.49252
-----------------------------------
max element torch :      270
max element jit :        274
max difference :          16
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0645161
Torch value at max error:232
Kernel value at max error:248

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=246 (dimensions: 16,16,96,246,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,246,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 246
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000473722
  gflops: 102.097
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->246];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->984
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->246
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa02df000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=984 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000305684
  time (contract): 0.00747978
  gflops: 6.46617
-----------------------------------
max element torch :      272
max element jit :        280
max difference :          15
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0568182
Torch value at max error:249
Kernel value at max error:264

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=248 (dimensions: 16,16,96,248,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,248,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 248
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000477517
  gflops: 102.109
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->248];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->992
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->248
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2be3000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=992 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000410255
  time (contract): 0.00756764
  gflops: 6.44306
-----------------------------------
max element torch :      276
max element jit :        278
max difference :          16
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0610687
Torch value at max error:246
Kernel value at max error:262

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=250 (dimensions: 16,16,96,250,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,250,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 250
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000480184
  gflops: 102.361
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->250];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1000
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->250
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff890aa000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1000 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000398735
  time (contract): 0.00752008
  gflops: 6.5361
-----------------------------------
max element torch :      272
max element jit :        278
max difference :          17
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0643939
Torch value at max error:247
Kernel value at max error:264

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=252 (dimensions: 16,16,96,252,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,252,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 252
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000486144
  gflops: 101.915
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->252];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1008
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->252
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb681d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1008 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000372657
  time (contract): 0.00776575
  gflops: 6.37997
-----------------------------------
max element torch :      282
max element jit :        286
max difference :          18
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0656934
Torch value at max error:256
Kernel value at max error:274

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=254 (dimensions: 16,16,96,254,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,254,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 254
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000488078
  gflops: 102.316
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->254];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1016
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->254
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9491e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1016 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000327507
  time (contract): 0.00776233
  gflops: 6.43343
-----------------------------------
max element torch :      278
max element jit :        284
max difference :          16
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0590551
Torch value at max error:254
Kernel value at max error:239

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=256 (dimensions: 16,16,96,256,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,256,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 256
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000511513
  gflops: 98.3976
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->256];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1024
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->256
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92141000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1024 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000362578
  time (contract): 0.00951555
  gflops: 5.28941
-----------------------------------
max element torch :      288
max element jit :        292
max difference :          18
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0642857
Torch value at max error:262
Kernel value at max error:280

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=258 (dimensions: 16,16,96,258,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,258,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 258
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000495133
  gflops: 102.447
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->258];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1032
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->258
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff999fa000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1032 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000338098
  time (contract): 0.00779058
  gflops: 6.51105
-----------------------------------
max element torch :      288
max element jit :        296
max difference :          16
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0606061
Torch value at max error:248
Kernel value at max error:264

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=260 (dimensions: 16,16,96,260,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,260,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 260
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000497606
  gflops: 102.728
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->260];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1040
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->260
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88778000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1040 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000355633
  time (contract): 0.00795751
  gflops: 6.42388
-----------------------------------
max element torch :      286
max element jit :        298
max difference :          18
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0652174
Torch value at max error:258
Kernel value at max error:276

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=262 (dimensions: 16,16,96,262,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,262,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 262
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000504468
  gflops: 102.11
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->262];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1048
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->262
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff91d6f000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1048 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.00040648
  time (contract): 0.00797051
  gflops: 6.46273
-----------------------------------
max element torch :      286
max element jit :        296
max difference :          16
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0615385
Torch value at max error:244
Kernel value at max error:260

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=264 (dimensions: 16,16,96,264,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,264,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 264
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000503533
  gflops: 103.081
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->264];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1056
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->264
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb816e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1056 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000369041
  time (contract): 0.00806164
  gflops: 6.43845
-----------------------------------
max element torch :      292
max element jit :        300
max difference :          17
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0625
Torch value at max error:255
Kernel value at max error:272

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=266 (dimensions: 16,16,96,266,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,266,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 266
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000511157
  gflops: 102.312
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->266];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1064
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->266
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2b29000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1064 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00035589
  time (contract): 0.00814568
  gflops: 6.4203
-----------------------------------
max element torch :      290
max element jit :        296
max difference :          16
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0571429
Torch value at max error:280
Kernel value at max error:264

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=268 (dimensions: 16,16,96,268,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,268,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 268
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000510509
  gflops: 103.213
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->268];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1072
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->268
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8455b000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1072 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00034965
  time (contract): 0.00820763
  gflops: 6.41975
-----------------------------------
max element torch :      294
max element jit :        298
max difference :          18
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0647482
Torch value at max error:278
Kernel value at max error:260

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=270 (dimensions: 16,16,96,270,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,270,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 270
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00051186
  gflops: 103.708
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->270];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1080
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->270
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2412000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1080 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000364977
  time (contract): 0.00817383
  gflops: 6.4944
-----------------------------------
max element torch :      294
max element jit :        304
max difference :          18
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.062069
Torch value at max error:272
Kernel value at max error:290

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=272 (dimensions: 16,16,96,272,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,272,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 272
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000520547
  gflops: 102.733
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->272];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1088
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->272
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8dc40000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1088 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.0003788
  time (contract): 0.00835554
  gflops: 6.40023
-----------------------------------
max element torch :      298
max element jit :        310
max difference :          18
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0633803
Torch value at max error:266
Kernel value at max error:284

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=274 (dimensions: 16,16,96,274,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,274,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 274
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000523505
  gflops: 102.904
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->274];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1096
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->274
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80c92000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1096 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000369521
  time (contract): 0.00845364
  gflops: 6.37248
-----------------------------------
max element torch :      302
max element jit :        306
max difference :          18
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0629371
Torch value at max error:286
Kernel value at max error:268

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=276 (dimensions: 16,16,96,276,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,276,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 276
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000527011
  gflops: 102.965
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->276];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1104
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->276
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb7153000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1104 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000322387
  time (contract): 0.00826663
  gflops: 6.5642
-----------------------------------
max element torch :      302
max element jit :        306
max difference :          22
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0723684
Torch value at max error:282
Kernel value at max error:304

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=278 (dimensions: 16,16,96,278,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,278,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 278
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00053088
  gflops: 102.956
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->278];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1112
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->278
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffacebd000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1112 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000411791
  time (contract): 0.00844441
  gflops: 6.47257
-----------------------------------
max element torch :      304
max element jit :        312
max difference :          20
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.070922
Torch value at max error:282
Kernel value at max error:262

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=280 (dimensions: 16,16,96,280,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,280,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 280
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000529526
  gflops: 103.961
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->280];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1120
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->280
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ec23000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1120 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000371057
  time (contract): 0.00854281
  gflops: 6.44404
-----------------------------------
max element torch :      306
max element jit :        316
max difference :          18
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0642857
Torch value at max error:280
Kernel value at max error:262

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=282 (dimensions: 16,16,96,282,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,282,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 282
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000536047
  gflops: 103.43
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->282];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1128
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->282
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff93916000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1128 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000300916
  time (contract): 0.00857272
  gflops: 6.46743
-----------------------------------
max element torch :      308
max element jit :        320
max difference :          20
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0629371
Torch value at max error:286
Kernel value at max error:268

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=284 (dimensions: 16,16,96,284,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,284,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 284
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000536955
  gflops: 103.988
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->284];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1136
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->284
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaffa2000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1136 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000335154
  time (contract): 0.00873134
  gflops: 6.39497
-----------------------------------
max element torch :      308
max element jit :        312
max difference :          22
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0753425
Torch value at max error:292
Kernel value at max error:270

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=286 (dimensions: 16,16,96,286,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,286,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 286
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000544078
  gflops: 103.349
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->286];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1144
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->286
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa181f000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1144 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000316372
  time (contract): 0.00864072
  gflops: 6.50754
-----------------------------------
max element torch :      312
max element jit :        324
max difference :          22
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0758621
Torch value at max error:290
Kernel value at max error:268

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=288 (dimensions: 16,16,96,288,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,288,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 288
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000549869
  gflops: 102.976
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->288];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1152
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->288
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90c7d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1152 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000402
  time (contract): 0.00909927
  gflops: 6.22282
-----------------------------------
max element torch :      314
max element jit :        324
max difference :          22
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0699301
Torch value at max error:286
Kernel value at max error:266

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=290 (dimensions: 16,16,96,290,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,290,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 290
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000551508
  gflops: 103.383
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->290];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1160
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->290
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffacebb000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1160 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000371633
  time (contract): 0.00885843
  gflops: 6.43639
-----------------------------------
max element torch :      312
max element jit :        322
max difference :          24
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0839161
Torch value at max error:286
Kernel value at max error:262

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=292 (dimensions: 16,16,96,292,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,292,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 292
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00055216
  gflops: 103.973
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->292];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1168
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->292
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa60f2000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1168 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000362321
  time (contract): 0.00941905
  gflops: 6.09505
-----------------------------------
max element torch :      318
max element jit :        328
max difference :          22
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0780142
Torch value at max error:282
Kernel value at max error:260

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=294 (dimensions: 16,16,96,294,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,294,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 294
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000558008
  gflops: 103.588
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->294];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1176
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->294
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa7707000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1176 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000389968
  time (contract): 0.00892083
  gflops: 6.47952
-----------------------------------
max element torch :      318
max element jit :        326
max difference :          22
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0753425
Torch value at max error:292
Kernel value at max error:270

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=296 (dimensions: 16,16,96,296,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,296,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 296
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000552405
  gflops: 105.35
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->296];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1184
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->296
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84f5c000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1184 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000346994
  time (contract): 0.00898893
  gflops: 6.47418
-----------------------------------
max element torch :      322
max element jit :        332
max difference :          22
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0723684
Torch value at max error:304
Kernel value at max error:282

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=298 (dimensions: 16,16,96,298,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,298,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 298
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000561126
  gflops: 104.414
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->298];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1192
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->298
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd597000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1192 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000343826
  time (contract): 0.00934214
  gflops: 6.2715
-----------------------------------
max element torch :      322
max element jit :        334
max difference :          24
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.075
Torch value at max error:296
Kernel value at max error:320

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=300 (dimensions: 16,16,96,300,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,300,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 300
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000562929
  gflops: 104.778
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->300];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1200
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->300
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb168c000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1200 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000373041
  time (contract): 0.00905956
  gflops: 6.51052
-----------------------------------
max element torch :      330
max element jit :        332
max difference :          26
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.083871
Torch value at max error:310
Kernel value at max error:284

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=302 (dimensions: 16,16,96,302,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,302,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 302
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000568489
  gflops: 104.445
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->302];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1208
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->302
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa2f52000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1208 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000366417
  time (contract): 0.00932229
  gflops: 6.36921
-----------------------------------
max element torch :      328
max element jit :        342
max difference :          24
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0810811
Torch value at max error:296
Kernel value at max error:272

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=304 (dimensions: 16,16,96,304,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,304,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 304
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00057001
  gflops: 104.856
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->304];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1216
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->304
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa117e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1216 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000380528
  time (contract): 0.00935406
  gflops: 6.38962
-----------------------------------
max element torch :      336
max element jit :        346
max difference :          28
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0810811
Torch value at max error:296
Kernel value at max error:272

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=306 (dimensions: 16,16,96,306,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,306,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 306
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000578024
  gflops: 104.082
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->306];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1224
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->306
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9512d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1224 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000347186
  time (contract): 0.00926945
  gflops: 6.49036
-----------------------------------
max element torch :      332
max element jit :        340
max difference :          28
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0844156
Torch value at max error:308
Kernel value at max error:282

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=308 (dimensions: 16,16,96,308,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,308,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 308
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000575958
  gflops: 105.138
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->308];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1232
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->308
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97abf000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1232 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000379793
  time (contract): 0.00935463
  gflops: 6.4733
-----------------------------------
max element torch :      334
max element jit :        344
max difference :          28
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0927152
Torch value at max error:302
Kernel value at max error:274

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=310 (dimensions: 16,16,96,310,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,310,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 310
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000580073
  gflops: 105.07
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->310];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1240
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->310
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba2c7000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1240 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00037592
  time (contract): 0.00945924
  gflops: 6.44328
-----------------------------------
max element torch :      340
max element jit :        350
max difference :          24
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.08
Torch value at max error:300
Kernel value at max error:276

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=312 (dimensions: 16,16,96,312,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,312,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 312
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000588842
  gflops: 104.173
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->312];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1248
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->312
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2235000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1248 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000332723
  time (contract): 0.00949019
  gflops: 6.46369
-----------------------------------
max element torch :      338
max element jit :        354
max difference :          26
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.08125
Torch value at max error:320
Kernel value at max error:294

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=314 (dimensions: 16,16,96,314,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,314,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 314
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000585455
  gflops: 105.448
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->314];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1256
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->314
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad762000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1256 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000382321
  time (contract): 0.00960109
  gflops: 6.42999
-----------------------------------
max element torch :      344
max element jit :        354
max difference :          28
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0875
Torch value at max error:320
Kernel value at max error:292

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=316 (dimensions: 16,16,96,316,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,316,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 316
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000585701
  gflops: 106.075
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->316];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1264
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->316
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb14aa000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1264 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000320947
  time (contract): 0.00962796
  gflops: 6.45289
-----------------------------------
max element torch :      346
max element jit :        358
max difference :          28
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0897436
Torch value at max error:312
Kernel value at max error:284

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=318 (dimensions: 16,16,96,318,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,318,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 318
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000596899
  gflops: 104.744
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->318];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1272
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->318
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb09f6000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1272 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000376209
  time (contract): 0.00957965
  gflops: 6.52647
-----------------------------------
max element torch :      344
max element jit :        356
max difference :          28
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0880503
Torch value at max error:318
Kernel value at max error:290

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=320 (dimensions: 16,16,96,320,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,320,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 320
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00059936
  gflops: 104.97
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->320];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1280
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->320
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa4a18000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1280 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000348434
  time (contract): 0.0102025
  gflops: 6.16657
-----------------------------------
max element torch :      350
max element jit :        358
max difference :          32
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0903955
Torch value at max error:322
Kernel value at max error:354

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=322 (dimensions: 16,16,96,322,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,322,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 322
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000598318
  gflops: 105.81
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->322];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1288
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->322
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff89b69000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1288 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000350834
  time (contract): 0.009713
  gflops: 6.51784
-----------------------------------
max element torch :      346
max element jit :        362
max difference :          32
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.097561
Torch value at max error:328
Kernel value at max error:296

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=324 (dimensions: 16,16,96,324,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,324,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 324
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000603379
  gflops: 105.574
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->324];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1296
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->324
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f024000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1296 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000349458
  time (contract): 0.00982803
  gflops: 6.48156
-----------------------------------
max element torch :      348
max element jit :        364
max difference :          32
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.097561
Torch value at max error:328
Kernel value at max error:296

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=326 (dimensions: 16,16,96,326,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,326,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 326
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000607042
  gflops: 105.584
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->326];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1304
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->326
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa22cc000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1304 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.00030802
  time (contract): 0.0100875
  gflops: 6.35384
-----------------------------------
max element torch :      354
max element jit :        362
max difference :          30
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0914634
Torch value at max error:328
Kernel value at max error:298

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=328 (dimensions: 16,16,96,328,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,328,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 328
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000611226
  gflops: 105.505
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->328];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1312
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->328
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8842f000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1312 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000362129
  time (contract): 0.00999743
  gflops: 6.4504
-----------------------------------
max element torch :      356
max element jit :        364
max difference :          32
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0993789
Torch value at max error:322
Kernel value at max error:290

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=330 (dimensions: 16,16,96,330,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,330,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 330
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000617727
  gflops: 105.031
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->330];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1320
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->330
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80c06000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1320 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000373648
  time (contract): 0.00994918
  gflops: 6.5212
-----------------------------------
max element torch :      358
max element jit :        376
max difference :          30
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0898204
Torch value at max error:334
Kernel value at max error:304

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=332 (dimensions: 16,16,96,332,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,332,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 332
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000617513
  gflops: 105.704
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->332];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1328
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->332
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffae006000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1328 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000338194
  time (contract): 0.0102019
  gflops: 6.39824
-----------------------------------
max element torch :      360
max element jit :        372
max difference :          28
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0869565
Torch value at max error:322
Kernel value at max error:294

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=334 (dimensions: 16,16,96,334,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,334,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 334
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000624297
  gflops: 105.186
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->334];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1336
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->334
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbcc34000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1336 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000346225
  time (contract): 0.0103583
  gflops: 6.33955
-----------------------------------
max element torch :      360
max element jit :        372
max difference :          32
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0941176
Torch value at max error:340
Kernel value at max error:308

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=336 (dimensions: 16,16,96,336,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,336,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 336
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00063112
  gflops: 104.671
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->336];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1344
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->336
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8bc1e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1344 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000373137
  time (contract): 0.0103764
  gflops: 6.36641
-----------------------------------
max element torch :      364
max element jit :        378
max difference :          40
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.115607
Torch value at max error:346
Kernel value at max error:306

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=338 (dimensions: 16,16,96,338,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,338,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 338
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000627712
  gflops: 105.866
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->338];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1352
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->338
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf6bc000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1352 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00038248
  time (contract): 0.0102099
  gflops: 6.50876
-----------------------------------
max element torch :      366
max element jit :        380
max difference :          32
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0909091
Torch value at max error:330
Kernel value at max error:300

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=340 (dimensions: 16,16,96,340,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,340,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 340
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000634658
  gflops: 105.327
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->340];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1360
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->340
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb068b000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1360 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000373072
  time (contract): 0.0104163
  gflops: 6.41751
-----------------------------------
max element torch :      374
max element jit :        382
max difference :          34
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.104938
Torch value at max error:324
Kernel value at max error:290

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=342 (dimensions: 16,16,96,342,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,342,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 342
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000640751
  gflops: 104.939
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->342];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1368
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->342
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff83eea000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1368 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000317267
  time (contract): 0.0111813
  gflops: 6.01358
-----------------------------------
max element torch :      370
max element jit :        378
max difference :          34
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.10119
Torch value at max error:336
Kernel value at max error:302

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=344 (dimensions: 16,16,96,344,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,344,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 344
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000643369
  gflops: 105.123
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->344];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1376
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->344
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99a55000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1376 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000327283
  time (contract): 0.0104791
  gflops: 6.45411
-----------------------------------
max element torch :      372
max element jit :        380
max difference :          32
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0935673
Torch value at max error:342
Kernel value at max error:310

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=346 (dimensions: 16,16,96,346,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,346,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 346
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000645962
  gflops: 105.31
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->346];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1384
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->346
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd77d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1384 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.00033573
  time (contract): 0.0106373
  gflops: 6.39511
-----------------------------------
max element torch :      372
max element jit :        382
max difference :          30
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0903614
Torch value at max error:332
Kernel value at max error:302

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=348 (dimensions: 16,16,96,348,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,348,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 348
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000645262
  gflops: 106.034
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->348];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1392
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->348
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90dfe000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1392 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000385136
  time (contract): 0.0105606
  gflops: 6.47874
-----------------------------------
max element torch :      374
max element jit :        390
max difference :          36
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.105882
Torch value at max error:340
Kernel value at max error:304

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=350 (dimensions: 16,16,96,350,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,350,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 350
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000656581
  gflops: 104.805
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->350];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1400
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->350
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa58bb000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1400 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000352402
  time (contract): 0.0105881
  gflops: 6.49904
-----------------------------------
max element torch :      378
max element jit :        388
max difference :          34
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.0982659
Torch value at max error:346
Kernel value at max error:312

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=352 (dimensions: 16,16,96,352,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,352,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 352
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000657333
  gflops: 105.283
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->352];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1408
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->352
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb3ea2000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1408 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000342322
  time (contract): 0.0111623
  gflops: 6.19997
-----------------------------------
max element torch :      386
max element jit :        394
max difference :          36
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.103448
Torch value at max error:348
Kernel value at max error:312

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=354 (dimensions: 16,16,96,354,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,354,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 354
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000667116
  gflops: 104.329
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->354];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1416
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->354
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaff4d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1416 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000376465
  time (contract): 0.0107547
  gflops: 6.47154
-----------------------------------
max element torch :      384
max element jit :        400
max difference :          36
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.100559
Torch value at max error:358
Kernel value at max error:322

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=356 (dimensions: 16,16,96,356,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,356,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 356
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000665258
  gflops: 105.211
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->356];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1424
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->356
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa8318000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1424 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000356529
  time (contract): 0.0109687
  gflops: 6.38112
-----------------------------------
max element torch :      384
max element jit :        396
max difference :          38
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.108571
Torch value at max error:350
Kernel value at max error:312

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=358 (dimensions: 16,16,96,358,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,358,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 358
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000669689
  gflops: 105.102
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->358];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1432
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->358
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82759000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1432 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000329426
  time (contract): 0.0110008
  gflops: 6.39823
-----------------------------------
max element torch :      384
max element jit :        398
max difference :          38
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.111111
Torch value at max error:342
Kernel value at max error:304

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=360 (dimensions: 16,16,96,360,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,360,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 360
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000676749
  gflops: 104.587
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->360];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1440
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->360
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94b97000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1440 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000302228
  time (contract): 0.0109898
  gflops: 6.44041
-----------------------------------
max element torch :      386
max element jit :        400
max difference :          38
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.105556
Torch value at max error:360
Kernel value at max error:322

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=362 (dimensions: 16,16,96,362,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,362,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 362
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000674073
  gflops: 105.585
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->362];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1448
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->362
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9f250000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1448 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000358161
  time (contract): 0.011128
  gflops: 6.39576
-----------------------------------
max element torch :      390
max element jit :        400
max difference :          40
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.115607
Torch value at max error:346
Kernel value at max error:306

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=364 (dimensions: 16,16,96,364,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,364,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 364
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000675164
  gflops: 105.997
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->364];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1456
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->364
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8bba000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1456 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000365233
  time (contract): 0.0111716
  gflops: 6.406
-----------------------------------
max element torch :      394
max element jit :        406
max difference :          38
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.109827
Torch value at max error:346
Kernel value at max error:308

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=366 (dimensions: 16,16,96,366,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,366,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 366
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000683707
  gflops: 105.248
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->366];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1464
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->366
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82448000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1464 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000337234
  time (contract): 0.011103
  gflops: 6.48098
-----------------------------------
max element torch :      394
max element jit :        404
max difference :          42
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.11413
Torch value at max error:368
Kernel value at max error:326

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=368 (dimensions: 16,16,96,368,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,368,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 368
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000682124
  gflops: 106.068
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->368];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1472
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->368
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf436000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1472 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000325043
  time (contract): 0.0114557
  gflops: 6.31577
-----------------------------------
max element torch :      402
max element jit :        416
max difference :          40
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.113636
Torch value at max error:352
Kernel value at max error:312

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=370 (dimensions: 16,16,96,370,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,370,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 370
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000687828
  gflops: 105.76
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->370];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1480
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->370
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9b04b000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1480 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00034245
  time (contract): 0.0111774
  gflops: 6.50823
-----------------------------------
max element torch :      400
max element jit :        412
max difference :          38
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.109827
Torch value at max error:346
Kernel value at max error:308

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=372 (dimensions: 16,16,96,372,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,372,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 372
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000690061
  gflops: 105.988
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->372];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1488
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->372
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa1466000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1488 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00034405
  time (contract): 0.0117126
  gflops: 6.2444
-----------------------------------
max element torch :      398
max element jit :        412
max difference :          38
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.107345
Torch value at max error:354
Kernel value at max error:316

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=374 (dimensions: 16,16,96,374,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,374,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 374
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000693513
  gflops: 106.027
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->374];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1496
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->374
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9ada6000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1496 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000346801
  time (contract): 0.0113026
  gflops: 6.5057
-----------------------------------
max element torch :      404
max element jit :        414
max difference :          36
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.100559
Torch value at max error:358
Kernel value at max error:322

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=376 (dimensions: 16,16,96,376,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,376,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 376
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000707131
  gflops: 104.542
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->376];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1504
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->376
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa859e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1504 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000335475
  time (contract): 0.0115672
  gflops: 6.39086
-----------------------------------
max element torch :      400
max element jit :        416
max difference :          40
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.104972
Torch value at max error:362
Kernel value at max error:324

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=378 (dimensions: 16,16,96,378,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,378,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 378
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00070433
  gflops: 105.516
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->378];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1512
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->378
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb668d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1512 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000349906
  time (contract): 0.0115159
  gflops: 6.45349
-----------------------------------
max element torch :      408
max element jit :        420
max difference :          40
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.106383
Torch value at max error:376
Kernel value at max error:336

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=380 (dimensions: 16,16,96,380,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,380,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 380
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000715333
  gflops: 104.442
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->380];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1520
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->380
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbe804000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1520 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000349425
  time (contract): 0.0116013
  gflops: 6.43988
-----------------------------------
max element torch :      410
max element jit :        430
max difference :          40
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.10929
Torch value at max error:366
Kernel value at max error:326

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=382 (dimensions: 16,16,96,382,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,382,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 382
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000706355
  gflops: 106.326
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->382];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1528
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->382
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88b0e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1528 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000301428
  time (contract): 0.0118072
  gflops: 6.3609
-----------------------------------
max element torch :      416
max element jit :        432
max difference :          42
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.109375
Torch value at max error:384
Kernel value at max error:342

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=384 (dimensions: 16,16,96,384,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,384,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 384
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000716771
  gflops: 105.33
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->384];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1536
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->384
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb8768000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1536 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000371185
  time (contract): 0.0136546
  gflops: 5.5291
-----------------------------------
max element torch :      414
max element jit :        436
max difference :          40
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.10989
Torch value at max error:364
Kernel value at max error:324

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=386 (dimensions: 16,16,96,386,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,386,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 386
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000709275
  gflops: 106.998
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->386];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1544
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->386
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff843ce000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1544 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000353714
  time (contract): 0.0119519
  gflops: 6.34966
-----------------------------------
max element torch :      420
max element jit :        424
max difference :          44
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.116402
Torch value at max error:378
Kernel value at max error:334

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=388 (dimensions: 16,16,96,388,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,388,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 388
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000715828
  gflops: 106.567
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->388];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1552
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->388
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaa959000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1552 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000379216
  time (contract): 0.0118195
  gflops: 6.45407
-----------------------------------
max element torch :      414
max element jit :        434
max difference :          42
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.112903
Torch value at max error:372
Kernel value at max error:330

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=390 (dimensions: 16,16,96,390,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,390,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 390
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000720998
  gflops: 106.349
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->390];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1560
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->390
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff92c29000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1560 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000314675
  time (contract): 0.0122792
  gflops: 6.2445
-----------------------------------
max element torch :      416
max element jit :        426
max difference :          42
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.108808
Torch value at max error:386
Kernel value at max error:344

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=392 (dimensions: 16,16,96,392,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,392,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 392
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000723574
  gflops: 106.513
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->392];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1568
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->392
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa2e66000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1568 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000324787
  time (contract): 0.0119361
  gflops: 6.4569
-----------------------------------
max element torch :      418
max element jit :        436
max difference :          44
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.114583
Torch value at max error:384
Kernel value at max error:340

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=394 (dimensions: 16,16,96,394,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,394,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 394
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000730847
  gflops: 105.991
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->394];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1576
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->394
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c3d3000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1576 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000350898
  time (contract): 0.0128444
  gflops: 6.03094
-----------------------------------
max element torch :      424
max element jit :        438
max difference :          44
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.112245
Torch value at max error:392
Kernel value at max error:348

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=396 (dimensions: 16,16,96,396,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,396,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 396
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000726061
  gflops: 107.232
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->396];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1584
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->396
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80a49000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1584 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000343634
  time (contract): 0.0119767
  gflops: 6.5007
-----------------------------------
max element torch :      432
max element jit :        444
max difference :          46
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.119792
Torch value at max error:384
Kernel value at max error:338

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=398 (dimensions: 16,16,96,398,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,398,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 398
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000734074
  gflops: 106.597
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->398];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1592
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->398
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb2d66000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1592 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000361521
  time (contract): 0.0123427
  gflops: 6.33976
-----------------------------------
max element torch :      432
max element jit :        446
max difference :          44
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.110526
Torch value at max error:380
Kernel value at max error:338

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=400 (dimensions: 16,16,96,400,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,400,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 400
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000731029
  gflops: 107.579
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->400];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1600
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->400
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffac75d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1600 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000310739
  time (contract): 0.0123273
  gflops: 6.37958
-----------------------------------
max element torch :      430
max element jit :        446
max difference :          40
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.103093
Torch value at max error:388
Kernel value at max error:348

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=402 (dimensions: 16,16,96,402,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,402,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 402
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000746915
  gflops: 105.817
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->402];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1608
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->402
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff82043000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1608 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000395312
  time (contract): 0.0121921
  gflops: 6.48259
-----------------------------------
max element torch :      432
max element jit :        446
max difference :          46
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.116162
Torch value at max error:396
Kernel value at max error:350

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=404 (dimensions: 16,16,96,404,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,404,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 404
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000748225
  gflops: 106.157
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->404];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1616
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->404
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9fce4000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1616 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000341203
  time (contract): 0.0124707
  gflops: 6.36928
-----------------------------------
max element torch :      436
max element jit :        450
max difference :          46
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.114428
Torch value at max error:402
Kernel value at max error:356

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=406 (dimensions: 16,16,96,406,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,406,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 406
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000745649
  gflops: 107.051
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->406];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1624
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->406
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb3bfb000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1624 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000330291
  time (contract): 0.0122662
  gflops: 6.50752
-----------------------------------
max element torch :      436
max element jit :        448
max difference :          50
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.13089
Torch value at max error:382
Kernel value at max error:332

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=408 (dimensions: 16,16,96,408,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,408,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 408
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000743563
  gflops: 107.881
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->408];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1632
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->408
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5329000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1632 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000372401
  time (contract): 0.0125608
  gflops: 6.3862
-----------------------------------
max element torch :      438
max element jit :        460
max difference :          46
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.116162
Torch value at max error:396
Kernel value at max error:350

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=410 (dimensions: 16,16,96,410,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,410,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 410
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00075615
  gflops: 106.605
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->410];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1640
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->410
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffac67e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1640 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00035429
  time (contract): 0.0140255
  gflops: 5.74733
-----------------------------------
max element torch :      438
max element jit :        454
max difference :          48
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.118812
Torch value at max error:404
Kernel value at max error:356

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=412 (dimensions: 16,16,96,412,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,412,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 412
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00076732
  gflops: 105.565
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->412];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1648
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->412
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8a679000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1648 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000371025
  time (contract): 0.0126487
  gflops: 6.40403
-----------------------------------
max element torch :      448
max element jit :        460
max difference :          44
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.112245
Torch value at max error:392
Kernel value at max error:348

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=414 (dimensions: 16,16,96,414,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,414,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 414
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000761618
  gflops: 106.872
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->414];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1656
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->414
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffad508000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1656 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000327091
  time (contract): 0.012586
  gflops: 6.46719
-----------------------------------
max element torch :      444
max element jit :        458
max difference :          46
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.115789
Torch value at max error:380
Kernel value at max error:336

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=416 (dimensions: 16,16,96,416,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,416,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 416
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000762933
  gflops: 107.203
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->416];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1664
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->416
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c099000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1664 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000345106
  time (contract): 0.0131688
  gflops: 6.21079
-----------------------------------
max element torch :      450
max element jit :        464
max difference :          46
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.112745
Torch value at max error:408
Kernel value at max error:362

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=418 (dimensions: 16,16,96,418,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,418,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 418
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000778374
  gflops: 105.582
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->418];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1672
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->418
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff90a40000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1672 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000412335
  time (contract): 0.0130082
  gflops: 6.31772
-----------------------------------
max element torch :      448
max element jit :        462
max difference :          50
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.122549
Torch value at max error:408
Kernel value at max error:358

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=420 (dimensions: 16,16,96,420,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,420,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 420
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000766405
  gflops: 107.744
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->420];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1680
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->420
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7f9b4000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1680 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000333746
  time (contract): 0.0128699
  gflops: 6.41616
-----------------------------------
max element torch :      460
max element jit :        470
max difference :          48
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.117647
Torch value at max error:408
Kernel value at max error:360

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=422 (dimensions: 16,16,96,422,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,422,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 422
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000771102
  gflops: 107.597
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->422];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1688
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->422
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff84509000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1688 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000376048
  time (contract): 0.0129533
  gflops: 6.40518
-----------------------------------
max element torch :      452
max element jit :        468
max difference :          56
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.142132
Torch value at max error:394
Kernel value at max error:338

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=424 (dimensions: 16,16,96,424,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,424,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 424
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000773669
  gflops: 107.749
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->424];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1696
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->424
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb4f32000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1696 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000315443
  time (contract): 0.0131119
  gflops: 6.35772
-----------------------------------
max element torch :      460
max element jit :        484
max difference :          50
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.121951
Torch value at max error:410
Kernel value at max error:360

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=426 (dimensions: 16,16,96,426,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,426,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 426
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000778589
  gflops: 107.573
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->426];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1704
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->426
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9c5a2000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1704 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000348338
  time (contract): 0.0129135
  gflops: 6.48583
-----------------------------------
max element torch :      462
max element jit :        472
max difference :          52
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.126214
Torch value at max error:412
Kernel value at max error:360

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=428 (dimensions: 16,16,96,428,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,428,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 428
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000786191
  gflops: 107.033
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->428];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1712
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->428
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb9b15000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1712 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000398512
  time (contract): 0.0132044
  gflops: 6.37273
-----------------------------------
max element torch :      458
max element jit :        472
max difference :          48
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.115942
Torch value at max error:414
Kernel value at max error:366

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=430 (dimensions: 16,16,96,430,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,430,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 430
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000785548
  gflops: 107.621
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->430];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1720
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->430
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff99407000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1720 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000325618
  time (contract): 0.013074
  gflops: 6.4664
-----------------------------------
max element torch :      460
max element jit :        472
max difference :          48
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.112676
Torch value at max error:426
Kernel value at max error:378

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=432 (dimensions: 16,16,96,432,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,432,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 432
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000782365
  gflops: 108.561
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->432];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1728
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->432
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa9c73000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1728 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000364881
  time (contract): 0.0133069
  gflops: 6.38275
-----------------------------------
max element torch :      466
max element jit :        482
max difference :          50
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.121359
Torch value at max error:412
Kernel value at max error:362

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=434 (dimensions: 16,16,96,434,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,434,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 434
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000807698
  gflops: 105.643
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->434];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1736
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->434
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbc737000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1736 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00034213
  time (contract): 0.0132777
  gflops: 6.42639
-----------------------------------
max element torch :      468
max element jit :        484
max difference :          50
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.115741
Torch value at max error:432
Kernel value at max error:382

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=436 (dimensions: 16,16,96,436,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,436,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 436
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000798532
  gflops: 107.348
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->436];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1744
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->436
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffb5ac4000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1744 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000450989
  time (contract): 0.0133356
  gflops: 6.428
-----------------------------------
max element torch :      472
max element jit :        484
max difference :          50
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.118483
Torch value at max error:422
Kernel value at max error:372

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=438 (dimensions: 16,16,96,438,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,438,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 438
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000803374
  gflops: 107.191
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->438];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1752
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->438
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d29b000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1752 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000348721
  time (contract): 0.0132442
  gflops: 6.50203
-----------------------------------
max element torch :      468
max element jit :        480
max difference :          46
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.107981
Torch value at max error:426
Kernel value at max error:380

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=440 (dimensions: 16,16,96,440,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,440,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 440
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000799259
  gflops: 108.235
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->440];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1760
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->440
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff80bb5000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1760 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000311828
  time (contract): 0.0134019
  gflops: 6.45485
-----------------------------------
max element torch :      472
max element jit :        488
max difference :          62
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.15122
Torch value at max error:410
Kernel value at max error:348

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=442 (dimensions: 16,16,96,442,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,442,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 442
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000810774
  gflops: 107.182
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->442];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1768
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->442
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff892bd000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1768 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000381008
  time (contract): 0.0134468
  gflops: 6.46254
-----------------------------------
max element torch :      474
max element jit :        482
max difference :          50
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.115207
Torch value at max error:434
Kernel value at max error:384

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=444 (dimensions: 16,16,96,444,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,444,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 444
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000813596
  gflops: 107.294
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->444];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1776
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->444
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff819fe000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1776 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00034021
  time (contract): 0.0135433
  gflops: 6.44553
-----------------------------------
max element torch :      478
max element jit :        494
max difference :          48
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.114833
Torch value at max error:418
Kernel value at max error:370

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=446 (dimensions: 16,16,96,446,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,446,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 446
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000812486
  gflops: 107.924
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->446];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1784
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->446
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffba0c7000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1784 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000441934
  time (contract): 0.0138184
  gflops: 6.34569
-----------------------------------
max element torch :      480
max element jit :        496
max difference :          54
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.121622
Torch value at max error:444
Kernel value at max error:390

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=448 (dimensions: 16,16,96,448,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,448,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 448
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000819527
  gflops: 107.477
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->448];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1792
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->448
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbd97c000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1792 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000359697
  time (contract): 0.014339
  gflops: 6.14272
-----------------------------------
max element torch :      488
max element jit :        498
max difference :          52
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.116071
Torch value at max error:448
Kernel value at max error:396

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=450 (dimensions: 16,16,96,450,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,450,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 450
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000837617
  gflops: 105.625
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->450];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1800
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->450
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa5451000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1800 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000341266
  time (contract): 0.0136789
  gflops: 6.46789
-----------------------------------
max element torch :      478
max element jit :        500
max difference :          60
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.133929
Torch value at max error:448
Kernel value at max error:388

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=452 (dimensions: 16,16,96,452,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,452,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 452
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000829153
  gflops: 107.178
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->452];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1808
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->452
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff86804000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1808 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000401487
  time (contract): 0.0138739
  gflops: 6.40532
-----------------------------------
max element torch :      492
max element jit :        500
max difference :          52
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.116822
Torch value at max error:428
Kernel value at max error:378

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=454 (dimensions: 16,16,96,454,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,454,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 454
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000825936
  gflops: 108.071
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->454];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1816
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->454
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8ec04000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1816 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000355282
  time (contract): 0.0140655
  gflops: 6.34604
-----------------------------------
max element torch :      486
max element jit :        504
max difference :          60
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.134529
Torch value at max error:446
Kernel value at max error:386

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=456 (dimensions: 16,16,96,456,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,456,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 456
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000830182
  gflops: 107.992
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->456];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1824
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->456
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff94480000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1824 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000432591
  time (contract): 0.0140952
  gflops: 6.36056
-----------------------------------
max element torch :      492
max element jit :        506
max difference :          54
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.121076
Torch value at max error:446
Kernel value at max error:392

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=458 (dimensions: 16,16,96,458,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,458,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 458
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000831623
  gflops: 108.278
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->458];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1832
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->458
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8c2a9000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1832 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000316083
  time (contract): 0.0143123
  gflops: 6.29155
-----------------------------------
max element torch :      492
max element jit :        506
max difference :          54
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.118943
Torch value at max error:454
Kernel value at max error:400

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=460 (dimensions: 16,16,96,460,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,460,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 460
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000834658
  gflops: 108.355
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->460];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1840
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->460
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa396e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1840 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000343698
  time (contract): 0.0138476
  gflops: 6.53109
-----------------------------------
max element torch :      494
max element jit :        512
max difference :          56
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.126126
Torch value at max error:444
Kernel value at max error:388

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=462 (dimensions: 16,16,96,462,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,462,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 462
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000841403
  gflops: 107.954
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->462];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1848
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->462
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d808000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1848 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000314323
  time (contract): 0.0141671
  gflops: 6.41153
-----------------------------------
max element torch :      488
max element jit :        506
max difference :          54
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.118421
Torch value at max error:456
Kernel value at max error:402

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=464 (dimensions: 16,16,96,464,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,464,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 464
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000843575
  gflops: 108.142
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->464];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1856
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->464
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9661c000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1856 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000334483
  time (contract): 0.0142718
  gflops: 6.39206
-----------------------------------
max element torch :      496
max element jit :        508
max difference :          52
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.115207
Torch value at max error:434
Kernel value at max error:384

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=466 (dimensions: 16,16,96,466,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,466,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 466
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000850134
  gflops: 107.77
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->466];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1864
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->466
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9615d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1864 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000361713
  time (contract): 0.0145424
  gflops: 6.30016
-----------------------------------
max element torch :      504
max element jit :        512
max difference :          64
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.136752
Torch value at max error:468
Kernel value at max error:404

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=468 (dimensions: 16,16,96,468,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,468,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 468
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000850389
  gflops: 108.201
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->468];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1872
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->468
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8ed5f000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1872 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000394608
  time (contract): 0.0143935
  gflops: 6.39264
-----------------------------------
max element torch :      502
max element jit :        512
max difference :          60
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.134529
Torch value at max error:446
Kernel value at max error:386

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=470 (dimensions: 16,16,96,470,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,470,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 470
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000861691
  gflops: 107.238
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->470];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1880
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->470
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff946a7000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1880 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000369872
  time (contract): 0.0144125
  gflops: 6.41151
-----------------------------------
max element torch :      500
max element jit :        516
max difference :          56
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.125
Torch value at max error:448
Kernel value at max error:392

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=472 (dimensions: 16,16,96,472,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,472,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 472
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000862261
  gflops: 107.623
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->472];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1888
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->472
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7fe3d000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1888 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000342194
  time (contract): 0.0144733
  gflops: 6.41174
-----------------------------------
max element torch :      504
max element jit :        516
max difference :          58
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.128319
Torch value at max error:452
Kernel value at max error:394

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=474 (dimensions: 16,16,96,474,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,474,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 474
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00086255
  gflops: 108.043
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->474];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1896
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->474
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8e7a3000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1896 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000340946
  time (contract): 0.0143655
  gflops: 6.48721
-----------------------------------
max element torch :      512
max element jit :        512
max difference :          62
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.138393
Torch value at max error:448
Kernel value at max error:386

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=476 (dimensions: 16,16,96,476,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,476,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 476
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000866177
  gflops: 108.044
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->476];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1904
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->476
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff97199000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1904 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000363697
  time (contract): 0.0144991
  gflops: 6.45456
-----------------------------------
max element torch :      510
max element jit :        512
max difference :          54
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.121076
Torch value at max error:446
Kernel value at max error:392

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=478 (dimensions: 16,16,96,478,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,478,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 478
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000867909
  gflops: 108.282
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->478];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1912
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->478
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa4a42000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1912 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000380976
  time (contract): 0.0155061
  gflops: 6.06075
-----------------------------------
max element torch :      520
max element jit :        516
max difference :          60
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.126582
Torch value at max error:474
Kernel value at max error:414

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=480 (dimensions: 16,16,96,480,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,480,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 480
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00086874
  gflops: 108.631
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->480];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1920
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->480
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffa265b000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1920 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000372497
  time (contract): 0.0150671
  gflops: 6.26344
-----------------------------------
max element torch :      516
max element jit :        516
max difference :          60
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.133333
Torch value at max error:450
Kernel value at max error:390

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=482 (dimensions: 16,16,96,482,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,482,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 482
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000873081
  gflops: 108.541
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->482];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1928
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->482
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff985c7000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1928 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000309395
  time (contract): 0.0163732
  gflops: 5.78782
-----------------------------------
max element torch :      516
max element jit :        516
max difference :          64
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.142222
Torch value at max error:450
Kernel value at max error:386

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=484 (dimensions: 16,16,96,484,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,484,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 484
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000875899
  gflops: 108.641
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->484];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1936
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->484
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9d5f3000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1936 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000365201
  time (contract): 0.0147503
  gflops: 6.45126
-----------------------------------
max element torch :      512
max element jit :        516
max difference :          58
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.121849
Torch value at max error:476
Kernel value at max error:418

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=486 (dimensions: 16,16,96,486,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,486,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 486
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000885694
  gflops: 107.883
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->486];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1944
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->486
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8d5b8000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1944 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000408175
  time (contract): 0.0149181
  gflops: 6.40506
-----------------------------------
max element torch :      520
max element jit :        520
max difference :          58
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.123932
Torch value at max error:468
Kernel value at max error:410

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=488 (dimensions: 16,16,96,488,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,488,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 488
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00087785
  gflops: 109.295
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->488];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1952
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->488
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff909d5000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1952 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000334834
  time (contract): 0.0150997
  gflops: 6.35406
-----------------------------------
max element torch :      528
max element jit :        520
max difference :          56
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.118644
Torch value at max error:472
Kernel value at max error:416

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=490 (dimensions: 16,16,96,490,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,490,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 490
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00090503
  gflops: 106.447
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->490];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1960
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->490
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffbf46f000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1960 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000364561
  time (contract): 0.0147344
  gflops: 6.53828
-----------------------------------
max element torch :      520
max element jit :        520
max difference :          62
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.128631
Torch value at max error:482
Kernel value at max error:420

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=492 (dimensions: 16,16,96,492,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,492,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 492
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000879256
  gflops: 110.015
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->492];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1968
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->492
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff7fbc8000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1968 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000316403
  time (contract): 0.0151286
  gflops: 6.39393
-----------------------------------
max element torch :      532
max element jit :        520
max difference :          60
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.125523
Torch value at max error:478
Kernel value at max error:418

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=494 (dimensions: 16,16,96,494,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,494,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 494
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000899059
  gflops: 108.029
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->494];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1976
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->494
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff87a90000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1976 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000423631
  time (contract): 0.0148292
  gflops: 6.54954
-----------------------------------
max element torch :      536
max element jit :        520
max difference :          58
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.127193
Torch value at max error:456
Kernel value at max error:398

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=496 (dimensions: 16,16,96,496,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,496,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 496
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000889198
  gflops: 109.669
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->496];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1984
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->496
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff8a458000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1984 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000329811
  time (contract): 0.0153172
  gflops: 6.36654
-----------------------------------
max element torch :      528
max element jit :        524
max difference :          58
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.121849
Torch value at max error:476
Kernel value at max error:418

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=498 (dimensions: 16,16,96,498,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,498,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 498
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000899472
  gflops: 108.854
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->498];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->1992
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->498
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff996f8000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=1992 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000306516
  time (contract): 0.0152959
  gflops: 6.40109
-----------------------------------
max element torch :      532
max element jit :        520
max difference :          62
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.127572
Torch value at max error:486
Kernel value at max error:424

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=500 (dimensions: 16,16,96,500,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,500,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 500
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000897879
  gflops: 109.485
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->500];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->2000
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->500
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffffaf0dc000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=2000 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000332082
  time (contract): 0.0149638
  gflops: 6.56946
-----------------------------------
max element torch :      528
max element jit :        520
max difference :          60
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.122951
Torch value at max error:488
Kernel value at max error:428

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=502 (dimensions: 16,16,96,502,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,502,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 502
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000903287
  gflops: 109.264
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->502];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->2008
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->502
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff927d2000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=2008 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 3
JIT compile err: 0
  time (compile): 0.000376817
  time (contract): 0.0155412
  gflops: 6.3507
-----------------------------------
max element torch :      536
max element jit :        524
max difference :          58
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.122363
Torch value at max error:474
Kernel value at max error:416

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=504 (dimensions: 16,16,96,504,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,504,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 504
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000917825
  gflops: 107.962
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->504];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->2016
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->504
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9a57e000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=2016 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.00038968
  time (contract): 0.0153367
  gflops: 6.46098
-----------------------------------
max element torch :      540
max element jit :        524
max difference :          60
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.121457
Torch value at max error:494
Kernel value at max error:434

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=506 (dimensions: 16,16,96,506,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,506,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 506
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.000932397
  gflops: 106.697
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->506];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->2024
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->506
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9623b000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=2024 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000371473
  time (contract): 0.0152265
  gflops: 6.53357
-----------------------------------
max element torch :      544
max element jit :        524
max difference :          66
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.135802
Torch value at max error:486
Kernel value at max error:420

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=508 (dimensions: 16,16,96,508,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,508,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 508
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.0009343
  gflops: 106.9
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->508];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->2032
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->508
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff88593000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=2032 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000408687
  time (contract): 0.015515
  gflops: 6.43745
-----------------------------------
max element torch :      544
max element jit :        524
max difference :          62
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.124498
Torch value at max error:498
Kernel value at max error:436

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=510 (dimensions: 16,16,96,510,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,510,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 510
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00093683
  gflops: 107.031
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->510];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->2040
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->510
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff9925f000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=2040 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000356338
  time (contract): 0.0156013
  gflops: 6.42702
-----------------------------------
max element torch :      544
max element jit :        524
max difference :          62
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.124
Torch value at max error:500
Kernel value at max error:438

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


=== testing k=512 (dimensions: 16,16,96,512,4) ===
Running: OMP_NUM_THREADS=1 /home/daniel/einsum_ir/build/bench_binary "xaby,cxy->cab" "16,16,96,512,4" BF16
----------------------------------------
running bench_binary!
parsed tensors:
  x,a,b,y
  c,x,y
  c,a,b
parsed dimension ids:
  a: 0
  b: 1
  c: 2
  x: 3
  y: 4
parsed dimension sizes:
  a: 16
  b: 16
  c: 96
  x: 512
  y: 4
dtype: BF16
at::einsum:
  time (contract): 0.00107686
  gflops: 93.4786
einsum_ir:
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
[BP::init] i_data_type = 2, backend = 2
3 
1 
1 
3 
--------
2 
3 
3 
--------
2 
1 
1 
--------
o_dim_ids_nb[0] = 2
o_dim_ids_kb[0] = 4
Parameter                Wert           
----------------------------------------
i_primitive_blocking     0
m_num_dims_left          4
m_num_dims_right         3
m_num_dims_out           3
l_dim_ids_left_active    3
                         0
                         1
                         4
l_dim_ids_right_active   2
                         3
                         4
m_dim_ids_out            2
                         0
                         1
m_dim_sizes_inner        [0->16];[1->16];[2->96];[3->512];[4->4]
i_strides_left           nullptr
i_strides_right          nullptr
i_strides_out            nullptr
l_dim_ids_cb             
l_dim_ids_mb             
l_dim_ids_nb             2
l_dim_ids_kb             4
----------------------------------------

Parameter                Wert           
----------------------------------------
l_strides_left           
0                        ->64
1                        ->4
3                        ->1024
4                        ->1
l_strides_right          
2                        ->2048
3                        ->4
4                        ->1
l_strides_out            
0                        ->16
1                        ->1
2                        ->256
----------------------------------------

Parameter                Wert           
----------------------------------------
l_dim_sizes              
0                        ->16
1                        ->16
2                        ->96
3                        ->512
4                        ->4
----------------------------------------

[OK] BRGEMM kernel erfolgreich generiert.
[DEBUG] Main GEMM ptr: 0xffff93511000
[DEBUG] GEMM shape: m=1 n=96 k=4 lda=1 ldb=2048 ldc=256
[DEBUG] dim_types_out: 2 1 1 
m_num_loops: 4
JIT compile err: 0
  time (compile): 0.000297268
  time (contract): 0.0195939
  gflops: 5.13747
-----------------------------------
max element torch :      552
max element jit :        524
max difference :          68
-----------------------------------
Element-wise relative errors
Biggest relative error:  0.139344
Torch value at max error:488
Kernel value at max error:420

error:einsum_ir solution is not close to aten!

acceptable relative error :                    0.001
finished running bench_binary!

Exit code: 0
========================================


